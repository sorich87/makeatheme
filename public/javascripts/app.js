(function(){"use strict";var e=typeof window!="undefined"?window:global;if(typeof e.require=="function")return;var t={},n={},r=function(e,t){return{}.hasOwnProperty.call(e,t)},i=function(e,t){var n=[],r,i;/^\.\.?(\/|$)/.test(t)?r=[e,t].join("/").split("/"):r=t.split("/");for(var s=0,o=r.length;s<o;s++)i=r[s],i===".."?n.pop():i!=="."&&i!==""&&n.push(i);return n.join("/")},s=function(e){return e.split("/").slice(0,-1).join("/")},o=function(t){return function(n){var r=s(t),o=i(r,n);return e.require(o)}},u=function(e,t){var r={id:e,exports:{}};t(r.exports,o(e),r);var i=n[e]=r.exports;return i},a=function(e){var s=i(e,".");if(r(n,s))return n[s];if(r(t,s))return u(s,t[s]);var o=i(s,"./index");if(r(n,o))return n[o];if(r(t,o))return u(o,t[o]);throw new Error('Cannot find module "'+e+'"')},f=function(e){for(var n in e)r(e,n)&&(t[n]=e[n])};e.require=a,e.require.define=f,e.require.brunch=!0})(),window.require.define({application:function(e,t,n){Application=window.Application||{},_.extend(Application,{initialize:function(){var e=t("router");this.createView("notifications").render().$el.appendTo($("body",window.top.document)),this.setCurrentUser(),this.router=new e,this.reuseView("auth_links").render(),this.setBodyClasses(),this.editor={},Object.freeze(this)},createView:function(e,n){var r=this.views||{},i=t("views/"+e);return r[e]!==void 0&&(r[e].undelegateEvents(),r[e].remove(),r[e].off()),r[e]=new i(n),this.views=r,r[e]},reuseView:function(e,n){var r=this.views||{},i=t("views/"+e);return r[e]!==void 0?r[e]:(r[e]=new i(n),this.views=r,r[e])},setBodyClasses:function(){Backbone.history.on("route",function(e,t){$("body")[0].className=t})},setCurrentUser:function(){var e=t("models/user"),n=t("collections/themes");this.data.currentUser?(this.currentUser=new e(this.data.currentUser),this.currentUser.set("themes",new n(this.data.currentUser.themes))):this.currentUser=new e,this.on("upload:after",this.updateCurrentUserThemes)},updateCurrentUserThemes:function(e){this.currentUser.get("themes").add(e)}},Backbone.Events),n.exports=Application}}),window.require.define({"collections/base/collection":function(e,t,n){n.exports=Backbone.Collection.extend({})}}),window.require.define({"collections/blocks":function(e,t,n){var r=t("collections/base/collection"),i=t("models/block");n.exports=r.extend({model:i,getByName:function(e){return this.find(function(t){return t.get("name")===e})}})}}),window.require.define({"collections/regions":function(e,t,n){var r=t("collections/base/collection"),i=t("models/region");n.exports=r.extend({model:i,getByName:function(e,t){return t===void 0&&(t="default"),this.find(function(n){return n.get("slug")===t&&n.get("name")===e})}})}}),window.require.define({"collections/templates":function(e,t,n){var r=t("collections/base/collection"),i=t("models/template");n.exports=r.extend({model:i,getByName:function(e){return this.find(function(t){return t.get("name")===e})},getCurrent:function(){var e=this.find(function(e){return e.get("current")===!0});return e||(e=this.getByName("index")),e},setCurrent:function(e){var t=this.getCurrent();t&&t.set("current",!1),e.set("current",!0)}})}}),window.require.define({"collections/themes":function(e,t,n){var r=t("collections/base/collection"),i=t("models/theme");n.exports=r.extend({model:i,url:"/themes"})}}),window.require.define({initialize:function(e,t,n){var r=t("application");$(function(){r.initialize(),Backbone.history.start({pushState:!0}),jQuery(function(e){e(document).on("hidden",".modal",function(){e("#main").children().length===0?Backbone.history.navigate("/",!0):Backbone.history.back(!0)}),e(document).on("click","a:not([data-bypass])",function(t){var n={prop:e(this).prop("href"),attr:e(this).attr("href")},r=location.protocol+"//"+location.host+"/";n.prop&&n.prop.slice(0,r.length)===r&&(t.preventDefault(),Backbone.history.navigate(n.attr,{trigger:!0,replace:!!e(this).data("replace")}))})})})}}),window.require.define({"lib/custom_css":function(e,t,n){var r=function(e){var t=document.createElement("style");t.type="text/css",t.rel="alternate stylesheet",document.head.appendChild(t),this.node=t,this.sheet=t.sheet,this.insertRules(e)};r.prototype.insertRule=function(e,t,n,r){r===null||r===void 0?r=this.sheet.cssRules.length:this.deleteRule(r);if(!e||!t||!n)return;return this.rules[e]=this.rules[e]||{},this.rules[e][t]={value:n,index:r},this.sheet.insertRule(e+" {"+t+": "+n+"}",r),r},r.prototype.insertRules=function(e){var t,n,r;e=e||{};for(n in e){if(!e.hasOwnProperty(n))continue;for(r in e[n]){if(!e[n].hasOwnProperty(r))continue;t=e[n][r],this.sheet.insertRule(n+" {"+r+": "+t.value+"}",this.sheet.rules.length)}}this.rules=e},r.prototype.getRule=function(e,t){if(!e||!t)return;if(!this.rules[e]||!this.rules[e][t])return;return this.rules[e][t].value},r.prototype.deleteRule=function(e){var t,n;if(e===null||e===void 0)return;this.sheet.deleteRule(e);for(t in this.rules){if(!this.rules.hasOwnProperty(t))continue;for(n in this.rules[t]){if(!this.rules[t].hasOwnProperty(n))continue;if(this.rules[t][n].index===e)return delete this.rules[t][n]}}},r.prototype.toString=function(){var e,t,n="";if(!this.rules||this.rules.length===0)return;for(e in this.rules){if(!this.rules.hasOwnProperty(e))continue;n+=e+" {\n";for(t in this.rules[e]){if(!this.rules[e].hasOwnProperty(t))continue;n+=t+": "+this.rules[e][t].value+";\n"}n+="}\n"}return n},n.exports=r}}),window.require.define({"lib/editor_data":function(e,t,n){var r,i=t("application"),s=t("collections/templates"),o=t("collections/regions"),u=t("collections/blocks"),a=t("lib/custom_css");r=sessionStorage.getItem("theme-"+i.data.theme._id),r=JSON.parse(r),r||(r={templates:i.data.theme_pieces.templates,regions:i.data.theme_pieces.regions,blocks:i.data.theme_pieces.blocks,style:i.data.style}),r={templates:new s(r.templates),regions:new o(r.regions),blocks:new u(r.blocks),style:new a(r.style)},setInterval(function(){var e={templates:r.templates.toJSON(),regions:r.regions.toJSON(),blocks:r.blocks.toJSON(),style:r.style.rules};e=JSON.stringify(e),sessionStorage.setItem("theme-"+i.data.theme._id,e)},1e3),n.exports=r}}),window.require.define({"lib/html_tags":function(e,t,n){n.exports=[{group:"Headings",tags:[{tag:"h1",label:"Headings 1"},{tag:"h2",label:"Headings 2"},{tag:"h3",label:"Headings 3"},{tag:"h4",label:"Headings 4"},{tag:"h5",label:"Headings 5"},{tag:"h6",label:"Headings 6"}]},{group:"Content sections",tags:[{tag:"p",label:"Paragraphs"},{tag:"blockquote",label:"Block quotations"},{tag:"pre",label:"Pre-formatted content"},{tag:"address",label:"Addresses"},{tag:"ins",label:"Inserted content"},{tag:"del",label:"Deleted content"},{tag:"hr",label:"Horizontal rules"}]},{group:"Inline elements",tags:[{tag:"a",label:"Links"},{tag:"abbr",label:"Abbreviations"},{tag:"acronym",label:"Acronyms"},{tag:"dfn",label:"Inline definitions"},{tag:"em",label:"Emphases"},{tag:"strong",label:"Strong emphases"},{tag:"cite",label:"Citations"},{tag:"q",label:"Inline quotations"},{tag:"sub",label:"Subscripts"},{tag:"sup",label:"Superscripts"}]},{group:"Lists",tags:[{tag:"dl",label:"Definition Lists"},{tag:"dt",label:"Definition Terms"},{tag:"dd",label:"Definitions"},{tag:"ol",label:"Ordered Lists"},{tag:"ul",label:"Unordered Lists"},{tag:"menu",label:"Menu Lists"},{tag:"li",label:"List Items"}]},{group:"Forms",tags:[{tag:"form",label:"Forms"},{tag:"fieldset",label:"Fieldsets"},{tag:"legend",label:"Fieldset legends"},{tag:"input[type=checkbox]",label:"Checkboxes"},{tag:"input[type=radio]",label:"Radio buttons"},{tag:"button",label:"Buttons"},{tag:"input[type=button]",label:"Buttons"},{tag:"input[type=submit]",label:"Submit buttons"},{tag:"input[type=image]",label:"Image buttons"},{tag:"input[type=reset]",label:"Reset buttons"},{tag:"input[type=text]",label:"Text fields"},{tag:"input[type=text]",label:"Text fields"},{tag:"input[type=password]",label:"Password fields"},{tag:"input[type=file]",label:"File fields"},{tag:"select",label:"Selection lists"},{tag:"optgroup",label:"Group of options"},{tag:"option",label:"Options"},{tag:"textarea",label:"Multi-line text areas"}]},{group:"Tables",tags:[{tag:"table",label:"Tables"},{tag:"caption",label:"Table captions"},{tag:"thead",label:"Table headers"},{tag:"tbody",label:"Table bodies"},{tag:"tfoot",label:"Table footers"},{tag:"tr",label:"Table rows"},{tag:"th",label:"Table header cells"},{tag:"td",label:"Table data cells"},{tag:"colgroup",label:"Table column groups"},{tag:"col",label:"Table columns"}]},{group:"Media",tags:[{tag:"img",label:"Images"},{tag:"map",label:"Maps"},{tag:"area",label:"Map areas"},{tag:"object",label:"Media object"},{tag:"embed",label:"Media embed"},{tag:"iframe",label:"Iframes"}]},{group:"Computer text",tags:[{tag:"code",label:"Source code"},{tag:"var",label:"Source code variables"},{tag:"kbd",label:"User input"},{tag:"samp",label:"Program output"}]},{group:"Presentation",tags:[{tag:"b",label:"b"},{tag:"i",label:"i"},{tag:"u",label:"u"},{tag:"s",label:"s"},{tag:"small",label:"small"},{tag:"big",label:"big"},{tag:"tt",label:"tt"}]}]}}),window.require.define({"models/base/model":function(e,t,n){n.exports=Backbone.Model.extend({})}}),window.require.define({"models/block":function(e,t,n){var r=t("models/base/model");n.exports=r.extend({idAttribute:"_id",defaults:{name:"",template:"",build:""},label:function(){return _.str.titleize(this.get("label")+" "+_.str.humanize(this.get("name")))},className:function(){return this.get("name").replace("_","-")},tag:function(){var e="";return this.get("label")!=="Default"&&(e=" "+this.get("label")),"{{"+this.get("name")+e+"}}"}})}}),window.require.define({"models/region":function(e,t,n){var r=t("models/base/model");n.exports=r.extend({idAttribute:"_id",defaults:{slug:"",name:"",template:""},validate:function(e){if(["header","footer"].indexOf(e.name)<0)return"Region must be header or footer."}})}}),window.require.define({"models/template":function(e,t,n){var r=t("models/base/model");n.exports=r.extend({idAttribute:"_id",defaults:{name:"",template:"",build:"",regions:{header:"default",footer:"default"}},label:function(){var e;for(e in this.standards){if(!this.standards.hasOwnProperty(e))continue;if(this.get("name")===this.standards[e].name)return this.standards[e].label}return this.get("name")},setRegion:function(e,t){var n=this.get("regions");n[e]=t,this.set("regions",n)},standards:[{name:"index",label:"Default"},{name:"front-page",label:"Front Page"},{name:"home",label:"Blog"},{name:"single",label:"Article"},{name:"page",label:"Page"},{name:"archive",label:"Archive"},{name:"search",label:"Search Results"},{name:"404",label:"Error 404"}]})}}),window.require.define({"models/theme":function(e,t,n){var r=t("models/base/model");n.exports=r.extend({idAttribute:"_id",urlRoot:"/themes",defaults:{name:"",author:"",screenshot_uri:""}})}}),window.require.define({"models/user":function(e,t,n){var r=t("models/base/model"),i=t("collections/themes");n.exports=r.extend({defaults:{first_name:"",last_name:"",email:"",password:"",password_confirmation:"",themes:[]},initialize:function(){var e=new i(this.attributes.themes)},url:"/users",validation:{first_name:{required:!0},last_name:{required:!0},email:{required:!0,pattern:"email"},password:{required:function(e,t,n){return n&&!n.id?!0:!1}},password_confirmation:{equalTo:"password"}}})}}),window.require.define({router:function(e,t,n){var r=t("application"),i=t("collections/themes");n.exports=Backbone.Router.extend({routes:{"":"index","me/themes":"your_themes","themes/:id":"theme","themes/:id/edit":"theme_edit","themes/:id/fork":"theme_fork","preview/:id":"preview","editor/:id":"editor","editor/:id/:fork":"editor",login:"login",register:"register",reset_password:"reset_password",upload:"upload","*actions":"notFound"},index:function(){var e=new i(r.data.themes),t="",n=$("#main");n.empty(),r.currentUser.id||n.append(r.reuseView("faq").render().$el),window.MutationSummary===void 0&&(t="<div class='alert alert-error'><b>Please Note:</b> Although the themes built with the online editor work in any browser, the editor itself has been tested only with the latest versions of <a href=''>Google Chrome</a> and <a href=''>Mozilla Firefox</a> so far. Support for other browsers is coming soon.</div>"),n.append(t).append("<h3 class='page-title'>Try out with a theme below</h3>").append(r.createView("theme_list",{collection:e}).render().$el).append("<p>This is an open platform... If you are a professional web designer, please <a href='javascript:UserVoice.showPopupWidget();'>contact us</a>. We want to hear from you!</p>")},your_themes:function(){var e=r.currentUser.get("themes");$("#main").empty().append("<h1 class='page-header'>Your Themes <small>("+e.length+")</small></h1>").append(r.createView("theme_list",{collection:e}).render().$el)},theme:function(e){$("#main").empty().append(r.createView("theme",{themeID:e,route:"preview"}).render().$el)},theme_edit:function(e){$("#main").empty().append(r.createView("theme",{themeID:e,route:"editor",action:"edit"}).render().$el)},theme_fork:function(e){$("#main").empty().append(r.createView("theme",{themeID:e,route:"editor",action:"fork"}).render().$el)},preview:function(e){if(r.data.theme===void 0){window.top.Backbone.history.navigate("/404",{trigger:!0,replace:!0});return}r.createView("preview").render()},editor:function(e,t){if(r.data.theme===void 0){window.top.Backbone.history.navigate("/404",{trigger:!0,replace:!0});return}r.createView("editor",{fork:t==="fork"?!0:!1}).render()},login:function(){$(".modal").modal("hide"),$("body").append(r.createView("login").render().$el.modal("show"))},register:function(){$(".modal").modal("hide"),$("body").append(r.createView("register").render().$el.modal("show"))},reset_password:function(){$(".modal").modal("hide"),$("body").append(r.createView("password_reset").render().$el.modal("show"))},upload:function(){$(".modal").modal("hide"),$("body").append(r.createView("theme_upload").render().$el.modal("show"))},notFound:function(){$("#main").empty().append(r.reuseView("not_found").render().$el)}})}}),window.require.define({"views/auth_links":function(e,t,n){var r=t("views/base/view"),i=t("views/templates/auth_links"),s=t("application");n.exports=r.extend({el:$("#auth-links"),model:s.currentUser,events:{"click #logout":"deleteSession"},initialize:function(){this.model.on("change",this.render,this)},render:function(){var e=i({currentUser:this.model.toJSON()});return this.$el.empty().append(e),this},deleteSession:function(){$.ajax({contentType:"application/json; charset=UTF-8",dataType:"json",type:"DELETE",url:"/session",complete:function(e,t){t==="success"&&(sessionStorage.clear(),s.trigger("logout"),setTimeout(function(){window.location="/"}))}.bind(this)})}})}}),window.require.define({"views/base/view":function(e,t,n){n.exports=Backbone.View.extend({render:function(){var e;return this.template&&(e=_.isFunction(this.data)?this.data():this.data,this.$el.empty().append(t("views/templates/"+this.template)(e))),this}})}}),window.require.define({"views/blocks":function(e,t,n){var r=t("views/base/view"),i=t("views/templates/blocks"),s=t("application");n.exports=r.extend({id:"x-block-insert",className:"x-section",collection:s.editor.blocks,events:{"draginit #x-block-insert .x-drag":"dragInit","dragend #x-block-insert .x-drag":"dragEnd","click .x-new-block":"showForm","click .x-new-block-add":"addBlock","click .x-remove":"removeBlock"},initialize:function(){this.collection.on("reset",this.addAll,this),this.collection.on("add",this.addOne,this),this.collection.on("remove",this.removeOne,this),s.on("mutations:started",this.makeMutable.bind(this)),s.on("save:before",this.addThemeAttributes.bind(this)),this.allBlocks=_.map(s.data.blocks,function(e){return e.label=_.str.titleize(_.str.humanize(e.name)),e})},render:function(){return this.$el.empty().append(i({all:this.allBlocks})),this.collection.reset(this.collection.models),this},addOne:function(e){var t="";e.get("label")!="Default"&&(t=" <span class='x-remove' title='Delete block'>&times;</span>"),this.$("ul").append("<li><span class='x-drag' data-cid='"+e.cid+"'>"+"<span>&Dagger;</span> "+e.label()+t+"</span></li>")},addAll:function(){this.$("ul").empty(),_.each(this.collection.models,function(e){this.addOne(e)},this)},removeOne:function(e){this.$("span[data-cid='"+e.cid+"']").closest("li").remove()},dragInit:function(e,t){t.element=t.ghost()},dragEnd:function(e,t){var n=this.collection.getByCid(t.element.data("cid"));s.trigger("block:inserted",n,t.element)},makeMutable:function(e){e.blocks=this.collection},showForm:function(e){var t=this.$(".x-new-block-select");t.is(":hidden")?t.show("normal"):t.hide("normal")},addBlock:function(){var e,t,n,r,i;e=this.$(".x-new-block-select select").val(),t=this.$(".x-new-block-name").val();if(!t){s.trigger("notification","error","Please, enter a block name.");return}n=_.find(this.allBlocks,function(t){return t.name===e}),i=(new DOMParser).parseFromString(n.build,"text/html").body,i.firstChild.setAttribute("data-x-label",t),i.firstChild.setAttribute("data-x-name",e),n.build=i.outerHTML,n.label=t,this.collection.add(n),s.trigger("notification","success","New block created. Drag and drop into the page to add it.")},removeBlock:function(e){if(confirm("Are you sure you want to delete this block?")){var t=$(e.currentTarget).parent().data("cid");this.collection.remove(t)}},addThemeAttributes:function(e){e.blocks=_.map(this.collection.models,function(e){return _.pick(e.attributes,"_id","name","label","template")})}})}}),window.require.define({"views/download_button":function(e,t,n){var r=t("views/base/view"),i=t("application");n.exports=r.extend({id:"x-download-button",events:{"click button.x-download":"download","click button.x-login":"login"},initialize:function(){i.on("save:after",this.waitForArchive.bind(this))},render:function(){var e;return i.currentUser.id===void 0?e="<button class='x-btn x-btn-success x-login'>Login to Download</button>":e="<button class='x-btn x-btn-success x-download'>Download Theme</button>",this.$el.empty().append(e),this},login:function(){window.top.Backbone.history.navigate("/login",!0)},download:function(e){var t=$("#download-iframe",window.top.document),n="/themes/"+i.data.theme._id+"/download";e.preventDefault(),t.length===0?t=$("<iframe id='download-iframe' width='0' height='0' src='"+n+"'></iframe>").appendTo($("body",window.top.document)):t.attr("src",n)},waitForArchive:function(e){var t=this.$("button")[0],n=new EventSource("/jobs/"+e.get("archive_job_id"));t.setAttribute("disabled","true"),t.innerHTML="Rebuilding archive...",n.addEventListener("success",this.resetButton.bind(this),!1),n.addEventListener("errors",this.archiveErrors.bind(this),!1)},resetButton:function(e){var t=this.$("button")[0];e.currentTarget.close(),i.trigger("notification","success","Theme archive updated."),t.removeAttribute("disabled"),t.innerHTML="Download Theme"},archiveErrors:function(e){this.resetButton(),e.currentTarget.close(),i.trigger("notification","error","Error updating the theme archive.")}})}}),window.require.define({"views/editor":function(e,t,n){var r=t("application"),i=t("views/base/view"),s=t("lib/editor_data");n.exports=i.extend({el:"<div id='x-layout-editor'><div class='x-handle'></div></div>",events:{"draginit #x-layout-editor .x-handle":"dragInit","dragmove #x-layout-editor .x-handle":"dragMove","click h4":"showSection"},initialize:function(){_.extend(r.editor,{preview_only:!!r.data.preview_only,templates:s.templates,regions:s.regions,blocks:s.blocks,style:s.style,fork:this.options.fork})},render:function(){var e=r.reuseView("regions"),t=r.reuseView("blocks"),n=r.reuseView("style_edit"),i=r.reuseView("share_link"),s=r.reuseView("save_button"),o=r.reuseView("download_button");return this.$el.children(".x-handle").empty().append("&Dagger; <span>Theme: "+r.data.theme.name+"</span>").end().append("<h4>Current Template <span>&and;</span></h4>").append(r.reuseView("templates").render().$el),r.editor.preview_only||(this.$el.append("<h4>Header &amp; Footer <span>&and;</span></h4>").append(e.render().$el).append("<h4>Blocks <span>&or;</span></h4>").append(t.render().$el).append("<h4>Style <span>&or;</span></h4>").append(n.render().$el).append("<h4>Share <span>&or;</span></h4>").append(i.render().$el).append(s.render().$el).append(o.render().$el),r.reuseView("mutations"),r.createView("layout").render(),this.$(".x-section:not(#x-templates-select, #x-region-select)").hide()),this.$el.appendTo($("body")),this},showSection:function(e){$(e.target).next().slideToggle("slow",function(){var e=$(this),t=e.prev().children("span").empty();e.is(":hidden")?t.append("&or;"):t.append("&and;")})},dragInit:function(e,t){var n=t.mouseElementPosition;t.representative($(t.element).parent(),n.left(),n.top()).only()},dragMove:function(e,t){$(t.element).parent().css("zIndex",9999)}})}}),window.require.define({"views/faq":function(e,t,n){var r=t("views/base/view");n.exports=r.extend({className:"headline",template:"faq"})}}),window.require.define({"views/layout":function(e,t,n){var r,i,s=t("views/base/view"),o=t("application"),u=1;r=function(e,t){return _.reduce($(e).children(),function(e,n){return $(n).is(t)?e:e+$(n).outerWidth(!0)},0)},i=function(e,t){return $(e).width()<=r(e,t)+$(t).width()},n.exports=s.extend({el:$("body"),currentAction:null,events:{"click .columns":"highlightColumns","click .columns a":"preventDefault","mousedown .columns a, .columns img":"preventDefault","submit .columns form":"preventDefault","draginit .columns":"dragInit","dragend .columns":"dragEnd","dropover .row":"dropOver","dropout .row":"dropOut","dropon .row":"dropOn","draginit .x-resize":"resizeInit","dragmove .x-resize":"resizeMove","dragend .x-resize":"resizeEnd","click .columns .x-remove":"removeColumn"},initialize:function(){_.bindAll(this,"addDataBypass","removeDataBypass","insertColumn"),this.addDataBypass(),o.on("save:before",this.removeDataBypass),o.on("save:after",this.addDataBypass),o.on("save:error",this.addDataBypass),o.on("block:inserted",this.insertColumn)},removeDataBypass:function(){this.$(".columns a").removeAttr("data-bypass")},addDataBypass:function(){this.$(".columns a").attr("data-bypass",!0)},preventDefault:function(e){e.preventDefault()},highlightColumns:function(e){var t,n,r;if(this.currentAction!==null)return;o.trigger("editor:columnHighlight",e.currentTarget),t=$(e.currentTarget),this.$(".columns.x-current").removeClass("x-current"),t.addClass("x-current"),t.children(".x-resize").length===0&&t.html(function(e,t){return t+"<div class='x-resize' title='Resize element'>&harr;</div>"}),t.children(".x-remove").length===0&&t.html(function(e,t){return t+"<div class='x-remove' title='Remove element'>&times;</div>"});if(t.children(".x-name").length===0){n=t.children(":first").data("x-name"),label=t.children(":first").data("x-label");if(!n||!label)return;label=_.str.titleize(label+" "+_.str.humanize(n)),t.html(function(e,t){return t+"<div class='x-name'>"+label+"</div>"})}},dragInit:function(e,t){this.currentAction="drag",t.limit(this.$el.children()).revert()},dragEnd:function(e,t){$(t.element).css({top:t.startPosition.top()+"px",left:t.startPosition.left()+"px"}),this.currentAction=null},dropOver:function(e,t,n){$(t.element).addClass(function(){i(this,n.element)?$(this).addClass("x-full"):$(this).addClass("x-not-full")})},dropOut:function(e,t,n){$(t.element).removeClass("x-full x-not-full")},dropOn:function(e,t,n){var r,s,o,a;s=$(n.element),$drop=$(t.element),o=s.parent(),i($drop,s)?($row=$("<div class='row' id='y-"+u+"'></div>").insertAfter($drop),u++):$row=$drop,s.appendTo($row),$drop.removeClass("x-empty"),o.children().length===0&&(a=o.parent(),a.is("header, footer")&&a.children().length===1&&o.attr("id").indexOf("x-")!==0?o.addClass("x-empty"):o.remove()),$drop.removeClass("x-full x-not-full")},resizeInit:function(e,t){this.currentAction="resize",t.horizontal().only()},resizeMove:function(e,t){var n=$(t.element),i=n.parent(),s=i.parent();width=t.location.x()+n.width()/2-i.offset().left,width>=s.width()?(width=s.width(),e.preventDefault()):width>=s.width()-r(s,i)&&(width=s.width()-r(s,i),width-=1,e.preventDefault()),i.width(width),t.position(new $.Vector(width-n.width()/2+i.offset().left,t.location.y()))},resizeEnd:function(e,t){$(t.element).css({position:"absolute",right:"-12px",left:"auto"}),this.currentAction=null},removeColumn:function(e){var t=e.currentTarget.parentNode.parentNode;confirm("Are you sure you want to remove this element?")&&(t.children.length===1?$(t).remove():$(e.currentTarget.parentNode).remove())},insertColumn:function(e,t){t.parent().hasClass("row")&&(t[0].outerHTML="<div id='y-"+u+"' class='columns "+e.className()+"'>"+e.get("build")+"</div>",u++)}})}}),window.require.define({"views/login":function(e,t,n){var r=t("views/base/view"),i=t("application"),s=t("collections/themes");n.exports=r.extend({className:"modal",template:"login",model:i.currentUser,events:{"submit form":"loginUser"},loginUser:function(e){e.preventDefault(),this.validateInputs()&&this.submitData()},validateInputs:function(){var e=!0;return this.$("input").each(function(t,n){var r=n.getAttribute("name");if(n.value===""){var i=Backbone.Validation.labelFormatters.sentenceCase(r)+" can't be blank";Backbone.Validation.callbacks.invalid(this,r,i,"name"),e=!1}}.bind(this)),e},submitData:function(){var e={};this.$("input").each(function(t,n){var r=n.getAttribute("name");e[r]=n.value}),$.ajax({contentType:"application/json;charset=UTF-8",dataType:"json",type:"POST",url:"/session",data:JSON.stringify(e),complete:function(e,t){var n=JSON.parse(e.responseText);switch(t){case"success":this.model.set(n),this.model.set("themes",new s(n.themes)),i.trigger("login"),this.$el.modal("hide"),i.trigger("notification","success","Welcome back, "+this.model.get("first_name")+".");break;case"error":var r=this.$("form");r.children(".alert-error").length===0&&r.prepend("<p class='alert alert-error'>"+n.error+"</p>")}}.bind(this)})}})}}),window.require.define({"views/mutations":function(e,t,n){var r=t("views/base/view"),i=t("application");n.exports=r.extend({initialize:function(){_.bindAll(this),window.addEventListener("DOMContentLoaded",this.observeMutations),i.on("template:load",this.stopObserving),i.on("template:loaded",this.restartObserving),i.on("region:load",this.stopObserving),i.on("region:loaded",this.restartObserving)},stopObserving:function(){this.observer.disconnect()},restartObserving:function(){this.observer.reconnect()},observeMutations:function(){this.observer=new MutationSummary({rootNode:$("body")[0],queries:[{all:!0}],callback:this.propagateMutations}),this.pieces={},i.trigger("mutations:started",this.pieces)},propagateMutations:function(e){var t,n=e[0];t=function(e){return e.className&&e.className.indexOf("column")!==-1},isRow=function(e){return e.className&&e.className.indexOf("row")!==-1},n.added.forEach(function(e){t(e)?this.addNode(e,"column"):isRow(e)&&this.addNode(e,"row")}.bind(this)),n.removed.forEach(function(e){t(e)?this.removeNode(e,n.getOldParentNode(e),"column"):isRow(e)&&this.removeNode(e,n.getOldParentNode(e),"row")}.bind(this)),n.reparented.forEach(function(e){t(e)&&this.reparentNode(e,n.getOldParentNode(e))}.bind(this)),n.reordered.forEach(function(e){t(e)&&this.reorderNode(e,n.getOldPreviousSibling(e))}.bind(this))},addNode:function(e,t){var n,r,i,s,o,u,a,f;copy=e.cloneNode(!1);if(t==="column"){n=e.parentNode.parentNode;for(var l in this.pieces.blocks.models){u=this.pieces.blocks.models[l];if(e.className.indexOf(u.className())!==-1&&e.firstChild.getAttribute("data-x-label")===u.get("label")){copy.innerHTML=u.tag();break}}}else n=e.parentNode;piece=this.getTemplatePiece(n),o=(new DOMParser).parseFromString(piece.get("template"),"text/html"),s=o.getElementById(e.parentNode.id),e.nextElementSibling?"FOOTER"===e.nextElementSibling.tagName?o.body.innerHTML=o.body.innerHTML+e.outerHTML:(nextNode=o.getElementById(e.nextElementSibling.id),nextNode.parentNode&&nextNode.parentNode.insertBefore(copy,nextNode)):o.getElementById(e.parentNode.id).appendChild(copy),piece.set("template",o.body.innerHTML)},removeNode:function(e,t,n){var r;if(n==="column"){r=t.parentNode;if(r===null)return}else n==="row"&&(r=t);piece=this.getTemplatePiece(r),sandbox=(new DOMParser).parseFromString(piece.get("template"),"text/html"),copy=sandbox.getElementById(e.id),copy.parentNode.removeChild(copy),piece.set("template",sandbox.body.innerHTML)},reparentNode:function(e,t){this.addNode(e,"column"),t.parentNode!==null&&this.removeNode(e,t,"column")},reorderNode:function(e,t){this.addNode(e,"column")},getTemplatePiece:function(e){var t;return["HEADER","FOOTER"].indexOf(e.tagName)!==-1?(t=this.pieces.regions.getByName(e.tagName.toLowerCase()),t.set("build",e.outerHTML)):(t=this.pieces.templates.getCurrent(),templateClone=window.document.getElementById("page").cloneNode(!0),$(templateClone).children("header, footer").remove(),t.set("build",templateClone.innerHTML)),t}})}}),window.require.define({"views/not_found":function(e,t,n){var r=t("views/base/view");n.exports=r.extend({id:"not-found",template:"not_found"})}}),window.require.define({"views/notifications":function(e,t,n){var r=t("application"),i=t("views/base/view"),s=t("views/templates/notification");n.exports=i.extend({tagName:"ul",id:"notifications",className:"unstyled",initialize:function(){_.bindAll(this,"showNotification"),r.on("notification",this.showNotification)},showNotification:function(e,t){var n=$(s({type:e,text:t})).appendTo(this.$el);return setTimeout(function(){n.alert("close")},4e3),this}})}}),window.require.define({"views/password_reset":function(e,t,n){var r=t("views/base/view"),i=t("application");n.exports=r.extend({className:"modal",template:"password_reset",model:i.currentUser,events:{"submit form":"initiatePasswordReset"},initiatePasswordReset:function(e){e.preventDefault(),this.validateInputs()&&this.initiateReset()},validateInputs:function(){var e=!0;return this.$("form input").each(function(t,n){var r=n.getAttribute("name");if(n.value===""){var i=Backbone.Validation.labelFormatters.sentenceCase(r)+" can't be blank";Backbone.Validation.callbacks.invalid(this,r,i,"name"),e=!1}}.bind(this)),e},initiateReset:function(){var e={email:this.$("input[name=email]")[0].value,password:this.$("input[name=password]")[0].value};$.ajax({contentType:"application/json;charset=UTF-8",dataType:"json",type:"POST",url:"/users/reset_password",data:JSON.stringify(e),complete:function(e,t){switch(t){case"success":this.$el.modal("hide"),i.trigger("notification","success","We have sent you an email with a link to confirm your new password.");break;case"error":}}.bind(this)})}})}}),window.require.define({"views/preview":function(e,t,n){var r=t("application"),i=t("views/base/view"),s=t("lib/editor_data");n.exports=i.extend({el:$("body"),events:{"draginit #x-layout-editor .x-handle":"dragInit","dragmove #x-layout-editor .x-handle":"dragMove","click a:not(#x-customize-button a)":"stopPropagation","click #x-customize-button a":"loadEditor"},initialize:function(){_.extend(r.editor,{preview_only:!!r.data.preview_only,templates:s.templates,regions:s.regions,blocks:s.blocks,style:s.style})},render:function(){var e;return this.$el.append("<div id='x-layout-editor'><div class='x-handle'>&Dagger; <span>Theme: "+r.data.theme.name+"</span></div>"+"<h4>Current Template <span>&and;</span></h4>"+"</div>"),e=this.$("#x-layout-editor"),e.append(r.reuseView("templates_select").render().$el).append("<div id='x-customize-button'><a class='x-btn x-btn-primary'>Customize Theme</a></div>"),r.editor.preview_only||e.append(r.reuseView("download_button").render().$el),this},dragInit:function(e,t){var n=t.mouseElementPosition;t.representative($(t.element).parent(),n.left(),n.top()).only()},dragMove:function(e,t){$(t.element).parent().css("zIndex",9999)},stopPropagation:function(){return!1},loadEditor:function(e){window.top.Backbone.history.navigate(window.top.Backbone.history.fragment+"/fork",!0)}})}}),window.require.define({"views/regions":function(e,t,n){var r=t("views/base/view"),i=t("views/templates/regions"),s=t("application"),o=t("models/region");n.exports=r.extend({id:"x-region-select",className:"x-section",collection:s.editor.regions,events:{"change .x-header-select, .x-footer-select":"switchRegion","click .x-header-new button, .x-footer-new button":"addRegion"},initialize:function(){_.bindAll(this,"addThemeAttributes","makeMutable","addRegionsToTemplate"),this.collection.on("add",this.addOne,this),s.on("save:before",this.addThemeAttributes),s.on("mutations:started",this.makeMutable),s.on("template:load",this.addRegionsToTemplate)},render:function(){return this.$el.empty().append(i({headers:this.collection.where({name:"header"}).map(function(e){return e.attributes}),footers:this.collection.where({name:"footer"}).map(function(e){return e.attributes})})),this.$(".x-header-new, .x-footer-new").hide(),this},switchRegion:function(e){var t,n,r;e.target.className.indexOf("header")!=-1?t="header":t="footer",n=$(e.target).val(),this.toggleForm(t,n),n&&this.loadRegion(this.collection.getByName(t,n))},toggleForm:function(e,t){t?this.$(".x-"+e+"-new").hide("slow"):this.$(".x-"+e+"-new").show("slow")},loadRegion:function(e){var t=e.get("name");s.trigger("region:load",e),$("#page").children(t)[0].outerHTML=e.get("build"),$("#page").children(t).fadeOut().fadeIn(),s.trigger("region:loaded",e)},addRegion:function(e){var t,n,r,i;e.currentTarget.className.indexOf("header")!=-1?t="header":t="footer",n=_.str.slugify(this.$(".x-"+t+"-new input").val());if(!n){s.trigger("notification","error","Please, enter a "+t+" name.");return}attributes=_.pick(this.collection.getByName(t).attributes,"name","template","build"),attributes.slug=n,r=new o(attributes),this.collection.add(r),this.loadRegion(r),$(e.currentTarget).parent().hide("slow"),s.trigger("notification","success","The new "+t+" was created. It's a copy of the default one.")},addOne:function(e){var t;t=e.get("slug"),this.$(".x-"+e.get("name")+"-select").children(":selected").removeAttr("selected").end().children("[value='']").before("<option value='"+t+"' selected='selected'>"+t+"</option>")},addThemeAttributes:function(e){e.regions=_.map(this.collection.models,function(e){return _.pick(e.attributes,"_id","name","slug","template")})},makeMutable:function(e){e.regions=this.collection},addRegionsToTemplate:function(e){var t=e.get("regions");e.set("regions_attributes",{header:this.collection.getByName("header",t.header),footer:this.collection.getByName("footer",t.footer)})}})}}),window.require.define({"views/register":function(e,t,n){var r=t("views/base/view"),i=t("application");n.exports=r.extend({className:"modal",template:"register",model:i.currentUser,events:{"submit form":"createUser"},initialize:function(){Backbone.Validation.bind(this)},createUser:function(e){e.preventDefault();var t=this.model,n={};this.$("input").each(function(){n[this.getAttribute("name")]=this.value}),t.save(n,{success:function(e,t){e.set(t),i.trigger("notification","success","Your registration was successful. You are now logged in."),this.$el.modal("hide")}.bind(this),error:function(e,t){this.displayServerErrors(t)}.bind(this)})},displayServerErrors:function(e){if(!e.responseText)return;var t=JSON.parse(e.responseText);Object.keys(t).forEach(function(e){var n=Backbone.Validation.labelFormatters.sentenceCase(e)+" "+t[e][0];Backbone.Validation.callbacks.invalid(this,e,n,"name")}.bind(this))}})}}),window.require.define({"views/save_button":function(e,t,n){var r=t("views/base/view"),i=t("application");n.exports=r.extend({id:"x-save-button",events:{"click button.x-save":"save"},render:function(){var e;return i.currentUser.id&&(e="<button class='x-btn x-btn-primary x-save'>Save Theme</button>"),this.$el.empty().append(e),this},save:function(e){var t=_.clone(i.data.theme);i.editor.fork&&(t.parent_id=t._id,t._id=null),e.target.setAttribute("disabled","true"),i.trigger("save:before",t),i.currentUser.get("themes").create(t,{success:function(t){i.trigger("save:after",t),e.target.removeAttribute("disabled"),i.trigger("notification","success","Theme saved."),window.top.Backbone.history.navigate("/themes/"+t.id+"/edit",!0)},error:function(t,n){i.trigger("save:error"),e.target.removeAttribute("disabled"),i.trigger("notification","error","Unable to save the theme. Please try again.")}})}})}}),window.require.define({"views/share_link":function(e,t,n){var r=t("views/base/view"),i=t("application");n.exports=r.extend({id:"x-share-link",className:"x-section",template:"share_link",data:{theme:i.data.theme._id}})}}),window.require.define({"views/style_edit":function(e,t,n){var r=t("views/base/view"),i=t("views/templates/style_edit"),s=t("application"),o=t("lib/html_tags");n.exports=r.extend({id:"x-style-edit",className:"x-section",events:{"change .x-element":"setSelector","change .x-tag":"setTag","click button":"addInputs","keyup input":"addStyle","blur input":"addStyle","change input":"addStyle"},initialize:function(){_.bindAll(this,"setColumn","addThemeAttributes"),s.on("editor:columnHighlight",this.setColumn),s.on("save:before",this.addThemeAttributes),this.selector="body",this.customCSS=s.editor.style},setSelector:function(e){var t=$(e.target).val();switch(t){case"body":case"#page > header":case"#page > footer":this.selector=t;break;case"column":this.selector=this.column}this.render()},setTag:function(e){this.tag=$(e.target).val(),this.render()},setColumn:function(e){this.column="#"+e.id,this.$("select").val()==="column"&&(this.selector=this.column,this.render())},render:function(){var e;return this.tag?e=this.customCSS.rules[this.selector+" "+this.tag]:e=this.customCSS.rules[this.selector],e=_.map(e,function(e,t){return e.property=t,e}),this.$el.html(i({elements:this.elementOptions(),htmlTags:this.tagOptions(),selector:this.selector,rules:e})),["body","#page > header","#page > footer"].indexOf(this.$("select").val())!==-1&&this.$(".x-choice").hide(),this},elementOptions:function(){return[{label:"Whole Document",value:"body",selected:this.selector==="body"?" selected":""},{label:"Header",value:"#page > header",selected:this.selector==="#page > header"?" selected":""},{label:"Footer",value:"#page > footer",selected:this.selector==="#page > footer"?" selected":""},{label:"Selected Element",value:"column",selected:["body","#page > header","#page > footer"].indexOf(this.selector)===-1?" selected":""}]},tagOptions:function(){var e=this;return o.map(function(t){return t.tags=t.tags.map(function(t){return t.selected=t.tag===e.tag?" selected":"",t}),t})},addInputs:function(e){e.preventDefault(),this.$("ul").append("<li><input name='property' value='' placeholder='property' />:<input name='value' value='' placeholder='value' /><input type='hidden' name='index' /></li>")},addStyle:function(e){var t,n,r,i,s=$(e.target).parent();t=this.selector,this.tag&&(t+=" "+this.tag),n=s.find("input[name=property]").val(),r=s.find("input[name=value]").val(),i=s.find("input[name=index]").val()||null,i=this.customCSS.insertRule(t,n,r,i),s.find("input[name=index]").val(i)},addThemeAttributes:function(e){e.style=this.customCSS.rules}})}}),window.require.define({"views/templates":function(e,t,n){var r=t("views/base/view"),i=t("application"),s=t("models/template"),o=t("views/templates/templates");n.exports=r.extend({id:"x-templates-select",className:"x-section",collection:i.editor.templates,events:{"change ul input":"switchTemplate","focus ul input":"switchTemplate","blur ul input":"switchTemplate","click .x-remove":"removeTemplate","click .x-new-template":"showForm","change .x-new-template-select select":"selectTemplate","click .x-new-template-add":"addTemplate"},initialize:function(e){_.bindAll(this,"addThemeAttributes","makeMutable","saveRegion"),this.collection.on("add",this.addOne,this),this.collection.on("reset",this.addAll,this),this.collection.on("remove",this.removeOne,this),i.on("save:before",this.addThemeAttributes),i.on("mutations:started",this.makeMutable),i.on("region:load",this.saveRegion)},render:function(){var e=_.reject((new s).standards,function(e){return!!this.collection.getByName(e.name)}.bind(this));return this.$el.empty().append(o({standards:e,edit:!i.editor.preview_only})),this.collection.reset(this.collection.models),this.loadTemplate(this.collection.getCurrent()),this},addOne:function(e){var t="",n="",r="";e.cid===this.collection.getCurrent().cid&&(t=" checked='checked'",n=" class='x-current'"),e.get("name")!="index"&&(r="<span class='x-remove' title='Delete template'>&times;</span>"),this.$("ul").append("<li"+n+"><label><input name='x-template'"+t+" type='radio' value='"+e.cid+"' />"+e.label()+"</label>"+r+"</li>")},addAll:function(){this.$("ul").empty(),_.each(this.collection.models,function(e){this.addOne(e)},this)},removeOne:function(e){this.$("input[value='"+e.cid+"']").closest("li").remove()},switchTemplate:function(){var e=this.collection.getByCid(this.$("ul input:checked").val());this.$("ul li").removeClass("x-current"),this.$("ul input:checked").closest("li").addClass("x-current"),this.loadTemplate(e)},loadTemplate:function(e){var t;i.trigger("template:load",e),t=e.get("regions_attributes"),build=t.header.get("build")+e.get("build")+t.footer.get("build"),$("#page").fadeOut().empty().append(build).fadeIn(),this.collection.setCurrent(e),i.trigger("template:loaded",e)},removeTemplate:function(e){if(confirm("Are you sure you want to delete this template?")){var t=$(e.currentTarget).parent().find("input").val();this.collection.remove(t)}},showForm:function(e){var t=this.$(".x-new-template-select");t.is(":hidden")?t.show("normal"):t.hide("normal")},selectTemplate:function(e){$(e.currentTarget).val()===""?this.$(".x-new-template-name").show():this.$(".x-new-template-name").hide()},addTemplate:function(){var e,t,n;e=this.$(".x-new-template-select select").val()||this.$(".x-new-template-name").val();if(!e){i.trigger("notification","error","Please, enter a template name.");return}t=_.pick(this.collection.getByName("index").attributes,"template","build","regions"),t.name=e,n=new s(t),this.collection.add(n),this.collection.setCurrent(n),this.render(),i.trigger("notification","success","The new template was created. It's a copy of the default one.")},addThemeAttributes:function(e){e.templates=_.map(this.collection.models,function(e){return _.pick(e.attributes,"_id","name","template")})},makeMutable:function(e){e.templates=this.collection},saveRegion:function(e){this.collection.getCurrent().setRegion(e.get("name"),e.get("slug"))}})}}),window.require.define({"views/templates/auth_links":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function c(e,t){return'\n  <ul class="nav">\n    <li><a href="/me/themes" id="your_themes">Your themes</a></li>\n    <li><a href="/upload" id="upload_theme">Upload</a></li>\n  </ul>\n  <button class="btn" id="logout">Log out</button>\n'}function h(e,t){return'\n  <ul class="nav">\n    <li><a id="register" href="/register">Register</a></li>\n    <li><a id="login" href="/login">Log in</a></li>\n  </ul>\n'}n=n||e.helpers;var s="",o,u,a,f,l=this;a=n.currentUser,o=a||t.currentUser,o=o===null||o===undefined||o===!1?o:o.id,u=n["if"],f=l.program(1,c,i),f.hash={},f.fn=f,f.inverse=l.program(3,h,i),o=u.call(t,o,f);if(o||o===0)s+=o;return s+="\n",s})}}),window.require.define({"views/templates/blocks":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function v(e,t){var r="",i;return r+='\n      <option value="',a=n.name,i=a||e.name,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"name",{hash:{}})),r+=d(i)+'">',a=n.label,i=a||e.label,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"label",{hash:{}})),r+=d(i)+"</option>\n      ",r}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;s+='<p>Drag and drop to insert</p>\n<ul class=\'x-rects\'></ul>\n<button class="x-new-block">&plus; New Block</button>\n<div class="x-new-block-select">\n  <label>Type:\n    <select>\n      ',a=n.all,o=a||t.all,u=n.each,f=l.program(1,v,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;return s+='\n    </select>\n  </label>\n  <input class="x-new-block-name" type="text" value="" placeholder="Name" />\n  <button class="x-new-block-add">Add</button>\n</div>\n',s})}}),window.require.define({"views/templates/faq":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s,o=this;return'<h1 class="catch-phrase">The next generation theme editor<br /> in your browser</h1>\n<p>Build your own responsive HTML5 and WordPress themes in minutes!</p>\n<p><a href="/register" class="btn btn-large btn-primary">Get Started Now</a></p>\n'})}}),window.require.define({"views/templates/login":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s,o=this;return'<div class="modal-header">\n  <button type="button" class="close" data-dismiss="modal">×</button>\n  <h3>Please authenticate yourself</h3>\n</div>\n<div class="modal-body">\n  <form class="form-horizontal">\n    <fieldset>\n      <div class="control-group">\n        <label class="control-label" for="email">Email Address</label>\n        <div class="controls">\n          <input type="text" name="email" class="input-xlarge">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <label class="control-label" for="password">Password</label>\n        <div class="controls">\n          <input type="password" name="password" class="input-xlarge">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <div class="controls">\n          <button type="submit" class="btn btn-primary">Log In</button>\n        </div>\n      </div>\n    </fieldset>\n  </form>\n  <ul class="unstyled">\n    <li>Forgot your password? <a href="/reset_password" data-dismiss="modal">Reset password</a></li>\n    <li>Don\'t have an account yet? <a href="/register" data-dismiss="modal">Register</a></li>\n  </ul>\n</div>\n'})}}),window.require.define({"views/templates/not_found":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s,o=this;return'<h1 class="page-header">Ooops! We screwed up. :(</h1>\n<p class="lead">Sorry, the page you were looking for doesn’t exist.</p>\n<p>Go back to <a href="/" title="thememy.com">homepage</a> or contact us about a problem.</p>\n'})}}),window.require.define({"views/templates/notification":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0,h=this.escapeExpression;return s+='<li class="alert alert-',u=n.type,o=u||t.type,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"type",{hash:{}})),s+=h(o)+' fade in"><button class="close" data-dismiss="alert">×</button> ',u=n.text,o=u||t.text,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"text",{hash:{}})),s+=h(o)+"</li>\n",s})}}),window.require.define({"views/templates/password_reset":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s,o=this;return'<div class="modal-header">\n  <button type="button" class="close" data-dismiss="modal">×</button>\n  <h3>Reset password</h3>\n</div>\n<div class="modal-body">\n  <form class="form-horizontal" id="password_reset">\n    <fieldset>\n      <div class="control-group">\n        <label class="control-label" for="email">Email Address</label>\n        <div class="controls">\n          <input type="text" name="email" class="input-xlarge">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <label class="control-label" for="password">New Password</label>\n        <div class="controls">\n          <input type="password" name="password" class="input-xlarge">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <div class="controls">\n          <button type="submit" class="btn btn-primary">Send reset email</button>\n        </div>\n      </div>\n    </fieldset>\n  </form>\n  <ul class="unstyled">\n    <li>Remember your password? <a href="/login" data-dismiss="modal">Log in</a></li>\n    <li>Don\'t have an account yet? <a href="/register" data-dismiss="modal">Register</a></li>\n  </ul>\n</div>\n'})}}),window.require.define({"views/templates/regions":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function v(e,t){var r="",i;return r+='\n  <option value="',a=n.slug,i=a||e.slug,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"slug",{hash:{}})),r+=d(i)+'">',a=n.slug,i=a||e.slug,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"slug",{hash:{}})),r+=d(i)+"</option>\n  ",r}function m(e,t){var r="",i;return r+='\n  <option value="',a=n.slug,i=a||e.slug,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"slug",{hash:{}})),r+=d(i)+'">',a=n.slug,i=a||e.slug,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"slug",{hash:{}})),r+=d(i)+"</option>\n  ",r}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;s+='<label>Header:</label>\n<select class="x-header-select">\n  ',a=n.headers,o=a||t.headers,u=n.each,f=l.program(1,v,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;s+='\n  <option value="">new header</option>\n</select>\n<div class="x-header-new">\n  <input type="text" value="" placeholder="Enter header name" />\n  <button class="x-header-add">Add</button>\n</div>\n\n<label>Footer:</label>\n<select class="x-footer-select">\n  ',a=n.footers,o=a||t.footers,u=n.each,f=l.program(3,m,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;return s+='\n  <option value="">new footer</option>\n</select>\n<div class="x-footer-new">\n  <input type="text" value="" placeholder="Enter footer name" />\n  <button class="x-footer-add">Add</button>\n</div>\n',s})}}),window.require.define({"views/templates/register":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s,o=this;return'<div class="modal-header">\n  <button type="button" class="close" data-dismiss="modal">×</button>\n  <h3>Create an account</h3>\n</div>\n<div class="modal-body">\n  <form class="form-horizontal">\n    <fieldset>\n      <div class="control-group">\n        <label class="control-label" for="new-first-name">First Name</label>\n        <div class="controls">\n          <input type="text" class="input-xlarge" name="first_name">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <label class="control-label" for="new-last-name">Last Name</label>\n        <div class="controls">\n          <input type="text" class="input-xlarge" name="last_name">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <label class="control-label" for="new-email">Email Address</label>\n        <div class="controls">\n          <input type="text" class="input-xlarge" name="email">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <label class="control-label" for="new-password">Password</label>\n        <div class="controls">\n          <input type="password" class="input-xlarge" name="password">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <label class="control-label" for="new-password-confirmation">Password Confirmation</label>\n        <div class="controls">\n          <input type="password" class="input-xlarge" name="password_confirmation">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <div class="controls">\n          <button type="submit" class="btn btn-primary submit">Register</button>\n        </div>\n      </div>\n    </fieldset>\n  </form>\n  <ul class="unstyled">\n    <li>Already have an account? <a href="/login" data-dismiss="modal">Log in</a></li>\n  </ul>\n</div>\n'})}}),window.require.define({"views/templates/share_link":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0,h=this.escapeExpression;return s+="<p>http://thememy.com/themes/",u=n.theme,o=u||t.theme,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"theme",{hash:{}})),s+=h(o)+"</p>\n",s})}}),window.require.define({"views/templates/style_edit":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function v(e,t){var r="",i;return r+='\n    <option value="',a=n.value,i=a||e.value,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"value",{hash:{}})),r+=d(i)+'"',a=n.selected,i=a||e.selected,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"selected",{hash:{}})),r+=d(i)+">",a=n.label,i=a||e.label,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"label",{hash:{}})),r+=d(i)+"</option>\n    ",r}function m(e,t){var r="",i,s;r+='\n    <optgroup label="',a=n.group,i=a||e.group,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"group",{hash:{}})),r+=d(i)+'">\n      ',a=n.tags,i=a||e.tags,s=n.each,f=l.program(4,g,t),f.hash={},f.fn=f,f.inverse=l.noop,i=s.call(e,i,f);if(i||i===0)r+=i;return r+="\n    </optgroup>\n    ",r}function g(e,t){var r="",i;return r+='\n      <option value="',a=n.tag,i=a||e.tag,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"tag",{hash:{}})),r+=d(i)+'"',a=n.selected,i=a||e.selected,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"selected",{hash:{}})),r+=d(i)+">",a=n.label,i=a||e.label,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"label",{hash:{}})),r+=d(i)+" (",a=n.tag,i=a||e.tag,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"tag",{hash:{}})),r+=d(i)+")</option>\n      ",r}function y(e,t){var r="",i;return r+="\n  Selected Element: <b>",a=n.selector,i=a||e.selector,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"selector",{hash:{}})),r+=d(i)+"</b>\n  ",r}function b(e,t){return"\n  Click on an element in the design to customize it.\n  "}function w(e,t){var r="",i;return r+='\n    <li>\n      <input name="property" value="',a=n.property,i=a||e.property,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"property",{hash:{}})),r+=d(i)+'" />:\n      <input name="value" value="',a=n.value,i=a||e.value,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"value",{hash:{}})),r+=d(i)+'" />\n      <input type="hidden" name="index" value="',a=n.index,i=a||e.index,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"index",{hash:{}})),r+=d(i)+'" />\n    </li>\n    ',r}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;s+='<form>\n  <select class="x-element">\n    ',a=n.elements,o=a||t.elements,u=n.each,f=l.program(1,v,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;s+='\n  </select>\n\n  <select class="x-tag">\n    <option value="">Every Tag</option>\n    ',a=n.htmlTags,o=a||t.htmlTags,u=n.each,f=l.program(3,m,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;s+='\n  </select>\n\n  <p class="x-choice">\n  ',a=n.selector,o=a||t.selector,u=n["if"],f=l.program(6,y,i),f.hash={},f.fn=f,f.inverse=l.program(8,b,i),o=u.call(t,o,f);if(o||o===0)s+=o;s+='\n  </p>\n\n  <ul class="x-rules">\n    ',a=n.rules,o=a||t.rules,u=n.each,f=l.program(10,w,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;return s+="\n  </ul>\n  <button>Add custom style</button>\n</form>\n",s})}}),window.require.define({"views/templates/templates":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function v(e,t){var r="",i,s;r+='\n<button class="x-new-template">&plus; New Template</button>\n<div class="x-new-template-select">\n  <label>Choose:\n    <select>\n      ',a=n.standards,i=a||e.standards,s=n.each,f=l.program(2,m,t),f.hash={},f.fn=f,f.inverse=l.noop,i=s.call(e,i,f);if(i||i===0)r+=i;return r+='\n      <option value="">Other</option>\n    </select>\n  </label>\n  <input class="x-new-template-name" type="text" value="" placeholder="Enter template name" />\n  <button class="x-new-template-add">Add</button>\n</div>\n',r}function m(e,t){var r="",i;return r+='\n      <option value="',a=n.name,i=a||e.name,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"name",{hash:{}})),r+=d(i)+'">',a=n.label,i=a||e.label,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"label",{hash:{}})),r+=d(i)+"</option>\n      ",r}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;s+='<p>Click to change</p>\n<ul class="x-rects"></ul>\n',a=n.edit,o=a||t.edit,u=n["if"],f=l.program(1,v,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;return s+="\n",s})}}),window.require.define({"views/templates/templates_select":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function v(e,t){var r="",i;return r+='\n  <option value="',a=n.id,i=a||e.id,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"id",{hash:{}})),r+=d(i)+'"',a=n.selected,i=a||e.selected,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"selected",{hash:{}})),r+=d(i)+">",a=n.label,i=a||e.label,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"label",{hash:{}})),r+=d(i)+"</option>\n  ",r}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;s+="<p>Click to change</p>\n<select>\n  ",a=n.templates,o=a||t.templates,u=n.each,f=l.program(1,v,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;return s+="\n</select>\n",s})}}),window.require.define({"views/templates/theme":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function v(e,t){var r="",i;return r+="/",a=n.action,i=a||e.action,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"action",{hash:{}})),r+=d(i),r}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;s+='<iframe id="theme" name="theme" src="/',a=n.route,o=a||t.route,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"route",{hash:{}})),s+=d(o)+"/",a=n.id,o=a||t.id,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"id",{hash:{}})),s+=d(o),a=n.action,o=a||t.action,u=n["if"],f=l.program(1,v,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;return s+='" frameborder="0" width="100%" height="100%"></iframe>\n',s})}}),window.require.define({"views/templates/theme_list":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function v(e,t){var r="",i;return r+='\n      <p>by <a href="#">',a=n.author,i=a||e.author,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"author",{hash:{}})),r+=d(i)+"</a></p>\n      ",r}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;s+='<li class="span3">\n  <div class="thumbnail">\n    <a href="',a=n.uri,o=a||t.uri,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"uri",{hash:{}})),s+=d(o)+'"><img src="',a=n.screenshot_uri,o=a||t.screenshot_uri,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"screenshot_uri",{hash:{}})),s+=d(o)+'" alt=""></a>\n    <div class="caption">\n      <h4>',a=n.name,o=a||t.name,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"name",{hash:{}})),s+=d(o)+"</h4>\n      ",a=n.author,o=a||t.author,u=n["if"],f=l.program(1,v,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;return s+='\n      <div>\n        <a class="btn btn-primary pull-right" href="',a=n.uri,o=a||t.uri,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"uri",{hash:{}})),s+=d(o)+'"><i class="icon-pencil icon-white"></i> ',a=n.edit_text,o=a||t.edit_text,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"edit_text",{hash:{}})),s+=d(o)+"</a>\n      </div>\n    </div>\n  </div>\n</li>\n",s})}}),window.require.define({"views/templates/theme_upload":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s,o=this;return'<div class="modal-header">\n  <button type="button" class="close" data-dismiss="modal">×</button>\n  <h3>Upload a new theme</h3>\n</div>\n<div class="modal-body">\n  <form class="form-horizontal">\n    <fieldset>\n      <div class="control-group">\n        <label class="control-label" for="file">Theme Archive</label>\n        <div class="controls">\n          <input type="file" name="file" class="input-xlarge">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <div class="controls">\n          <button type="submit" class="btn btn-primary">Upload Theme</button>\n        </div>\n      </div>\n    </fieldset>\n  </form>\n</div>\n'})}}),window.require.define({"views/templates_select":function(e,t,n){var r=t("views/base/view"),i=t("application"),s=t("models/template"),o=t("views/templates/templates");n.exports=r.extend({id:"x-templates-select",className:"x-section",template:"templates_select",collection:i.editor.templates,data:{templates:i.editor.templates.map(function(e){return{id:e.id,label:e.label(),selected:e.get("name")==="index"?" selected='selected'":""}})},events:{"change select":"switchTemplate"},switchTemplate:function(){var e=this.collection.get(this.$("select").val());$("#page").fadeOut().empty().append(e.get("full")).fadeIn()}})}}),window.require.define({"views/theme":function(e,t,n){var r=t("views/base/view"),i=t("application");n.exports=r.extend({template:"theme",data:function(){return{route:this.options.route,id:this.options.themeID,action:this.options.action||""}}})}}),window.require.define({"views/theme_list":function(e,t,n){var r=t("views/base/view"),i=t("collections/themes"),s=t("views/templates/theme_list"),o=t("application");n.exports=r.extend({el:$("<ul class='thumbnails'></ul>"),initialize:function(){this.bindEvents()},render:function(){return this.collection.reset(this.collection.models),this},bindEvents:function(){this.collection.on("reset",this.addAll,this)},addOne:function(e){var t=e.get("author_id")===o.currentUser.id;this.$el.append(s({uri:"/themes/"+e.id+(t?"/edit":""),screenshot_uri:e.get("screenshot_uri"),name:e.get("name"),author:e.get("author"),edit_text:t?"Edit":"View & Customise"}))},addAll:function(){this.$el.empty(),this.collection.each(function(e){this.addOne(e)},this)}})}}),window.require.define({"views/theme_upload":function(e,t,n){var r=t("views/base/view"),i=t("application");n.exports=r.extend({className:"modal",template:"theme_upload",events:{"submit form":"sendFormData"},sendFormData:function(e){var t=this.$("form"),n=this.$("button[type=submit]")[0];e.preventDefault(),n.setAttribute("disabled","true"),n.innerHTML="Processing. Please wait for a moment...",t.children(".alert-error").remove(),i.trigger("upload:before"),$.ajax({type:"POST",url:"/theme_upload",data:new FormData(t[0]),success:function(e,t,n){var r=new EventSource("/jobs/"+e.job_id);r.addEventListener("success",this.themeUploaded.bind(this),!1),r.addEventListener("errors",this.themeErrors.bind(this),!1)}.bind(this),error:function(e,r,i){t.prepend("<p class='alert alert-error'>"+i+" Please refresh the page and try again.</p>"),n.removeAttribute("disabled"),n.innerHTML="Upload Theme"},cache:!1,contentType:!1,dataType:"json",processData:!1})},themeUploaded:function(e){var t=JSON.parse(e.data);e.currentTarget.close(),i.trigger("upload:after",t),i.trigger("notification","success","Your theme is uploaded and ready to be edited!"),this.$el.modal("hide"),Backbone.history.navigate("/themes/"+t._id+"/edit",!0)},themeErrors:function(e){var t,n=JSON.parse(e.data),r=this.$("button[type=submit]")[0];e.currentTarget.close();for(t in n)n.hasOwnProperty(t)&&this.$("form").prepend("<p class='alert alert-error'>"+_.str.humanize(t)+" "+n[t]+"</p>");r.removeAttribute("disabled"),r.innerHTML="Upload Theme"}})}})