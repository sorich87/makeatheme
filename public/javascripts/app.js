(function(){"use strict";var e=typeof window!="undefined"?window:global;if(typeof e.require=="function")return;var t={},n={},r=function(e,t){return{}.hasOwnProperty.call(e,t)},i=function(e,t){var n=[],r,i;/^\.\.?(\/|$)/.test(t)?r=[e,t].join("/").split("/"):r=t.split("/");for(var s=0,o=r.length;s<o;s++)i=r[s],i===".."?n.pop():i!=="."&&i!==""&&n.push(i);return n.join("/")},s=function(e){return e.split("/").slice(0,-1).join("/")},o=function(t){return function(n){var r=s(t),o=i(r,n);return e.require(o)}},u=function(e,t){var r={id:e,exports:{}};t(r.exports,o(e),r);var i=n[e]=r.exports;return i},a=function(e){var s=i(e,".");if(r(n,s))return n[s];if(r(t,s))return u(s,t[s]);var o=i(s,"./index");if(r(n,o))return n[o];if(r(t,o))return u(o,t[o]);throw new Error('Cannot find module "'+e+'"')},f=function(e){for(var n in e)r(e,n)&&(t[n]=e[n])};e.require=a,e.require.define=f,e.require.brunch=!0})(),window.require.define({application:function(e,t,n){Application=window.Application||{},_.extend(Application,{initialize:function(){var e=t("router");this.createView("notifications").render().$el.appendTo($("body",window.top.document)),this.setCurrentUser(),this.router=new e,this.reuseView("auth_links").render(),this.setBodyClasses(),this.setEditorWidth(),this.editor={},Object.freeze(this)},createView:function(e,n){var r=this.views||{},i=t("views/"+e);return r[e]!==void 0&&(r[e].undelegateEvents(),r[e].remove(),r[e].off()),r[e]=new i(n),this.views=r,r[e]},reuseView:function(e,n){var r=this.views||{},i=t("views/"+e);return r[e]!==void 0?r[e]:(r[e]=new i(n),this.views=r,r[e])},setBodyClasses:function(){Backbone.history.on("route",function(e,t){this.currentUser.id||(t+=" anonymous"),document.body.className=t}.bind(this))},setEditorWidth:function(){Backbone.history.on("route",function(e,t){t==="theme"?$("#main").width($(window).width()-250).height($(window).height()-60):$("#main").removeAttr("style"),$("#layout-editor").remove()})},setCurrentUser:function(){var e=t("models/user"),n=t("collections/themes");this.data.currentUser?(this.currentUser=new e(this.data.currentUser),this.currentUser.set("themes",new n(this.data.currentUser.themes))):this.currentUser=new e,this.on("upload:after",this.updateCurrentUserThemes)},updateCurrentUserThemes:function(e){this.currentUser.get("themes").add(e)}},Backbone.Events),n.exports=Application}}),window.require.define({"collections/base/collection":function(e,t,n){n.exports=Backbone.Collection.extend({})}}),window.require.define({"collections/blocks":function(e,t,n){var r=t("collections/base/collection"),i=t("models/block");n.exports=r.extend({model:i,getByName:function(e){return this.find(function(t){return t.get("name")===e})}})}}),window.require.define({"collections/regions":function(e,t,n){var r=t("collections/base/collection"),i=t("models/region");n.exports=r.extend({model:i,getByName:function(e,t){return t===void 0&&(t="default"),this.find(function(n){return n.get("slug")===t&&n.get("name")===e})}})}}),window.require.define({"collections/templates":function(e,t,n){var r=t("collections/base/collection"),i=t("models/template");n.exports=r.extend({model:i,getByName:function(e){return this.find(function(t){return t.get("name")===e})},getCurrent:function(){var e=this.find(function(e){return e.get("current")===!0});return e||(e=this.getByName("index")),e},setCurrent:function(e){var t=this.getCurrent();t&&t.set("current",!1),e.set("current",!0)}})}}),window.require.define({"collections/themes":function(e,t,n){var r=t("collections/base/collection"),i=t("models/theme");n.exports=r.extend({model:i,url:"/themes"})}}),window.require.define({initialize:function(e,t,n){var r=t("application");jQuery(function(e){r.initialize(),Backbone.history.start({pushState:!0}),e(document).on("hidden",".modal",function(){e("#main").children().length===0?Backbone.history.navigate("/",!0):Backbone.history.back(!0)}),e(document).on("click","a:not([data-bypass])",function(t){var n={prop:e(this).prop("href"),attr:e(this).attr("href")},r=location.protocol+"//"+location.host+"/";n.prop&&n.prop.slice(0,r.length)===r&&(t.preventDefault(),Backbone.history.navigate(n.attr,{trigger:!0,replace:!!e(this).data("replace")}))}),Backbone.history.on("route",function(e,t){if("_gaq"in window){var n="/"+this.getFragment();_gaq.push(["_trackPageview",n])}})})}}),window.require.define({"lib/custom_css":function(e,t,n){var r=t("./matches_selector"),i=function(e){this.sheets={},this.rules={},this.insertRules(e)};i.prototype.createSheet=function(e){var t=document.createElement("style");return t.type="text/css",t.rel="stylesheet",t.media=e,document.head.appendChild(t),this.sheets[e]=t.sheet,this.sheets[e]},i.prototype.insertRule=function(e,t){var n,r,i=e.media||"all";if(!e.selector||!e.property||e.value===void 0)return;return this.sheets[i]=this.sheets[i]||this.createSheet(i),e.index!==null&&e.index!==void 0?(n=e.index,this.deleteRule(n)):t&&(n=this.getIndex(e),this.deleteRule(n)),n=this.sheets[i].cssRules.length,declaration=e.selector+" {"+e.property+": "+e.value+"}",this.sheets[i].insertRule(declaration,n),this.rules[i]=this.rules[i]||{},this.rules[i][n]={selector:e.selector,property:e.property,value:e.value},n},i.prototype.insertRules=function(e){e.forEach(function(e,t){this.insertRule(e)},this)},i.prototype.getIndex=function(e){var t;for(t in this.rules[e.media]){if(!this.rules[e.media].hasOwnProperty(t))continue;if(this.rules[e.media][t].selector===e.selector)return t}},i.prototype.getDeclarations=function(e){var t,n,i,s,o,u,a,f={},l={},c=function(e){return e},h=function(e,t){return t.specificity-e.specificity};if(!e)return;this.isElement(e)||(e=this.createGhostElement(e));for(t in this.rules){if(!this.rules.hasOwnProperty(t))continue;l={};for(s in this.rules[t]){n=this.rules[t][s],a=n.selector.replace(/:[^,\s]*\w/g,"").trim(),a===""&&(a="*");if(!r(e,a))continue;l[n.selector]||(l[n.selector]={selector:n.selector,rules:[],specificity:this.calculateSpecificity(a,e)}),u=l[n.selector].rules.length,l[n.selector].rules[u]={property:n.property,value:n.value,index:s}}f[t]=[];for(o in l){if(!l.hasOwnProperty(o))continue;u=f[t].length,f[t][u]=l[o]}f[t].reverse().sort(h)}return f},i.prototype.getRules=function(){var e,t,n,r,i,s=[];for(e in this.rules){if(!this.rules.hasOwnProperty(e))continue;s[e]=s[e]||{};for(t in this.rules[e]){if(!this.rules[e].hasOwnProperty(t))continue;rule=this.rules[e][t],s[s.length]={media:e,selector:rule.selector,property:rule.property,value:rule.value}}}return s},i.prototype.deleteRule=function(e,t){if(e===null||e===void 0)return;t=t||"all",this.sheets[t].deleteRule(e),delete this.rules[t][e]},i.prototype.calculateSpecificity=function(e,t){var n;return e.split(",").forEach(function(e){e=e.trim();if(r(t,e)){n=SPECIFICITY.calculate(e)[0].specificity,n=parseInt(n.split(",").join(""),10);return}}),n},i.prototype.createGhostElement=function(e){var t,n=document.implementation.createHTMLDocument(""),r=e.split(" ");return r.forEach(function(e){var r=t;e.indexOf("#")===0?(t=n.createElement("div"),t.id=e.substring(1)):e.indexOf(".")===0?(t=n.createElement("div"),t.classname=e.substring(1)):t=n.createElement(e),r&&r.appendChild(t)}),t},i.prototype.isElement=function(e){return typeof HTMLElement=="object"?e instanceof HTMLElement:e&&typeof e=="object"&&e.nodeType===1&&typeof e.nodeName=="string"},n.exports=i}}),window.require.define({"lib/editor_data":function(e,t,n){var r,i=t("application"),s=t("collections/templates"),o=t("collections/regions"),u=t("collections/blocks"),a=t("lib/custom_css");r=sessionStorage.getItem("theme-"+i.data.theme._id),r=JSON.parse(r),r||(r={templates:i.data.theme_pieces.templates,regions:i.data.theme_pieces.regions,blocks:i.data.theme_pieces.blocks,style:i.data.style}),r={templates:new s(r.templates),regions:new o(r.regions),blocks:new u(r.blocks),style:new a(r.style)},setInterval(function(){var e={templates:r.templates.toJSON(),regions:r.regions.toJSON(),blocks:r.blocks.toJSON(),style:r.style.getRules()};e=JSON.stringify(e),sessionStorage.setItem("theme-"+i.data.theme._id,e)},1e3),n.exports=r}}),window.require.define({"lib/html_tags":function(e,t,n){n.exports=[{group:"Headings",tags:[{tag:"h1",label:"Headings 1"},{tag:"h2",label:"Headings 2"},{tag:"h3",label:"Headings 3"},{tag:"h4",label:"Headings 4"},{tag:"h5",label:"Headings 5"},{tag:"h6",label:"Headings 6"}]},{group:"Content sections",tags:[{tag:"p",label:"Paragraphs"},{tag:"blockquote",label:"Block quotations"},{tag:"pre",label:"Pre-formatted content"},{tag:"address",label:"Addresses"},{tag:"ins",label:"Inserted content"},{tag:"del",label:"Deleted content"},{tag:"hr",label:"Horizontal rules"}]},{group:"Inline elements",tags:[{tag:"a",label:"Links"},{tag:"abbr",label:"Abbreviations"},{tag:"acronym",label:"Acronyms"},{tag:"dfn",label:"Inline definitions"},{tag:"em",label:"Emphases"},{tag:"strong",label:"Strong emphases"},{tag:"cite",label:"Citations"},{tag:"q",label:"Inline quotations"},{tag:"sub",label:"Subscripts"},{tag:"sup",label:"Superscripts"}]},{group:"Lists",tags:[{tag:"dl",label:"Definition Lists"},{tag:"dt",label:"Definition Terms"},{tag:"dd",label:"Definitions"},{tag:"ol",label:"Ordered Lists"},{tag:"ul",label:"Unordered Lists"},{tag:"menu",label:"Menu Lists"},{tag:"li",label:"List Items"}]},{group:"Forms",tags:[{tag:"form",label:"Forms"},{tag:"fieldset",label:"Fieldsets"},{tag:"legend",label:"Fieldset legends"},{tag:"input[type=checkbox]",label:"Checkboxes"},{tag:"input[type=radio]",label:"Radio buttons"},{tag:"button",label:"Buttons"},{tag:"input[type=button]",label:"Buttons"},{tag:"input[type=submit]",label:"Submit buttons"},{tag:"input[type=image]",label:"Image buttons"},{tag:"input[type=reset]",label:"Reset buttons"},{tag:"input[type=text]",label:"Text fields"},{tag:"input[type=text]",label:"Text fields"},{tag:"input[type=password]",label:"Password fields"},{tag:"input[type=file]",label:"File fields"},{tag:"select",label:"Selection lists"},{tag:"optgroup",label:"Group of options"},{tag:"option",label:"Options"},{tag:"textarea",label:"Multi-line text areas"}]},{group:"Tables",tags:[{tag:"table",label:"Tables"},{tag:"caption",label:"Table captions"},{tag:"thead",label:"Table headers"},{tag:"tbody",label:"Table bodies"},{tag:"tfoot",label:"Table footers"},{tag:"tr",label:"Table rows"},{tag:"th",label:"Table header cells"},{tag:"td",label:"Table data cells"},{tag:"colgroup",label:"Table column groups"},{tag:"col",label:"Table columns"}]},{group:"Media",tags:[{tag:"img",label:"Images"},{tag:"map",label:"Maps"},{tag:"area",label:"Map areas"},{tag:"object",label:"Media object"},{tag:"embed",label:"Media embed"},{tag:"iframe",label:"Iframes"}]},{group:"Computer text",tags:[{tag:"code",label:"Source code"},{tag:"var",label:"Source code variables"},{tag:"kbd",label:"User input"},{tag:"samp",label:"Program output"}]},{group:"Presentation",tags:[{tag:"b",label:"b"},{tag:"i",label:"i"},{tag:"u",label:"u"},{tag:"s",label:"s"},{tag:"small",label:"small"},{tag:"big",label:"big"},{tag:"tt",label:"tt"}]}]}}),window.require.define({"lib/matches_selector":function(e,t,n){function s(e,t){if(i)return i.call(e,t);var n=e.parentNode.querySelectorAll(t);for(var r=0;r<n.length;++r)if(n[r]==e)return!0;return!1}var r=Element.prototype,i=r.matchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector;n.exports=s}}),window.require.define({"models/base/model":function(e,t,n){n.exports=Backbone.Model.extend({})}}),window.require.define({"models/block":function(e,t,n){var r=t("models/base/model");n.exports=r.extend({idAttribute:"_id",defaults:{name:"",template:"",build:""},label:function(){return _.str.titleize(this.get("label")+" "+_.str.humanize(this.get("name")))},className:function(){return this.get("name").replace("_","-")},tag:function(){var e="";return this.get("label")!=="Default"&&(e=" "+this.get("label")),"{% "+this.get("name")+e+" %}"}})}}),window.require.define({"models/region":function(e,t,n){var r=t("models/base/model");n.exports=r.extend({idAttribute:"_id",defaults:{slug:"",name:"",template:""},validate:function(e){if(["header","footer"].indexOf(e.name)<0)return"Region must be header or footer."}})}}),window.require.define({"models/template":function(e,t,n){var r=t("models/base/model");n.exports=r.extend({idAttribute:"_id",defaults:{name:"",template:"",build:"",regions:{header:"default",footer:"default"}},label:function(){var e;for(e in this.standards){if(!this.standards.hasOwnProperty(e))continue;if(this.get("name")===this.standards[e].name)return this.standards[e].label}return this.get("name")},setRegion:function(e,t){var n=this.get("regions");n[e]=t,this.set("regions",n)},standards:[{name:"index",label:"Default"},{name:"front-page",label:"Front Page"},{name:"home",label:"Blog"},{name:"single",label:"Article"},{name:"page",label:"Page"},{name:"archive",label:"Archive"},{name:"search",label:"Search Results"},{name:"404",label:"Error 404"}]})}}),window.require.define({"models/theme":function(e,t,n){var r=t("models/base/model");n.exports=r.extend({idAttribute:"_id",urlRoot:"/themes",defaults:{name:"",author:"",screenshot_uri:""}})}}),window.require.define({"models/user":function(e,t,n){var r=t("models/base/model"),i=t("collections/themes");n.exports=r.extend({defaults:{first_name:"",last_name:"",email:"",password:"",password_confirmation:"",themes:[]},initialize:function(){var e=new i(this.attributes.themes)},url:"/users",validation:{first_name:{required:!0},last_name:{required:!0},email:{required:!0,pattern:"email"},password:{required:function(e,t,n){return n&&!n.id?!0:!1}},password_confirmation:{equalTo:"password"}}})}}),window.require.define({router:function(e,t,n){var r=t("application"),i=t("collections/themes");n.exports=Backbone.Router.extend({routes:{"":"index","me/themes":"your_themes","themes/:id":"theme","themes/:id/edit":"edit",login:"login",register:"register",reset_password:"reset_password",upload:"upload","*actions":"notFound"},index:function(){var e=new i(r.data.themes),t=$("#main");t.empty(),r.currentUser.id?t.append("<div id='new-button'><a href='/themes/new' class='btn btn-primary btn-large' data-bypass='true'>Create a New Theme</a></div>").append("<h3 class='page-title'>Or copy a theme below</h3>").append(r.createView("theme_list",{collection:e}).render().$el):t.append(r.reuseView("faq").render().$el)},your_themes:function(){var e=r.currentUser.get("themes");$("#main").empty().append("<h1 class='page-header'>Your Themes <small>("+e.length+")</small></h1>").append(r.createView("theme_list",{collection:e}).render().$el)},theme:function(e){$("#main").empty().append(r.createView("theme",{themeID:e}).render().$el)},edit:function(e){if(r.data.theme===void 0){window.top.Backbone.history.navigate("/404",{trigger:!0,replace:!0});return}r.createView("editor").render()},login:function(){$(".modal").modal("hide"),$("body").append(r.createView("login").render().$el.modal("show"))},register:function(){$(".modal").modal("hide"),$("body").append(r.createView("register").render().$el.modal("show"))},reset_password:function(){$(".modal").modal("hide"),$("body").append(r.createView("password_reset").render().$el.modal("show"))},upload:function(){$(".modal").modal("hide"),$("body").append(r.createView("theme_upload").render().$el.modal("show"))},notFound:function(){$("#main").empty().append(r.reuseView("not_found").render().$el)}})}}),window.require.define({"views/auth_links":function(e,t,n){var r=t("views/base/view"),i=t("views/templates/auth_links"),s=t("application");n.exports=r.extend({el:$("#auth-links"),model:s.currentUser,events:{"click #logout":"deleteSession"},initialize:function(){this.model.on("change",this.render,this)},render:function(){var e=i({currentUser:this.model.toJSON()});return this.$el.empty().append(e),this},deleteSession:function(){$.ajax({contentType:"application/json; charset=UTF-8",dataType:"json",type:"DELETE",url:"/session",complete:function(e,t){t==="success"&&(sessionStorage.clear(),s.trigger("logout"),setTimeout(function(){window.location="/"}))}.bind(this)})}})}}),window.require.define({"views/base/view":function(e,t,n){n.exports=Backbone.View.extend({render:function(){var e;return this.template&&(e=_.isFunction(this.data)?this.data():this.data,this.$el.empty().append(t("views/templates/"+this.template)(e))),this}})}}),window.require.define({"views/blocks":function(e,t,n){var r=t("views/base/view"),i=t("views/templates/blocks"),s=t("application");n.exports=r.extend({id:"x-block-insert",className:"x-section",collection:s.editor.blocks,events:{"click .new-block":"showForm","submit .new-block-select":"addBlock","click .close":"removeBlock","mouseover .x-drag":"makeDraggable"},initialize:function(){this.collection.on("reset",this.addAll,this),this.collection.on("add",this.addOne,this),this.collection.on("remove",this.removeOne,this),s.on("mutations:started",this.makeMutable.bind(this)),s.on("save:before",this.addThemeAttributes.bind(this)),s.on("block:inserted",this.insertBlock.bind(this)),this.allBlocks=_.map(s.data.blocks,function(e){return e.label=_.str.titleize(_.str.humanize(e.name)),e})},render:function(){return this.$el.empty().append(i({all:this.allBlocks})),this.collection.reset(this.collection.models),this},makeDraggable:function(e){this.$(e.currentTarget).draggable({addClasses:!1,helper:function(){return $(this).clone().appendTo("body")},revert:"invalid",scroll:!1,zIndex:99999})},addOne:function(e){var t="";e.get("label")!="Default"&&(t=" <span class='close' title='Delete block'>&times;</span>"),this.$("ul").append("<li class='x-drag' data-cid='"+e.cid+"'>"+"<span>&Dagger;</span> "+e.label()+t+"</li>")},addAll:function(){this.$("ul").empty(),_.each(this.collection.models,function(e){this.addOne(e)},this)},removeOne:function(e){this.$("span[data-cid='"+e.cid+"']").closest("li").remove()},insertBlock:function(e,t){var n=this.collection.getByCid($(e).data("cid"));e.outerHTML="<div id='"+t+"' class='columns "+n.className()+"'>"+n.get("build")+"</div>",s.trigger("node:added",window.document.getElementById(t))},makeMutable:function(e){e.blocks=this.collection},showForm:function(e){var t=this.$(".new-block-select");t.is(":hidden")?t.show("normal"):t.hide("normal")},addBlock:function(e){var t,n,r,i,o;e.preventDefault(),t=this.$(".new-block-select select").val(),n=this.$(".new-block-name").val();if(!n){s.trigger("notification","error","Please, enter a block name.");return}r=_.find(this.allBlocks,function(e){return e.name===t}),o=(new DOMParser).parseFromString(r.template,"text/html").body,o.firstChild.setAttribute("data-x-label",n),o.firstChild.setAttribute("data-x-name",t),r.build=o.outerHTML,r.label=n,this.collection.add(r),this.render(),s.trigger("notification","success","New block created. Drag and drop into the page to add it.")},removeBlock:function(e){if(confirm("Are you sure you want to delete this block?")){var t=$(e.currentTarget).parent().data("cid");this.collection.remove(t),this.render()}},addThemeAttributes:function(e){e.blocks=_.map(this.collection.models,function(e){return _.pick(e.attributes,"_id","name","label","template")})}})}}),window.require.define({"views/download_button":function(e,t,n){var r=t("views/base/view"),i=t("application");n.exports=r.extend({id:"download-button",events:{"click button.download":"download","click button.x-login":"login"},initialize:function(){i.on("save:after",this.waitForArchive.bind(this))},render:function(){var e;return i.currentUser.id===void 0?e="<button class='btn btn-success x-login'>Login to Download</button>":e="<button class='btn btn-success download'>Download Theme</button>",this.$el.empty().append(e),i.data.theme.has_archive||this.$el.hide(),this},login:function(){window.top.Backbone.history.navigate("/login",!0)},download:function(e){var t=$("#download-iframe",window.top.document),n="/themes/"+i.data.theme._id+"/download";e.preventDefault(),t.length===0?t=$("<iframe id='download-iframe' width='0' height='0' src='"+n+"'></iframe>").appendTo($("body",window.top.document)):t.attr("src",n)},waitForArchive:function(e){var t=this.$("button")[0],n=new EventSource("/jobs/"+e.get("archive_job_id"));this.$el.show(),t.setAttribute("disabled","true"),t.innerHTML="Rebuilding archive...",n.addEventListener("success",this.archiveSuccess.bind(this),!1),n.addEventListener("errors",this.archiveErrors.bind(this),!1)},resetButton:function(e){var t=this.$("button")[0];e.currentTarget.close(),t.removeAttribute("disabled"),t.innerHTML="Download Theme"},archiveSuccess:function(e){this.resetButton(e),i.trigger("notification","success","Theme archive updated.")},archiveErrors:function(e){this.resetButton(e),i.trigger("notification","error","Error updating the theme archive.")}})}}),window.require.define({"views/editor":function(e,t,n){var r=t("application"),i=t("views/base/view"),s=t("lib/editor_data"),o=t("views/templates/accordion_group");n.exports=i.extend({id:"layout-editor",panels:[{id:"templates",title:"Current Template"},{id:"regions",title:"Header &amp; Footer"},{id:"blocks",title:"Blocks"},{id:"style_edit",title:"Style"},{id:"share_link",title:"Share"}],events:{"click #customize-button a.copy":"askForPatience"},initialize:function(){_.extend(r.editor,{preview_only:!!r.data.preview_only,templates:s.templates,regions:s.regions,blocks:s.blocks,style:s.style}),_.bindAll(this,"accordionGroups")},render:function(){return this.$el.empty(),r.data.theme.author_id===r.currentUser.id?this.render_editor():this.render_preview(),r.editor.preview_only||this.$el.append(r.createView("download_button").render().$el),this.$el.insertAfter($("#main",window.top.document)).height($(window.top).height()-60),this},render_preview:function(){var e;r.currentUser.id===void 0?e="<a class='btn btn-primary' href='/login'>Login to Copy</a>":e="<a class='btn btn-primary copy' data-bypass='true' href='/themes/"+r.data.theme._id+"/fork'>Copy Theme</a>",this.$el.append("<div id='theme-name'>Theme: "+r.data.theme.name+"</div>").append(r.createView("templates_select").render().$el).append("<div id='customize-button'>"+e+"</div>")},render_editor:function(){r.createView("regions"),r.createView("blocks"),r.createView("style_edit"),r.createView("share_link"),r.createView("save_button"),r.createView("download_button"),r.createView("layout").render(),this.$el.append("<div id='theme-name'>Theme: "+r.data.theme.name+"</div>").append("<div class='accordion'>"+this.accordionGroups()+"</div>").append(r.reuseView("save_button").render().$el).append(r.reuseView("download_button").render().$el);for(var e in this.panels){if(!this.panels.hasOwnProperty(e))return;this.$("#editor-"+this.panels[e].id+" .accordion-inner").empty().append(r.reuseView(this.panels[e].id).render().$el)}r.createView("mutations")},showSection:function(e){$(e.target).next().slideToggle("slow",function(){var e=$(this),t=e.prev().children("span");e.is(":hidden")?t.empty().append("&or;"):t.empty().append("&and;")})},askForPatience:function(e){e.currentTarget.setAttribute("disabled","true"),e.currentTarget.innerHTML="Started the Photocopier"},accordionGroups:function(){var e="";for(var t in this.panels)this.panels.hasOwnProperty(t)&&(e+=this.buildAccordionGroup(this.panels[t]));return e},buildAccordionGroup:function(e){return o({parent:"editor-accordion",id:"editor-"+e.id,title:e.title,content:""})}})}}),window.require.define({"views/faq":function(e,t,n){var r=t("views/base/view");n.exports=r.extend({template:"faq"})}}),window.require.define({"views/layout":function(e,t,n){var r,i,s=t("views/base/view"),o=t("application"),u=1;r=function(e,t){return _.reduce($(e).children(),function(e,n){return n===t?e:e+$(n).outerWidth(!0)},0)},i=function(e,t){return $(e).children().length>0&&$(e).width()<r(e,t)+$(t).width()},n.exports=s.extend({el:$("body"),events:{"click .columns":"highlightColumns","click .columns a":"preventDefault","mouseenter .columns a":"addDataBypass","mouseleave .columns a":"removeDataBypass","mousedown .columns a, .columns img":"preventDefault","submit .columns form":"preventDefault","click .columns .x-remove":"removeColumn","mouseenter .column, .columns":"makeDraggable","mouseenter .row":"makeDroppable","mouseenter .x-resize":"makeResizeable"},initialize:function(){this.makeDroppable(),o.on("template:loaded",this.highLightEmpty.bind(this))},highLightEmpty:function(){this.$(".row").each(function(e,t){var n=$(t);n.children().length===0&&n.addClass("x-empty")})},makeDraggable:function(e){this.$(".column, .columns").draggable({addClasses:!1,revert:"invalid",drag:this.dragOn,start:this.dragStart,stop:this.dragStop,zIndex:99999})},makeDroppable:function(e){this.$(".row").droppable({accept:".column, .columns, .x-drag",addClasses:!1,drop:this.dropOn.bind(this),out:this.dropOut,over:this.dropOver})},makeResizeable:function(e){$(e.currentTarget).draggable({addClasses:!1,axis:"x",containment:this.$el.children(),drag:this.resizeOn,stop:this.resizeStop})},removeDataBypass:function(){this.$(".columns a").removeAttr("data-bypass")},addDataBypass:function(){this.$(".columns a").attr("data-bypass",!0)},preventDefault:function(e){e.preventDefault()},highlightColumns:function(e){var t,n,r;o.trigger("column:highlight",e.currentTarget),t=$(e.currentTarget),this.$(".x-current").removeClass("x-current"),t.addClass("x-current"),t.children(".x-resize").length===0&&t.html(function(e,t){return t+"<div class='x-resize' title='Resize element'>&rang;</div>"}),t.children(".x-remove").length===0&&t.html(function(e,t){return t+"<div class='x-remove' title='Remove element'>&times;</div>"});if(t.children(".x-name").length===0){n=t.children(":first").data("x-name"),label=t.children(":first").data("x-label");if(!n||!label)return;label=_.str.titleize(label+" "+_.str.humanize(n)),t.html(function(e,t){return t+"<div class='x-name'>"+label+"</div>"})}},dragStart:function(e,t){$.browser.msie||$.browser.mozilla?$(this).data("start-scroll",$("html").scrollTop()):$(this).data("start-scroll",$("body").scrollTop()),o.trigger("node:removed",t.helper[0],t.helper[0].parentNode)},dragOn:function(e,t){var n=parseInt($(this).data("start-scroll"),10);$.browser.msie||$.browser.mozilla?t.position.top-=$("html").scrollTop()-n:t.position.top-=$("body").scrollTop()-n},dragStop:function(e,t){t.helper.removeAttr("style"),o.trigger("node:added",t.helper[0])},dropOver:function(e,t){$(this).addClass(function(){i(this,t.draggable.get(0))?$(this).addClass("x-full"):$(this).addClass("x-not-full")})},dropOut:function(e,t){$(this).removeClass("x-full x-not-full")},dropOn:function(e,t){var n,r,s,a;r=t.helper,$drop=$(e.target),s=r.parent(),i(e.target,t.helper.get(0))?($row=$("<div class='row' id='y-"+u+"'></div>").insertAfter($drop),u++,o.trigger("node:added",$row[0],"row")):$row=$drop,r.appendTo($row),$drop.removeClass("x-empty x-full x-not-full"),r.data("cid")?(o.trigger("block:inserted",r[0],"y-"+u),u++):s.children().length===0&&this.maybeRemoveRow(s.get(0))},resizeOn:function(e,t){var n=t.helper.parent(),i=n.parent();width=t.position.left+12,width>=i.width()?width=i.width():width>=i.width()-r(i.get(0),n.get(0))&&(width=i.width()-r(i.get(0),n.get(0)),width-=1),n.attr("style","width: "+width+"px")},resizeStop:function(e,t){var n=t.helper,r=n.parent();o.trigger("resize:end","#page #"+r[0].id,r[0].style.width),n.removeAttr("style"),r.removeAttr("style")},removeColumn:function(e){var t,n,r,i=e.currentTarget.parentNode.parentNode;if(!confirm("Are you sure you want to remove this element?"))return;t=e.currentTarget.parentNode,r=t.parentNode.id,t.parentNode.removeChild(t),o.trigger("node:removed",t,window.document.getElementById(r),"column"),i.children.length===0&&this.maybeRemoveRow(i)},maybeRemoveRow:function(e){var t=e.parentNode,n=t.id;["HEADER","FOOTER"].indexOf(t.tagName)!==-1&&t.children.length===1||e.id.indexOf("x-")!==0&&e.id.indexOf("y-")!==0?e.className+=" x-empty":(t.removeChild(e),o.trigger("node:removed",e,window.document.getElementById(n),"row"))}})}}),window.require.define({"views/login":function(e,t,n){var r=t("views/base/view"),i=t("application"),s=t("collections/themes");n.exports=r.extend({className:"modal",template:"login",model:i.currentUser,events:{"submit form":"loginUser"},loginUser:function(e){e.preventDefault(),this.validateInputs()&&this.submitData()},validateInputs:function(){var e=!0;return this.$("input").each(function(t,n){var r=n.getAttribute("name");if(n.value===""){var i=Backbone.Validation.labelFormatters.sentenceCase(r)+" can't be blank";Backbone.Validation.callbacks.invalid(this,r,i,"name"),e=!1}}.bind(this)),e},submitData:function(){var e={};this.$("input").each(function(t,n){var r=n.getAttribute("name");e[r]=n.value}),$.ajax({contentType:"application/json;charset=UTF-8",dataType:"json",type:"POST",url:"/session",data:JSON.stringify(e),complete:function(e,t){var n=JSON.parse(e.responseText);switch(t){case"success":this.model.set(n),this.model.set("themes",new s(n.themes)),i.trigger("login"),this.$el.modal("hide"),i.trigger("notification","success","Welcome back, "+this.model.get("first_name")+".");break;case"error":var r=this.$("form");r.children(".alert-error").length===0&&r.prepend("<p class='alert alert-error'>"+n.error+"</p>")}}.bind(this)})}})}}),window.require.define({"views/mutations":function(e,t,n){var r=t("views/base/view"),i=t("application");n.exports=r.extend({initialize:function(){i.on("node:added",this.addNode.bind(this)),i.on("node:removed",this.removeNode.bind(this)),this.pieces={},i.trigger("mutations:started",this.pieces)},addNode:function(e,t){var n,r,i,s,o,u,a,f;copy=e.cloneNode(!0);if(t==="row")n=e.parentNode;else{n=e.parentNode.parentNode;for(var l in this.pieces.blocks.models){u=this.pieces.blocks.models[l];if(e.firstElementChild.getAttribute("data-x-name")===u.get("name")&&e.firstElementChild.getAttribute("data-x-label")===u.get("label")){copy.innerHTML=u.tag();break}}}piece=this.getTemplatePiece(n),o=(new DOMParser).parseFromString(piece.get("template"),"text/html"),s=o.getElementById(e.parentNode.id),this.cleanupNode(copy),e.nextElementSibling?"FOOTER"===e.nextElementSibling.tagName?o.body.innerHTML=o.body.innerHTML+copy.outerHTML:(nextNode=o.getElementById(e.nextElementSibling.id),nextNode.parentNode&&nextNode.parentNode.insertBefore(copy,nextNode)):o.getElementById(e.parentNode.id).appendChild(copy),piece.set("template",o.body.innerHTML)},removeNode:function(e,t,n){var r;if(n==="row")r=t;else{r=t.parentNode;if(r===null)return}piece=this.getTemplatePiece(r),sandbox=(new DOMParser).parseFromString(piece.get("template"),"text/html"),copy=sandbox.getElementById(e.id),copy.parentNode.removeChild(copy),piece.set("template",sandbox.body.innerHTML)},getTemplatePiece:function(e){var t,n,r,i;return n=this.pieces.templates.getCurrent(),["HEADER","FOOTER"].indexOf(e.tagName)!==-1?(i=e.tagName.toLowerCase(),r=n.get("regions"),t=this.pieces.regions.getByName(i,r[i]),t.set("build",e.outerHTML)):(t=n,templateClone=window.document.getElementById("page").cloneNode(!0),$(templateClone).children("header, footer").remove(),t.set("build",templateClone.innerHTML)),t},cleanupNode:function(e){$(e).removeClass("x-current x-full x-not-full x-empty").children(".x-resize, .x-remove").remove().end().find("a[data-bypass=true]").removeAttr("data-bypass")}})}}),window.require.define({"views/not_found":function(e,t,n){var r=t("views/base/view");n.exports=r.extend({id:"not-found",template:"not_found"})}}),window.require.define({"views/notifications":function(e,t,n){var r=t("application"),i=t("views/base/view"),s=t("views/templates/notification");n.exports=i.extend({tagName:"ul",id:"notifications",className:"unstyled",initialize:function(){_.bindAll(this,"showNotification"),r.on("notification",this.showNotification)},showNotification:function(e,t){var n=$(s({type:e,text:t})).appendTo(this.$el);return setTimeout(function(){n.alert("close")},4e3),this}})}}),window.require.define({"views/password_reset":function(e,t,n){var r=t("views/base/view"),i=t("application");n.exports=r.extend({className:"modal",template:"password_reset",model:i.currentUser,events:{"submit form":"initiatePasswordReset"},initiatePasswordReset:function(e){e.preventDefault(),this.validateInputs()&&this.initiateReset()},validateInputs:function(){var e=!0;return this.$("form input").each(function(t,n){var r=n.getAttribute("name");if(n.value===""){var i=Backbone.Validation.labelFormatters.sentenceCase(r)+" can't be blank";Backbone.Validation.callbacks.invalid(this,r,i,"name"),e=!1}}.bind(this)),e},initiateReset:function(){var e={email:this.$("input[name=email]")[0].value,password:this.$("input[name=password]")[0].value};$.ajax({contentType:"application/json;charset=UTF-8",dataType:"json",type:"POST",url:"/users/reset_password",data:JSON.stringify(e),complete:function(e,t){switch(t){case"success":this.$el.modal("hide"),i.trigger("notification","success","We have sent you an email with a link to confirm your new password.");break;case"error":}}.bind(this)})}})}}),window.require.define({"views/regions":function(e,t,n){var r=t("views/base/view"),i=t("views/templates/regions"),s=t("application"),o=t("models/region");n.exports=r.extend({id:"x-region-select",className:"x-section",collection:s.editor.regions,events:{"change .x-header-select, .x-footer-select":"switchRegion","click .x-header-new button, .x-footer-new button":"addRegion"},initialize:function(){_.bindAll(this,"addThemeAttributes","makeMutable","addRegionsToTemplate"),this.collection.on("add",this.addOne,this),s.on("save:before",this.addThemeAttributes),s.on("mutations:started",this.makeMutable),s.on("template:load",this.addRegionsToTemplate)},render:function(){return this.$el.empty().append(i({headers:this.collection.where({name:"header"}).map(function(e){return e.attributes}),footers:this.collection.where({name:"footer"}).map(function(e){return e.attributes})})),this.$(".x-header-new, .x-footer-new").hide(),this},switchRegion:function(e){var t,n,r;e.target.className.indexOf("header")!=-1?t="header":t="footer",n=$(e.target).val(),this.toggleForm(t,n),n&&this.loadRegion(this.collection.getByName(t,n))},toggleForm:function(e,t){t?this.$(".x-"+e+"-new").hide("slow"):this.$(".x-"+e+"-new").show("slow")},loadRegion:function(e){var t=e.get("name");s.trigger("region:load",e),$("#page").children(t)[0].outerHTML=e.get("build"),$("#page").children(t).fadeOut().fadeIn(),s.trigger("region:loaded",e)},addRegion:function(e){var t,n,r,i;e.currentTarget.className.indexOf("header")!=-1?t="header":t="footer",n=_.str.slugify(this.$(".x-"+t+"-new input").val());if(!n){s.trigger("notification","error","Please, enter a "+t+" name.");return}attributes=_.pick(this.collection.getByName(t).attributes,"name","template","build"),attributes.slug=n,r=new o(attributes),this.collection.add(r),this.loadRegion(r),$(e.currentTarget).parent().hide("slow"),s.trigger("notification","success","The new "+t+" was created. It's a copy of the default one.")},addOne:function(e){var t;t=e.get("slug"),this.$(".x-"+e.get("name")+"-select").children(":selected").removeAttr("selected").end().children("[value='']").before("<option value='"+t+"' selected='selected'>"+t+"</option>")},addThemeAttributes:function(e){e.regions=_.map(this.collection.models,function(e){return _.pick(e.attributes,"_id","name","slug","template")})},makeMutable:function(e){e.regions=this.collection},addRegionsToTemplate:function(e){var t=e.get("regions");e.set("regions_attributes",{header:this.collection.getByName("header",t.header),footer:this.collection.getByName("footer",t.footer)}),this.$(".x-header-select").val(t.header),this.$(".x-footer-select").val(t.footer)}})}}),window.require.define({"views/register":function(e,t,n){var r=t("views/base/view"),i=t("application");n.exports=r.extend({className:"modal",template:"register",model:i.currentUser,events:{"submit form":"createUser"},initialize:function(){Backbone.Validation.bind(this)},createUser:function(e){e.preventDefault();var t=this.model,n={};this.$("input").each(function(){n[this.getAttribute("name")]=this.value}),t.save(n,{success:function(e,t){e.set(t),i.trigger("notification","success","Your registration was successful. You are now logged in."),this.$el.modal("hide")}.bind(this),error:function(e,t){this.displayServerErrors(t)}.bind(this)})},displayServerErrors:function(e){if(!e.responseText)return;var t=JSON.parse(e.responseText);Object.keys(t).forEach(function(e){var n=Backbone.Validation.labelFormatters.sentenceCase(e)+" "+t[e][0];Backbone.Validation.callbacks.invalid(this,e,n,"name")}.bind(this))}})}}),window.require.define({"views/save_button":function(e,t,n){var r=t("views/base/view"),i=t("application");n.exports=r.extend({id:"save-button",events:{"click button.save":"save"},render:function(){var e;return i.currentUser.id&&(e="<button class='btn btn-primary save'>Save Theme</button>"),this.$el.empty().append(e),this},save:function(e){var t=_.clone(i.data.theme);e.target.setAttribute("disabled","true"),i.trigger("save:before",t),i.currentUser.get("themes").create(t,{success:function(t){i.trigger("save:after",t),e.target.removeAttribute("disabled"),i.trigger("notification","success","Theme saved."),window.top.Backbone.history.navigate("/themes/"+t.id,!0)},error:function(t,n){i.trigger("save:error"),e.target.removeAttribute("disabled"),i.trigger("notification","error","Unable to save the theme. Please try again.")}})}})}}),window.require.define({"views/share_link":function(e,t,n){var r=t("views/base/view"),i=t("application");n.exports=r.extend({id:"share-link",className:"x-section well well-small",template:"share_link",data:{theme:i.data.theme._id}})}}),window.require.define({"views/style_edit":function(e,t,n){var r=t("views/base/view"),i=t("views/templates/style_edit"),s=t("views/templates/declaration"),o=t("views/templates/rule"),u=t("application"),a=t("lib/html_tags");n.exports=r.extend({id:"style-edit",className:"x-section",events:{"click .selector-choice a":"highlightElement","change .tag":"setTag","click .add-rule":"addRuleInputs","keyup .rules input":"editRule","change .rules input":"editRule","click .add-declaration":"addDeclarationInputs","keyup .selector input":"editDeclaration","change .selector input":"editDeclaration"},initialize:function(){u.on("column:highlight",this.setColumn.bind(this)),u.on("save:before",this.addThemeAttributes.bind(this)),u.on("resize:end",this.changeWidth.bind(this)),this.selector="body",this.customCSS=u.editor.style},setTag:function(e){this.tag=$(e.target).val(),this.render()},setColumn:function(e){this.selector="#"+e.id,this.render()},render:function(){var e,t,n;return this.media="all",this.tag&&["body","html"].indexOf(this.selector)!=-1?e=this.tag:(this.tag?e=this.selector+" "+this.tag:e=this.selector,t=$(e),t&&(e=t[0])),n=this.customCSS.getDeclarations(e),n&&n[this.media]?n=n[this.media]:n=[],this.$el.html(i({htmlTags:this.tagOptions(),selector:this.selector,parents:$(this.selector).parents().get().reverse(),declarations:n})),this.markNonAppliedRules(),this},tagOptions:function(){var e=this;return a.map(function(t){return t.tags=t.tags.map(function(t){return t.selected=t.tag===e.tag?" selected":"",t}),t})},addRuleInputs:function(e){var t=$(e.currentTarget),n=t.siblings("ul");e.preventDefault(),n.append(o({selector:t.siblings(".selector").find("input").val()}))},editRule:function(e,t){var n,r,i=$(e.target).parent();property=i.find("input[name=property]").val(),value=i.find("input[name=value]").val(),r=i.find("input[name=index]").val()||null,n=i.find("input[name=selector]").val(),n=n.trim().replace(/^[^a-zA-Z#\.\[]|\W+$/g,""),property&&value?r=this.customCSS.insertRule({selector:n,property:property,value:value,index:r,media:this.media}):(r&&(this.customCSS.deleteRule(r,this.media),r=""),!property&&!value&&e.type==="change"&&i.remove()),i.find("input[name=index]").val(r)},addDeclarationInputs:function(e){var t=this.selector;e.preventDefault(),this.tag&&(t=this.selector+" "+this.tag),$(e.currentTarget).before(s({selector:t}))},editDeclaration:function(e){var t=$(e.currentTarget),n=t.val();!n&&e.type==="change"&&t.closest(".declaration-inputs").remove(),t.parent().siblings("ul").find("input[name=selector]").val(n).trigger("change")},addThemeAttributes:function(e){e.style=this.customCSS.getRules()},changeWidth:function(e,t){t=parseInt(t,10)/$(e).parent().width()*100,t=Math.round(t*100)/100+"%",this.customCSS.insertRule({selector:e,property:"width",value:t,media:"all"},!0),this.render()},markNonAppliedRules:function(){var e={};this.$(".rules input[name=property]").each(function(){var t=e[this.value];if(t===void 0){e[this.value]=this;return}this.parentNode.parentNode!==t.parentNode.parentNode&&$(this.parentNode).addClass("inactive")})},highlightElement:function(e){var t=e.currentTarget.getAttribute("data-selector");e.preventDefault(),$(".x-current").removeClass("x-current"),$(t).addClass("x-current"),this.selector=t,this.render()}})}}),window.require.define({"views/templates":function(e,t,n){var r=t("views/base/view"),i=t("application"),s=t("models/template"),o=t("views/templates/templates");n.exports=r.extend({id:"templates-select",className:"x-section",collection:i.editor.templates,events:{"change ul input":"switchTemplate","focus ul input":"switchTemplate","blur ul input":"switchTemplate","click .close":"removeTemplate","click .new-template":"showForm","change .new-template-select select":"selectTemplate","submit .new-template-select":"addTemplate"},initialize:function(e){_.bindAll(this,"addThemeAttributes","makeMutable","saveRegion"),this.collection.on("add",this.addOne,this),this.collection.on("reset",this.addAll,this),this.collection.on("remove",this.removeOne,this),i.on("save:before",this.addThemeAttributes),i.on("mutations:started",this.makeMutable),i.on("region:load",this.saveRegion)},render:function(){var e=_.reject((new s).standards,function(e){return!!this.collection.getByName(e.name)}.bind(this));return this.$el.empty().append(o({standards:e,edit:!i.editor.preview_only})),this.collection.reset(this.collection.models),this.loadTemplate(this.collection.getCurrent()),this},addOne:function(e){var t="",n="",r="";e.cid===this.collection.getCurrent().cid&&(t=" checked='checked'",n=" class='current'"),e.get("name")!="index"&&(r="<span class='close' title='Delete template'>&times;</span>"),this.$("ul").append("<li"+n+"><label><input name='x-template'"+t+" type='radio' value='"+e.cid+"' />"+e.label()+"</label>"+r+"</li>")},addAll:function(){this.$("ul").empty(),_.each(this.collection.models,function(e){this.addOne(e)},this)},removeOne:function(e){this.$("input[value='"+e.cid+"']").closest("li").remove()},switchTemplate:function(){var e=this.collection.getByCid(this.$("ul input:checked").val());this.$("ul li").removeClass("current"),this.$("ul input:checked").closest("li").addClass("current"),this.loadTemplate(e)},loadTemplate:function(e){var t;i.trigger("template:load",e),t=e.get("regions_attributes"),build=t.header.get("build")+e.get("build")+t.footer.get("build"),$("#page").fadeOut().empty().append(build).fadeIn(),this.collection.setCurrent(e),i.trigger("template:loaded",e)},removeTemplate:function(e){if(confirm("Are you sure you want to delete this template?")){var t=$(e.currentTarget).parent().find("input").val();this.collection.remove(t),this.render()}},showForm:function(e){var t=this.$(".new-template-select");t.is(":hidden")?t.show("normal"):t.hide("normal")},selectTemplate:function(e){$(e.currentTarget).val()===""?this.$(".new-template-name").show().css("display","block"):this.$(".new-template-name").hide()},addTemplate:function(e){var t,n,r;e.preventDefault(),t=this.$(".new-template-select select").val()||this.$(".new-template-name").val();if(!t){i.trigger("notification","error","Please, enter a template name.");return}n=_.pick(this.collection.getByName("index").attributes,"template","build","regions"),n.name=t,r=new s(n),this.collection.add(r),this.collection.setCurrent(r),this.render(),i.trigger("notification","success","The new template was created. It's a copy of the default one.")},addThemeAttributes:function(e){e.templates=_.map(this.collection.models,function(e){return _.pick(e.attributes,"_id","name","template")})},makeMutable:function(e){e.templates=this.collection},saveRegion:function(e){this.collection.getCurrent().setRegion(e.get("name"),e.get("slug"))}})}}),window.require.define({"views/templates/accordion_group":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0,h=this.escapeExpression;return s+='<div class="accordion-group">\n  <div class="accordion-heading">\n    <h4 class="accordion-toggle" data-toggle="collapse" data-parent="#',u=n.parent,o=u||t.parent,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"parent",{hash:{}})),s+=h(o)+'" data-target="#',u=n.id,o=u||t.id,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"id",{hash:{}})),s+=h(o)+'">\n      ',u=n.title,o=u||t.title,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"title",{hash:{}})),s+=h(o)+'\n    </h4>\n  </div>\n  <div id="',u=n.id,o=u||t.id,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"id",{hash:{}})),s+=h(o)+'" class="accordion-body collapse">\n    <div class="accordion-inner">\n      ',u=n.content,o=u||t.content,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"content",{hash:{}})),s+=h(o)+"\n    </div>\n  </div>\n</div>\n",s})}}),window.require.define({"views/templates/auth_links":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function c(e,t){return'\n  <ul class="nav">\n    <li><a href="/me/themes" id="your_themes">Your themes</a></li>\n    <li><a href="/upload" id="upload_theme">Upload</a></li>\n  </ul>\n  <button class="btn" id="logout">Log out</button>\n'}function h(e,t){return'\n  <ul class="nav">\n    <li><a id="register" href="/register">Register</a></li>\n    <li><a id="login" href="/login">Log in</a></li>\n  </ul>\n'}n=n||e.helpers;var s="",o,u,a,f,l=this;a=n.currentUser,o=a||t.currentUser,o=o===null||o===undefined||o===!1?o:o.id,u=n["if"],f=l.program(1,c,i),f.hash={},f.fn=f,f.inverse=l.program(3,h,i),o=u.call(t,o,f);if(o||o===0)s+=o;return s+="\n",s})}}),window.require.define({"views/templates/blocks":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function v(e,t){var r="",i;return r+='\n      <option value="',a=n.name,i=a||e.name,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"name",{hash:{}})),r+=d(i)+'">',a=n.label,i=a||e.label,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"label",{hash:{}})),r+=d(i)+"</option>\n      ",r}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;s+='<p>Drag and drop to insert</p>\n<ul class="rects"></ul>\n<form class="new-block-select hide">\n  <legend>Add New Block</legend>\n    <select>\n      ',a=n.all,o=a||t.all,u=n.each,f=l.program(1,v,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;return s+='\n    </select>\n  </label>\n  <input class="new-block-name" type="text" value="" placeholder="Enter block name" />\n  <button class="new-block-add btn">Add block</button>\n</form>\n<button class="new-block">&plus; New Block</button>\n',s})}}),window.require.define({"views/templates/declaration":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0,h=this.escapeExpression;return s+='<form class="declaration-inputs">\n  <p class="selector">\n    <input value="',u=n.selector,o=u||t.selector,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"selector",{hash:{}})),s+=h(o)+'" placeholder="selector" />&nbsp; {\n  </p>\n  <ul class="rules">\n  </ul>\n  <button class="btn btn-mini add-rule">Add rule</button>\n  <p>}</p>\n</form>\n',s})}}),window.require.define({"views/templates/faq":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s,o=this;return'<div class="headline">\n  <h1 class="catch-phrase">Fast Custom Design Tools\n    <br /><small>for Your Web and Mobile Sites</small></h1>\n  <p>Design your beautiful, responsive HTML5 themes in minutes\n  <br />with a powerful drag and drop editor.</p>\n\n  <p class="call-to-action">\n    <a href="/register" class="btn btn-large btn-primary">Get Started Now. It\'s Free.</a>\n  </p>\n\n  <p>Make A Theme makes it easy to build beautiful, professional-grade themes<br />\n  you can use on your website, sell to earn money or share with others for free.</p>\n</div>\n\n<div class="features">\n  <div class="row">\n    <div class="span4">\n      <img src="/images/pencil.png" height="150" />\n      <h3>Easy to Use.</h3>\n      <p>It\'s so simple anyone can use it.<br />\n      But it\'s still powerful enough for the most advanced users.</p>\n    </div>\n\n    <div class="span4">\n      <img src="/images/photoshop.png" height="150" />\n      <h3>All-in-One Workflow.</h3>\n      <p>Skip Photoshop. Skip your text editor.<br />\n      Save time and money by building your themes directly in your browser.</p>\n    </div>\n\n    <div class="span4">\n      <img src="/images/responsive.png" height="150" />\n      <h3>Responsive. Responsive.</h3>\n      <p>Reach the 2 billions of people<br />\n      browsing the Web from desktops, mobiles,<br />\n      tablets, TVs, (coffee machines?)&hellip;</p>\n    </div>\n  </div>\n\n  <div class="row">\n    <div class="span4">\n      <img src="/images/html5.png" height="150" />\n      <h3>Beautiful Code.</h3>\n      <p>No HTML tag soup. No spaghetti PHP code.\n      Well organized CSS. Generated for real people, not robots.</p>\n    </div>\n\n    <div class="span4">\n      <img src="/images/presets.png" height="150" />\n      <h3>Preset Themes.</h3>\n      <p>You don\'t always have to start<br />\n      from scratch. Browse the gallery of pre-built themes,\n      copy and customize.</p>\n    </div>\n\n    <div class="span4">\n      <img src="/images/wordpress.png" height="150" />\n      <h3>It haz WordPress!</h3>\n      <p>Exporting to a WordPress theme<br />\n      is just one click away. No PHP mastering required.</p>\n    </div>\n  </div>\n</div>\n\n<div class="row call-to-action">\n  <blockquote>\n    <p>Non-desktop computers (phones, tablets, TVs, cars, glasses, etc.) are\n    becoming the primary way to access the Web. The next versions of the Web\n    languages (HTML, JavaScript,...) will be very powerful but more complex\n    and I believe our existing tools are not evolving quickly enough.</p>\n    <p>The goal of Make A Theme is to build the tools to make Web Design easier and\n    faster for the future Web.</p>\n\n    <small>Ulrich Sossou, <cite title="Founder / Developer @ Make A Theme">\n        Founder / Developer @ Make A Theme</cite></small>\n  </blockquote>\n  <p>\n    Help us shape the future of Web Design. Don\'t be left behind.\n    <a href="/register" class="btn btn-large btn-primary pull-right">\n      Sign Up for the Free Beta.\n    </a>\n  </p>\n</div>\n\n<footer id="footer">\n  <p>&copy; 2012 ThemeMy\n  &middot; <a href="/register">Register</a>\n  &middot; <a href="/login">Login</a>\n  &middot; <a href="http://makeatheme.freshdesk.com/">Support</a>\n  </p>\n</footer>\n'})}}),window.require.define({"views/templates/login":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s,o=this;return'<div class="modal-header">\n  <button type="button" class="close" data-dismiss="modal"></button>\n  <h3>Please authenticate yourself</h3>\n</div>\n<div class="modal-body">\n  <form class="form-horizontal">\n    <fieldset>\n      <div class="control-group">\n        <label class="control-label" for="email">Email Address</label>\n        <div class="controls">\n          <input type="text" name="email" class="input-xlarge">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <label class="control-label" for="password">Password</label>\n        <div class="controls">\n          <input type="password" name="password" class="input-xlarge">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <div class="controls">\n          <button type="submit" class="btn btn-primary">Log In</button>\n        </div>\n      </div>\n    </fieldset>\n  </form>\n  <ul class="unstyled">\n    <li>Forgot your password? <a href="/reset_password" data-dismiss="modal">Reset password</a></li>\n    <li>Don\'t have an account yet? <a href="/register" data-dismiss="modal">Register</a></li>\n  </ul>\n</div>\n'})}}),window.require.define({"views/templates/not_found":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s,o=this;return'<h1 class="page-header">Ooops! We screwed up. :(</h1>\n<p class="lead">Sorry, the page you were looking for doesnt exist.</p>\n<p>Go back to <a href="/" title="makeatheme.com">homepage</a> or\n<a href=\'http://makeatheme.freshdesk.com/\'>contact us</a> about a problem.</p>\n'})}}),window.require.define({"views/templates/notification":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0,h=this.escapeExpression;return s+='<li class="alert alert-',u=n.type,o=u||t.type,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"type",{hash:{}})),s+=h(o)+' fade in"><button class="close" data-dismiss="alert"></button> ',u=n.text,o=u||t.text,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"text",{hash:{}})),s+=h(o)+"</li>\n",s})}}),window.require.define({"views/templates/password_reset":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s,o=this;return'<div class="modal-header">\n  <button type="button" class="close" data-dismiss="modal"></button>\n  <h3>Reset password</h3>\n</div>\n<div class="modal-body">\n  <form class="form-horizontal" id="password_reset">\n    <fieldset>\n      <div class="control-group">\n        <label class="control-label" for="email">Email Address</label>\n        <div class="controls">\n          <input type="text" name="email" class="input-xlarge">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <label class="control-label" for="password">New Password</label>\n        <div class="controls">\n          <input type="password" name="password" class="input-xlarge">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <div class="controls">\n          <button type="submit" class="btn btn-primary">Send reset email</button>\n        </div>\n      </div>\n    </fieldset>\n  </form>\n  <ul class="unstyled">\n    <li>Remember your password? <a href="/login" data-dismiss="modal">Log in</a></li>\n    <li>Don\'t have an account yet? <a href="/register" data-dismiss="modal">Register</a></li>\n  </ul>\n</div>\n'})}}),window.require.define({"views/templates/regions":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function v(e,t){var r="",i;return r+='\n  <option value="',a=n.slug,i=a||e.slug,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"slug",{hash:{}})),r+=d(i)+'">',a=n.slug,i=a||e.slug,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"slug",{hash:{}})),r+=d(i)+"</option>\n  ",r}function m(e,t){var r="",i;return r+='\n  <option value="',a=n.slug,i=a||e.slug,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"slug",{hash:{}})),r+=d(i)+'">',a=n.slug,i=a||e.slug,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"slug",{hash:{}})),r+=d(i)+"</option>\n  ",r}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;s+='<label for="template-header">Header:</label>\n<select class="x-header-select" id="template-header">\n  ',a=n.headers,o=a||t.headers,u=n.each,f=l.program(1,v,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;s+='\n  <option value="">new header</option>\n</select>\n<div class="x-header-new">\n  <input type="text" value="" placeholder="Enter header name" />\n  <button class="x-header-add btn">Add header</button>\n</div>\n\n<label for="template-footer">Footer:</label>\n<select class="x-footer-select" id="template-footer">\n  ',a=n.footers,o=a||t.footers,u=n.each,f=l.program(3,m,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;return s+='\n  <option value="">new footer</option>\n</select>\n<div class="x-footer-new">\n  <input type="text" value="" placeholder="Enter footer name" />\n  <button class="x-footer-add btn">Add footer</button>\n</div>\n',s})}}),window.require.define({"views/templates/register":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s,o=this;return'<div class="modal-header">\n  <button type="button" class="close" data-dismiss="modal"></button>\n  <h3>Create a free account</h3>\n</div>\n<div class="modal-body">\n  <form class="form-horizontal">\n    <fieldset>\n      <div class="control-group">\n        <label class="control-label" for="new-first-name">First Name</label>\n        <div class="controls">\n          <input type="text" class="input-xlarge" name="first_name">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <label class="control-label" for="new-last-name">Last Name</label>\n        <div class="controls">\n          <input type="text" class="input-xlarge" name="last_name">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <label class="control-label" for="new-email">Email Address</label>\n        <div class="controls">\n          <input type="text" class="input-xlarge" name="email">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <label class="control-label" for="new-password">Password</label>\n        <div class="controls">\n          <input type="password" class="input-xlarge" name="password">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <label class="control-label" for="new-password-confirmation">Password Confirmation</label>\n        <div class="controls">\n          <input type="password" class="input-xlarge" name="password_confirmation">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <div class="controls">\n          <button type="submit" class="btn btn-primary submit">Register</button>\n        </div>\n      </div>\n    </fieldset>\n  </form>\n  <ul class="unstyled">\n    <li>Already have an account? <a href="/login" data-dismiss="modal">Log in</a></li>\n  </ul>\n</div>\n'})}}),window.require.define({"views/templates/rule":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0,h=this.escapeExpression;return s+='<li>\n  <input name="property" value="" placeholder="property" />:\n  <input name="value" value="" placeholder="value" />\n  <input type="hidden" name="selector" value="',u=n.selector,o=u||t.selector,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"selector",{hash:{}})),s+=h(o)+'" />\n  <input type="hidden" name="index" />\n</li>\n',s})}}),window.require.define({"views/templates/share_link":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0,h=this.escapeExpression;return s+="<p>http://makeatheme.com/themes/",u=n.theme,o=u||t.theme,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"theme",{hash:{}})),s+=h(o)+"</p>\n",s})}}),window.require.define({"views/templates/style_edit":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function v(e,t){var r="",i,s;r+="\n  ",a=n.parents,i=a||e.parents,s=n.each,f=l.program(2,m,t),f.hash={},f.fn=f,f.inverse=l.noop,i=s.call(e,i,f);if(i||i===0)r+=i;return r+="\n  ",r}function m(e,t){var r="",i,s;r+="\n  ",a=n.id,i=a||e.id,s=n["if"],f=l.program(3,g,t),f.hash={},f.fn=f,f.inverse=l.program(5,y,t),i=s.call(e,i,f);if(i||i===0)r+=i;return r+="\n  ",r}function g(e,t){var r="",i;return r+='\n  <a href="#" data-selector="#',a=n.id,i=a||e.id,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"id",{hash:{}})),r+=d(i)+'" data-bypass="true">#',a=n.id,i=a||e.id,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"id",{hash:{}})),r+=d(i)+"</a> &gt;\n  ",r}function y(e,t){var r="",i;return r+='\n  <a href="#" data-selector="',a=n.localName,i=a||e.localName,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"localName",{hash:{}})),r+=d(i)+'" data-bypass="true">',a=n.localName,i=a||e.localName,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"localName",{hash:{}})),r+=d(i)+"</a> &gt;\n  ",r}function b(e,t){var r="",i,s;r+='\n    <optgroup label="',a=n.group,i=a||e.group,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"group",{hash:{}})),r+=d(i)+'">\n      ',a=n.tags,i=a||e.tags,s=n.each,f=l.program(8,w,t),f.hash={},f.fn=f,f.inverse=l.noop,i=s.call(e,i,f);if(i||i===0)r+=i;return r+="\n    </optgroup>\n    ",r}function w(e,t){var r="",i;return r+='\n      <option value="',a=n.tag,i=a||e.tag,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"tag",{hash:{}})),r+=d(i)+'"',a=n.selected,i=a||e.selected,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"selected",{hash:{}})),r+=d(i)+">",a=n.label,i=a||e.label,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"label",{hash:{}})),r+=d(i)+" (",a=n.tag,i=a||e.tag,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"tag",{hash:{}})),r+=d(i)+")</option>\n      ",r}function E(e,t){var r="",i,s;r+='\n  <form class="declaration-inputs">\n    <p class="selector">\n      <input value="',a=n.selector,i=a||e.selector,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"selector",{hash:{}})),r+=d(i)+'" placeholder="selector" />&nbsp; {\n    </p>\n    <ul class="rules">\n      ',a=n.rules,i=a||e.rules,s=n.each,f=l.programWithDepth(S,t,e),f.hash={},f.fn=f,f.inverse=l.noop,i=s.call(e,i,f);if(i||i===0)r+=i;return r+='\n    </ul>\n    <button class="btn btn-mini add-rule">Add rule</button>\n    <p>}</p>\n  </form>\n  ',r}function S(e,t,r){var i="",s;return i+='\n      <li>\n        <input name="property" value="',a=n.property,s=a||e.property,typeof s===c?s=s.call(e,{hash:{}}):s===p&&(s=h.call(e,"property",{hash:{}})),i+=d(s)+'" placeholder="property" />:\n        <input name="value" value="',a=n.value,s=a||e.value,typeof s===c?s=s.call(e,{hash:{}}):s===p&&(s=h.call(e,"value",{hash:{}})),i+=d(s)+'" placeholder="value" />\n        <input type="hidden" name="index" value="',a=n.index,s=a||e.index,typeof s===c?s=s.call(e,{hash:{}}):s===p&&(s=h.call(e,"index",{hash:{}})),i+=d(s)+'" />\n        <input type="hidden" name="selector" value="',a=n.selector,s=a||r.selector,typeof s===c?s=s.call(e,{hash:{}}):s===p&&(s=h.call(e,"...selector",{hash:{}})),i+=d(s)+'" />\n      </li>\n      ',i}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;s+='  <p class="selector-choice">\n  Element:\n  ',a=n.parents,o=a||t.parents,u=n["if"],f=l.program(1,v,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;s+="\n  <b>",a=n.selector,o=a||t.selector,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"selector",{hash:{}})),s+=d(o)+'</b>\n  </p>\n\n  <select class="tag">\n    <option value="">Every tag</option>\n    ',a=n.htmlTags,o=a||t.htmlTags,u=n.each,f=l.program(7,b,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;s+="\n  </select>\n\n  ",a=n.declarations,o=a||t.declarations,u=n.each,f=l.program(10,E,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;return s+='\n  <button class="btn add-declaration">Add declaration</button>\n',s})}}),window.require.define({"views/templates/templates":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function v(e,t){var r="",i;return r+='\n    <option value="',a=n.name,i=a||e.name,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"name",{hash:{}})),r+=d(i)+'">',a=n.label,i=a||e.label,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"label",{hash:{}})),r+=d(i)+"</option>\n    ",r}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;s+='<p>Click to change</p>\n<ul class="rects"></ul>\n<form class="new-template-select hide">\n  <legend>Add New Template</legend>\n  <select>\n    ',a=n.standards,o=a||t.standards,u=n.each,f=l.program(1,v,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;return s+='\n    <option value="">Other</option>\n  </select>\n  <input class="new-template-name hide" type="text" value="" placeholder="Enter template name" />\n  <button class="new-template-add btn">Add template</button>\n</form>\n<button class="new-template">&plus; New Template</button>\n',s})}}),window.require.define({"views/templates/templates_select":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function v(e,t){var r="",i;return r+='\n  <option value="',a=n.id,i=a||e.id,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"id",{hash:{}})),r+=d(i)+'"',a=n.selected,i=a||e.selected,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"selected",{hash:{}})),r+=d(i)+">",a=n.label,i=a||e.label,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"label",{hash:{}})),r+=d(i)+"</option>\n  ",r}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;s+="<label>Previewing template:</label>\n<select>\n  ",a=n.templates,o=a||t.templates,u=n.each,f=l.program(1,v,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;return s+="\n</select>\n",s})}}),window.require.define({"views/templates/theme":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0,h=this.escapeExpression;return s+='<iframe id="theme" name="theme" src="/themes/',u=n.id,o=u||t.id,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"id",{hash:{}})),s+=h(o)+'/edit" frameborder="0" width="100%" height="100%"></iframe>\n',s})}}),window.require.define({"views/templates/theme_list":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function v(e,t){var r="",i;return r+='\n      <p>by <a href="#">',a=n.author,i=a||e.author,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"author",{hash:{}})),r+=d(i)+"</a></p>\n      ",r}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;s+='<li class="span3">\n  <div class="thumbnail">\n    <a href="',a=n.uri,o=a||t.uri,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"uri",{hash:{}})),s+=d(o)+'"><img src="',a=n.screenshot_uri,o=a||t.screenshot_uri,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"screenshot_uri",{hash:{}})),s+=d(o)+'" alt=""></a>\n    <div class="caption">\n      <h4>',a=n.name,o=a||t.name,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"name",{hash:{}})),s+=d(o)+"</h4>\n      ",a=n.author,o=a||t.author,u=n["if"],f=l.program(1,v,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;return s+='\n      <div>\n        <a class="btn btn-primary pull-right" href="',a=n.uri,o=a||t.uri,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"uri",{hash:{}})),s+=d(o)+'"><i class="icon-pencil icon-white"></i> ',a=n.edit_text,o=a||t.edit_text,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"edit_text",{hash:{}})),s+=d(o)+"</a>\n      </div>\n    </div>\n  </div>\n</li>\n",s})}}),window.require.define({"views/templates/theme_upload":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s,o=this;return'<div class="modal-header">\n  <button type="button" class="close" data-dismiss="modal"></button>\n  <h3>Upload a new theme</h3>\n</div>\n<div class="modal-body">\n  <form class="form-horizontal">\n    <fieldset>\n      <div class="control-group">\n        <label class="control-label" for="file">Theme Archive</label>\n        <div class="controls">\n          <input type="file" name="file" class="input-xlarge">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <div class="controls">\n          <button type="submit" class="btn btn-primary">Upload Theme</button>\n        </div>\n      </div>\n    </fieldset>\n  </form>\n</div>\n'})}}),window.require.define({"views/templates_select":function(e,t,n){var r=t("views/base/view"),i=t("application"),s=t("models/template"),o=t("views/templates/templates");n.exports=r.extend({id:"templates-preview",className:"x-section",template:"templates_select",collection:i.editor.templates,initialize:function(){var e=this.collection.getCurrent();$("#page").fadeOut().empty().append(e.get("full")).fadeIn()},data:{templates:i.editor.templates.map(function(e){return{id:e.id,label:e.label(),selected:e.get("name")==="index"?" selected='selected'":""}})},events:{"change select":"switchTemplate"},switchTemplate:function(){var e=this.collection.get(this.$("select").val());$("#page").fadeOut().empty().append(e.get("full")).fadeIn()}})}}),window.require.define({"views/theme":function(e,t,n){var r=t("views/base/view"),i=t("application");n.exports=r.extend({template:"theme",data:function(){return{route:this.options.route,id:this.options.themeID,action:this.options.action||""}}})}}),window.require.define({"views/theme_list":function(e,t,n){var r=t("views/base/view"),i=t("collections/themes"),s=t("views/templates/theme_list"),o=t("application");n.exports=r.extend({el:$("<ul class='thumbnails'></ul>"),initialize:function(){this.bindEvents()},render:function(){return this.collection.reset(this.collection.models),this},bindEvents:function(){this.collection.on("reset",this.addAll,this)},addOne:function(e){var t=e.get("author_id")===o.currentUser.id;this.$el.append(s({uri:"/themes/"+e.id,screenshot_uri:e.get("screenshot_uri"),name:e.get("name"),author:e.get("author"),edit_text:t?"Edit":"View & Copy"}))},addAll:function(){this.$el.empty(),this.collection.each(function(e){this.addOne(e)},this)}})}}),window.require.define({"views/theme_upload":function(e,t,n){var r=t("views/base/view"),i=t("application");n.exports=r.extend({className:"modal",template:"theme_upload",events:{"submit form":"sendFormData"},sendFormData:function(e){var t=this.$("form"),n=this.$("button[type=submit]")[0];e.preventDefault(),n.setAttribute("disabled","true"),n.innerHTML="Processing...",t.children(".alert-error").remove(),i.trigger("upload:before"),$.ajax({type:"POST",url:"/themes",data:new FormData(t[0]),success:function(e,t,n){var r=new EventSource("/jobs/"+e.job_id);r.addEventListener("success",this.themeUploaded.bind(this),!1),r.addEventListener("errors",this.themeErrors.bind(this),!1)}.bind(this),error:function(e,r,i){t.prepend("<p class='alert alert-error'>"+i+" Please refresh the page and try again.</p>"),n.removeAttribute("disabled"),n.innerHTML="Upload Theme"},cache:!1,contentType:!1,dataType:"json",processData:!1})},themeUploaded:function(e){var t=JSON.parse(e.data);e.currentTarget.close(),i.trigger("upload:after",t),i.trigger("notification","success","Your theme is uploaded and ready to be edited!"),this.$el.modal("hide"),Backbone.history.navigate("/themes/"+t._id,!0)},themeErrors:function(e){var t,n=JSON.parse(e.data),r=this.$("button[type=submit]")[0];e.currentTarget.close();for(t in n)n.hasOwnProperty(t)&&this.$("form").prepend("<p class='alert alert-error'>"+_.str.humanize(t)+" "+n[t]+"</p>");r.removeAttribute("disabled"),r.innerHTML="Upload Theme"}})}})