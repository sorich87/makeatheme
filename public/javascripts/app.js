(function(){"use strict";var e=typeof window!="undefined"?window:global;if(typeof e.require=="function")return;var t={},n={},r=function(e,t){return{}.hasOwnProperty.call(e,t)},i=function(e,t){var n=[],r,i;/^\.\.?(\/|$)/.test(t)?r=[e,t].join("/").split("/"):r=t.split("/");for(var s=0,o=r.length;s<o;s++)i=r[s],i===".."?n.pop():i!=="."&&i!==""&&n.push(i);return n.join("/")},s=function(e){return e.split("/").slice(0,-1).join("/")},o=function(t){return function(n){var r=s(t),o=i(r,n);return e.require(o)}},u=function(e,t){var r={id:e,exports:{}};t(r.exports,o(e),r);var i=n[e]=r.exports;return i},a=function(e){var s=i(e,".");if(r(n,s))return n[s];if(r(t,s))return u(s,t[s]);var o=i(s,"./index");if(r(n,o))return n[o];if(r(t,o))return u(o,t[o]);throw new Error('Cannot find module "'+e+'"')},f=function(e){for(var n in e)r(e,n)&&(t[n]=e[n])};e.require=a,e.require.define=f,e.require.brunch=!0})(),window.require.define({application:function(e,t,n){Application=window.Application||{},_.extend(Application,{initialize:function(){var e=t("router"),n=t("lib/mixpanel");this.debug=this.data.debug,this.reuseView("notifications").render().$el.appendTo($("body",window.top.document)),this.setCurrentUser(),this.router=new e,n.initialize(),this.reuseView("auth_links").render(),this.setBodyClasses(),this.editor={},this.authRedirect(),Object.freeze(this)},createView:function(e,n){var r=this.views||{},i=t("views/"+e);return r[e]!==void 0&&(r[e].undelegateEvents(),(!n||!n.el)&&r[e].remove(),r[e].off(),"teardown"in r[e]&&r[e].teardown()),r[e]=new i(n),this.views=r,r[e]},reuseView:function(e,n){var r=this.views||{},i=t("views/"+e);return r[e]!==void 0?r[e]:(r[e]=new i(n),this.views=r,r[e])},setBodyClasses:function(){if(this.data.theme)return;Backbone.history.on("route",function(e,t){document.body.className=t}.bind(this))},setCurrentUser:function(){var e=t("models/user"),n=t("collections/themes");this.data.currentUser?(this.currentUser=new e(this.data.currentUser),this.currentUser.set("themes",new n(this.data.currentUser.themes))):this.currentUser=new e,this.on("theme:created",this.updateCurrentUserThemes,this),this.on("theme:copied",this.updateCurrentUserThemes,this)},updateCurrentUserThemes:function(e){this.currentUser.get("themes").add(e)},authRedirect:function(){this.on("login",this.historyBack),this.on("registration",this.historyBack)},historyBack:function(){Backbone.history.back(!0)||Backbone.history.navigate("/",!0)}},Backbone.Events),n.exports=Application}}),window.require.define({"collections/base/collection":function(e,t,n){n.exports=Backbone.Collection.extend({})}}),window.require.define({"collections/blocks":function(e,t,n){var r=t("collections/base/collection"),i=t("models/block");n.exports=r.extend({model:i,getByName:function(e){return this.find(function(t){return t.get("name")===e})}})}}),window.require.define({"collections/regions":function(e,t,n){var r=t("collections/base/collection"),i=t("models/region");n.exports=r.extend({model:i,getByName:function(e,t){return t===void 0&&(t="default"),this.find(function(n){return n.get("slug")===t&&n.get("name")===e})}})}}),window.require.define({"collections/templates":function(e,t,n){var r=t("collections/base/collection"),i=t("models/template");n.exports=r.extend({model:i,getByName:function(e){return this.find(function(t){return t.get("name")===e})},getCurrent:function(){var e=this.find(function(e){return e.get("current")===!0});return e||(e=this.getByName("index")),e},setCurrent:function(e){var t=this.getCurrent();t&&t.set("current",!1),e.set("current",!0)}})}}),window.require.define({"collections/themes":function(e,t,n){var r=t("collections/base/collection"),i=t("models/theme");n.exports=r.extend({model:i,url:"/themes"})}}),window.require.define({initialize:function(e,t,n){var r=t("application");jQuery(function(e){r.initialize(),Backbone.history.start({pushState:!0}),e(window.top.document).on("click","a:not([data-bypass])",function(t){var n={prop:e(this).prop("href"),attr:e(this).attr("href")},r=location.protocol+"//"+location.host+"/";if(n.attr==="#")return;n.prop&&n.prop.slice(0,r.length)===r&&Backbone.history.fragment!==""&&(t.preventDefault(),Backbone.history.navigate(n.attr,{trigger:!0,replace:!!e(this).data("replace")}))}),Backbone.history.on("route",function(e,t){if("_gaq"in window){var n="/"+this.getFragment();_gaq.push(["_trackPageview",n])}})})}}),window.require.define({"lib/css_properties":function(e,t,n){n.exports=["align-content","align-items","align-self","alignment-adjust","alignment-baseline","anchor-point","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","azimuth","backface-visibility","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","baseline-shift","binding","bleed","bookmark-label","bookmark-level","bookmark-state","bookmark-target","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","clear","clip","clip-path","color","color-profile","columns","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","content","counter-increment","counter-reset","crop","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","drop-initial-after-adjust","drop-initial-after-align","drop-initial-before-adjust","drop-initial-before-align","drop-initial-size","drop-initial-value","elevation","empty-cells","filter","fit","fit-position","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","float-offset","font","font-family","font-feature-settings","font-kerning","font-language-override","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-weight","grid-cell","grid-column","grid-column-align","grid-column-sizing","grid-column-span","grid-columns","grid-flow","grid-row","grid-row-align","grid-row-sizing","grid-row-span","grid-rows","grid-template","hanging-punctuation","height","hyphens","icon","image-rendering","image-resolution","image-orientation","ime-mode","inline-box-align","justify-content","left","letter-spacing","line-break","line-height","line-stacking","line-stacking-ruby","line-stacking-shift","line-stacking-strategy","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marks","marquee-direction","marquee-loop","marquee-play-count","marquee-speed","marquee-style","mask","max-height","max-width","min-height","min-width","move-to","nav-down","nav-index","nav-left","nav-right","nav-up","object-fit","object-position","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-style","overflow-wrap","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","page-policy","pause","pause-after","pause-before","perspective","perspective-origin","pitch","pitch-range","play-during","pointer-events","position","presentation-level","punctuation-trim","quotes","rendering-intent","resize","rest","rest-after","rest-before","richness","right","rotation","rotation-point","ruby-align","ruby-overhang","ruby-position","ruby-span","size","speak","speak-as","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","string-set","table-layout","tab-size","target","target-name","target-new","target-position","text-align","text-align-last","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-height","text-indent","text-justify","text-overflow","text-outline","text-rendering","text-shadow","text-space-collapse","text-transform","text-underline-position","text-wrap","top","transform","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","unicode-bidi","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","volume","white-space","widows","width","word-break","word-spacing","word-wrap","z-index"]}}),window.require.define({"lib/custom_css":function(e,t,n){var r=t("./matches_selector"),i=function(e){this.sheets={},this.rules={},this.insertRules(e)};i.prototype.createSheet=function(e){var t=document.createElement("style");return t.type="text/css",t.rel="stylesheet",t.media=e,document.head.appendChild(t),this.sheets[e]=t.sheet,this.sheets[e]},i.prototype.insertRule=function(e,t){var n,r,i=e.media||"all";if(!e.selector||!e.property||e.value===void 0)return;this.sheets[i]=this.sheets[i]||this.createSheet(i),e.index!==null&&e.index!==void 0?n=e.index:t&&(n=this.getIndex(e)),this.deleteRule(n),n=this.sheets[i].cssRules.length,declaration=e.selector+" {"+e.property+": "+e.value+"}";try{this.sheets[i].insertRule(declaration,n)}catch(s){}return this.rules[i]=this.rules[i]||{},this.rules[i][n]={selector:e.selector,property:e.property,value:e.value},n},i.prototype.insertRules=function(e){e.forEach(function(e,t){this.insertRule(e)},this)},i.prototype.getIndex=function(e){var t;for(t in this.rules[e.media]){if(!this.rules[e.media].hasOwnProperty(t))continue;if(this.rules[e.media][t].selector===e.selector&&this.rules[e.media][t].property===e.property)return t}},i.prototype.getDeclarations=function(e){var t,n,i,s,o,u,a,f={},l={},c=function(e){return e},h=function(e,t){return t.specificity-e.specificity};if(!e)return;this.isElement(e)||(e=this.createGhostElement(e));for(t in this.rules){if(!this.rules.hasOwnProperty(t))continue;l={};for(s in this.rules[t]){n=this.rules[t][s],a=n.selector.replace(/:[^,\s]*(\w|\))/g,"").trim(),a===""&&(a="*");if(!r(e,a))continue;l[n.selector]||(l[n.selector]={selector:n.selector,rules:[],specificity:this.calculateSpecificity(a,e)}),u=l[n.selector].rules.length,l[n.selector].rules[u]={property:n.property,value:n.value,index:s}}f[t]=[];for(o in l){if(!l.hasOwnProperty(o))continue;u=f[t].length,f[t][u]=l[o]}f[t].reverse().sort(h)}return f},i.prototype.getRules=function(){var e,t,n,r,i,s=[];for(e in this.rules){if(!this.rules.hasOwnProperty(e))continue;s[e]=s[e]||{};for(t in this.rules[e]){if(!this.rules[e].hasOwnProperty(t))continue;rule=this.rules[e][t],s[s.length]={media:e,selector:rule.selector,property:rule.property,value:rule.value}}}return s},i.prototype.deleteRule=function(e,t){if(e===null||e===void 0)return;t=t||"all";try{this.sheets[t].deleteRule(e)}catch(n){}delete this.rules[t][e]},i.prototype.calculateSpecificity=function(e,t){var n;return e.split(",").forEach(function(e){e=e.trim();if(r(t,e)){n=SPECIFICITY.calculate(e)[0].specificity,n=parseInt(n.split(",").join(""),10);return}}),n},i.prototype.createGhostElement=function(e){var t,n=document.implementation.createHTMLDocument(""),r=e.split(" ");return r.forEach(function(e){var r=t;e.indexOf("#")===0?(t=n.createElement("div"),t.id=e.substring(1)):e.indexOf(".")===0?(t=n.createElement("div"),t.classname=e.substring(1)):t=n.createElement(e),r&&r.appendChild(t)}),t},i.prototype.isElement=function(e){return typeof HTMLElement=="object"?e instanceof HTMLElement:e&&typeof e=="object"&&e.nodeType===1&&typeof e.nodeName=="string"},n.exports=i}}),window.require.define({"lib/editor_data":function(e,t,n){var r,i=t("application"),s=t("collections/templates"),o=t("collections/regions"),u=t("collections/blocks"),a=t("lib/custom_css");r=sessionStorage.getItem("theme-"+i.data.theme._id),r=JSON.parse(r),r||(r={templates:i.data.theme_pieces.templates,regions:i.data.theme_pieces.regions,blocks:i.data.theme_pieces.blocks,style:i.data.style}),r={templates:new s(r.templates),regions:new o(r.regions),blocks:new u(r.blocks),style:new a(r.style)},setInterval(function(){var e={templates:r.templates.toJSON(),regions:r.regions.toJSON(),blocks:r.blocks.toJSON(),style:r.style.getRules()};e=JSON.stringify(e);try{sessionStorage.setItem("theme-"+i.data.theme._id,e)}catch(t){sessionStorage.clear()}},1e3),n.exports=r}}),window.require.define({"lib/html_tags":function(e,t,n){n.exports=[{group:"Headings",tags:[{tag:"h1",label:"Headings 1"},{tag:"h2",label:"Headings 2"},{tag:"h3",label:"Headings 3"},{tag:"h4",label:"Headings 4"},{tag:"h5",label:"Headings 5"},{tag:"h6",label:"Headings 6"}]},{group:"Content sections",tags:[{tag:"p",label:"Paragraphs"},{tag:"blockquote",label:"Block quotations"},{tag:"pre",label:"Pre-formatted content"},{tag:"address",label:"Addresses"},{tag:"ins",label:"Inserted content"},{tag:"del",label:"Deleted content"},{tag:"hr",label:"Horizontal rules"}]},{group:"Inline elements",tags:[{tag:"a",label:"Links"},{tag:"abbr",label:"Abbreviations"},{tag:"acronym",label:"Acronyms"},{tag:"dfn",label:"Inline definitions"},{tag:"em",label:"Emphases"},{tag:"strong",label:"Strong emphases"},{tag:"cite",label:"Citations"},{tag:"q",label:"Inline quotations"},{tag:"sub",label:"Subscripts"},{tag:"sup",label:"Superscripts"}]},{group:"Lists",tags:[{tag:"dl",label:"Definition Lists"},{tag:"dt",label:"Definition Terms"},{tag:"dd",label:"Definitions"},{tag:"ol",label:"Ordered Lists"},{tag:"ul",label:"Unordered Lists"},{tag:"menu",label:"Menu Lists"},{tag:"li",label:"List Items"}]},{group:"Forms",tags:[{tag:"form",label:"Forms"},{tag:"fieldset",label:"Fieldsets"},{tag:"legend",label:"Fieldset legends"},{tag:"input[type=checkbox]",label:"Checkboxes"},{tag:"input[type=radio]",label:"Radio buttons"},{tag:"button",label:"Buttons"},{tag:"input[type=button]",label:"Buttons"},{tag:"input[type=submit]",label:"Submit buttons"},{tag:"input[type=image]",label:"Image buttons"},{tag:"input[type=reset]",label:"Reset buttons"},{tag:"input[type=text]",label:"Text fields"},{tag:"input[type=text]",label:"Text fields"},{tag:"input[type=password]",label:"Password fields"},{tag:"input[type=file]",label:"File fields"},{tag:"select",label:"Selection lists"},{tag:"optgroup",label:"Group of options"},{tag:"option",label:"Options"},{tag:"textarea",label:"Multi-line text areas"}]},{group:"Tables",tags:[{tag:"table",label:"Tables"},{tag:"caption",label:"Table captions"},{tag:"thead",label:"Table headers"},{tag:"tbody",label:"Table bodies"},{tag:"tfoot",label:"Table footers"},{tag:"tr",label:"Table rows"},{tag:"th",label:"Table header cells"},{tag:"td",label:"Table data cells"},{tag:"colgroup",label:"Table column groups"},{tag:"col",label:"Table columns"}]},{group:"Media",tags:[{tag:"img",label:"Images"},{tag:"map",label:"Maps"},{tag:"area",label:"Map areas"},{tag:"object",label:"Media object"},{tag:"embed",label:"Media embed"},{tag:"iframe",label:"Iframes"}]},{group:"Computer text",tags:[{tag:"code",label:"Source code"},{tag:"var",label:"Source code variables"},{tag:"kbd",label:"User input"},{tag:"samp",label:"Program output"}]},{group:"Presentation",tags:[{tag:"b",label:"b"},{tag:"i",label:"i"},{tag:"u",label:"u"},{tag:"s",label:"s"},{tag:"small",label:"small"},{tag:"big",label:"big"},{tag:"tt",label:"tt"}]}]}}),window.require.define({"lib/matches_selector":function(e,t,n){function s(e,t){if(i)return i.call(e,t);var n=e.parentNode.querySelectorAll(t);for(var r=0;r<n.length;++r)if(n[r]==e)return!0;return!1}var r=Element.prototype,i=r.matchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector;n.exports=s}}),window.require.define({"lib/mixpanel":function(e,t,n){var r,i=t("application");r={people:{identify:function(e){console.log("mixpanel.identify"),console.log(e)},increment:function(e){console.log("mixpanel.people.increment"),console.log(e)},set:function(e){console.log("mixpanel.people.set"),console.log(e)}},track:function(e,t){console.log("mixpanel.track"),console.log(e),console.log(t)}},n.exports={initialize:function(){i.debug&&(window.mixpanel=r);if(!("mixpanel"in window))return;i.on("registration",this.setUserAttributes),i.on("login",this.setUserLastLogin),$("body").on("click","[data-event]",this.trackClickEvent.bind(this)),Backbone.history.on("route",this.trackRouteChange.bind(this))},setUserAttributes:function(e){mixpanel.people.set({$created:new Date(e.get("created_at")),$email:e.get("email"),$first_name:e.get("first_name"),$last_name:e.get("last_name")}),mixpanel.people.identify(e.id),mixpanel.track("Registration")},setUserLastLogin:function(e){mixpanel.people.set({$last_login:new Date}),mixpanel.people.identify(e.id),mixpanel.track("Login")},trackClickEvent:function(e){var t,n={},r=e.currentTarget.getAttribute("data-event").split(":"),i=r.splice(0,1)[0],s="trackUser"+i.replace(/\s/g,"");while(r.length>0)t=r.splice(0,2),n[t[0]]=t[1];mixpanel.track(i,n),this[s]!==void 0&&this[s](n)},trackUserDownload:function(e){mixpanel.people.increment(e.format+" downloads")},trackUserNewTheme:function(e){mixpanel.people.increment("themes "+e.type)},trackRouteChange:function(e,t){switch(t){case"index":mixpanel.track("Home Page Visit");break;case"register":mixpanel.track("Registration Form Loaded")}}}}}),window.require.define({"lib/mutations":function(e,t,n){var r=t("application");n.exports={initialize:function(){r.on("node:added",this.addNode.bind(this)),r.on("node:removed",this.removeNode.bind(this)),this.pieces={},r.trigger("mutations:started",this.pieces)},addNode:function(e,t){var n,r,i,s,o,u,a,f;copy=e.cloneNode(!0);if(t==="row")n=e.parentNode;else{n=e.parentNode.parentNode;for(var l in this.pieces.blocks.models){u=this.pieces.blocks.models[l];if(e.firstElementChild.getAttribute("data-x-name")===u.get("name")&&e.firstElementChild.getAttribute("data-x-label")===u.get("label")){copy.innerHTML=u.tag();break}}}piece=this.getTemplatePiece(n),o=(new DOMParser).parseFromString(piece.get("template"),"text/html"),s=o.getElementById(e.parentNode.id),this.cleanupNode(copy),e.nextElementSibling?"FOOTER"===e.nextElementSibling.tagName?o.body.innerHTML=o.body.innerHTML+copy.outerHTML:(nextNode=o.getElementById(e.nextElementSibling.id),nextNode.parentNode&&nextNode.parentNode.insertBefore(copy,nextNode)):o.getElementById(e.parentNode.id).appendChild(copy),piece.set("template",o.body.innerHTML)},removeNode:function(e,t,n){var r;if(n==="row")r=t;else{r=t.parentNode;if(r===null)return}piece=this.getTemplatePiece(r),sandbox=(new DOMParser).parseFromString(piece.get("template"),"text/html"),copy=sandbox.getElementById(e.id),copy.parentNode.removeChild(copy),piece.set("template",sandbox.body.innerHTML)},getTemplatePiece:function(e){var t,n,r,i;return n=this.pieces.templates.getCurrent(),["HEADER","FOOTER"].indexOf(e.tagName)!==-1?(i=e.tagName.toLowerCase(),r=n.get("regions"),t=this.pieces.regions.getByName(i,r[i]),t.set("build",e.outerHTML)):(t=n,templateClone=window.document.getElementById("page").cloneNode(!0),$(templateClone).children("header, footer").remove(),t.set("build",templateClone.innerHTML)),t},cleanupNode:function(e){$(e).removeClass("x-current x-full x-not-full x-empty").children(".x-resize, .x-remove").remove().end().find("a[data-bypass=true]").removeAttr("data-bypass")}}}}),window.require.define({"lib/view_helpers":function(e,t,n){var r=t("application"),i=t("models/user");Handlebars.registerHelper("current_user",function(){return!!r.currentUser.id}),Handlebars.registerHelper("selected",function(e,t){return e===t?" selected='selected'":""})}}),window.require.define({"models/base/model":function(e,t,n){n.exports=Backbone.Model.extend({})}}),window.require.define({"models/block":function(e,t,n){var r=t("models/base/model");n.exports=r.extend({idAttribute:"_id",defaults:{name:"",template:"",build:""},label:function(){return _.str.titleize(this.get("label")+" "+_.str.humanize(this.get("name")))},className:function(){return this.get("name").replace("_","-")},tag:function(){var e="";return this.get("label")!=="Default"&&(e=" "+this.get("label")),"{% "+this.get("name")+e+" %}"}})}}),window.require.define({"models/region":function(e,t,n){var r=t("models/base/model");n.exports=r.extend({idAttribute:"_id",defaults:{slug:"",name:"",template:""},validate:function(e){if(["header","footer"].indexOf(e.name)<0)return"Region must be header or footer."}})}}),window.require.define({"models/template":function(e,t,n){var r=t("models/base/model");n.exports=r.extend({idAttribute:"_id",defaults:{name:"",template:"",build:"",regions:{header:"default",footer:"default"}},label:function(){var e;for(e in this.standards){if(!this.standards.hasOwnProperty(e))continue;if(this.get("name")===this.standards[e].name)return this.standards[e].label}return this.get("name")},setRegion:function(e,t){var n=this.get("regions");n[e]=t,this.set("regions",n)},standards:[{name:"index",label:"Default"},{name:"front-page",label:"Front Page"},{name:"home",label:"Blog"},{name:"single",label:"Article"},{name:"page",label:"Page"},{name:"archive",label:"Archive"},{name:"search",label:"Search Results"},{name:"404",label:"Error 404"}]})}}),window.require.define({"models/theme":function(e,t,n){var r=t("models/base/model");n.exports=r.extend({idAttribute:"_id",urlRoot:"/themes",defaults:{name:"",author:"",screenshot_uri:""}})}}),window.require.define({"models/user":function(e,t,n){var r=t("models/base/model"),i=t("collections/themes");n.exports=r.extend({defaults:{first_name:"",last_name:"",email:"",password:"",password_confirmation:"",themes:[]},initialize:function(){var e=new i(this.attributes.themes)},url:"/users",validation:{first_name:{required:!0},last_name:{required:!0},email:{required:!0,pattern:"email"},password:{required:function(e,t,n){return n&&!n.id?!0:!1}},password_confirmation:{equalTo:"password"}}})}}),window.require.define({router:function(e,t,n){var r=t("application");n.exports=Backbone.Router.extend({routes:{"":"user_themes",themes:"themes","themes/:id":"theme","themes/:id/edit":"edit",account:"account",login:"login",register:"register",reset_password:"reset_password","*actions":"notFound"},themes:function(){this.userOnly(),$("#main").empty().append(r.createView("themes").render().$el)},user_themes:function(){this.userOnly(),$("#main").empty().append(r.createView("user_themes").render().$el)},theme:function(e){r.createView("theme",{themeID:e,el:$("#main")}).render(),jQuery(function(e){e("body").on("click",".accordion-toggle",function(t){e(".color").spectrum({showAlpha:!0,showInput:!0,showPalette:!0,preferredFormat:"rgb",change:function(t,n){e("#theme").get(0).contentWindow.$(this).trigger("change")}})})})},edit:function(e){if(r.data.theme===void 0){window.top.Backbone.history.navigate("/404",{trigger:!0,replace:!0});return}r.createView("editor").render()},account:function(){this.userOnly(),$("#main").empty().append(r.createView("account").render().$el)},login:function(){this.anonymousOnly(),$("#main").empty().append(r.createView("login").render().$el)},register:function(){this.anonymousOnly(),$("#main").empty().append(r.createView("register").render().$el)},reset_password:function(){this.anonymousOnly(),$("#main").empty().append(r.createView("password_reset").render().$el)},notFound:function(e){$("#main").empty().append(r.reuseView("not_found").render().$el)},userOnly:function(){if(!r.currentUser.id)return document.location="/login",!0},anonymousOnly:function(){if(r.currentUser.id)return document.location="/",!0}})}}),window.require.define({"views/account":function(e,t,n){var r=t("application"),i=t("views/base/view"),s=t("views/templates/account"),o=t("models/user");n.exports=i.extend({className:"row",template:"account",model:_.clone(r.currentUser),events:{"submit form":"editUser","change .error input":"clearError","click #delete-user":"deleteUser"},initialize:function(){Backbone.Validation.bind(this)},render:function(){return this.$el.empty().append(s(this.model.toJSON())),this},editUser:function(e){var t={};e.preventDefault(),this.$("input").each(function(){t[this.getAttribute("name")]=this.value}),this.$("button[type=submit]").get(0).setAttribute("disabled","true"),this.model.save(t,{success:function(e,t){r.currentUser.set(t),this.$("button[type=submit]").get(0).removeAttribute("disabled"),r.trigger("user:edit",r.currentUser),r.trigger("notification","success","Changes to your account have been saved.")}.bind(this),error:function(e,t){this.$("button[type=submit]").get(0).removeAttribute("disabled"),this.displayServerErrors(t)}.bind(this)})},displayServerErrors:function(e){if(!e.responseText)return;var t=JSON.parse(e.responseText);Object.keys(t).forEach(function(e){var n=Backbone.Validation.labelFormatters.sentenceCase(e)+" "+t[e][0];Backbone.Validation.callbacks.invalid(this,e,n,"name")}.bind(this))},clearError:function(e){$(e.currentTarget).closest(".error").removeClass("error").find(".error-message").remove()},deleteUser:function(){var e="Are you sure you want to delete your account? All your data will be deleted and we won't be able to recover it.";if(!window.confirm(e))return;this.model.destroy({success:function(e){window.location="/"},error:function(e){r.trigger("notification","error","Error. Unable to delete your account. Please try again or contact us.")}})}})}}),window.require.define({"views/advanced_style_edit":function(e,t,n){var r=t("views/base/view"),i=t("views/templates/declaration"),s=t("views/templates/rule"),o=t("application"),u=t("lib/html_tags");n.exports=r.extend({events:{"click .add-rule":"addRuleInputs","keyup .rules input":"editRule","change .rules input":"editRule","click .add-declaration":"addDeclarationInputs","keyup .selector input":"editDeclaration","change .selector input":"editDeclaration"},initialize:function(e){this.media=e.media,this.tag=e.tag,this.selector=e.selector,this.customCSS=e.customCSS,this.currentCSS=e.currentCSS},render:function(){var e="",t=this.currentCSS,n;if(t)for(n=0;n<t.length;n++)e+=i(t[n]);return e+="<button class='btn add-declaration'>Add declaration</button>",this.$el.empty().append(e),this.markNonAppliedRules(),this},addRuleInputs:function(e){var t=$(e.currentTarget),n=t.siblings("ul");e.preventDefault(),n.append(s({selector:t.siblings(".selector").find("input").val()}))},editRule:function(e,t){var n,r,i=$(e.target).parent();property=i.find("input[name=property]").val(),value=i.find("input[name=value]").val(),r=i.find("input[name=index]").val()||null,n=i.find("input[name=selector]").val(),n=n.trim().replace(/^[^a-zA-Z#\.\[]|\W+$/g,""),property&&value?r=this.customCSS.insertRule({selector:n,property:property,value:value,index:r,media:this.media}):(r&&(this.customCSS.deleteRule(r,this.media),r=""),!property&&!value&&e.type==="change"&&i.remove()),i.find("input[name=index]").val(r)},addDeclarationInputs:function(e){var t=this.selector;e.preventDefault(),this.tag&&(t=this.selector+" "+this.tag),$(e.currentTarget).before(i({selector:t}))},editDeclaration:function(e){var t=$(e.currentTarget),n=t.val();!n&&e.type==="change"&&t.closest(".declaration-inputs").remove(),t.parent().siblings("ul").find("input[name=selector]").val(n).trigger("change")},markNonAppliedRules:function(){var e={};this.$(".rules input[name=property]").each(function(){var t=e[this.value];if(t===void 0){e[this.value]=this;return}this.parentNode.parentNode!==t.parentNode.parentNode&&$(this.parentNode).addClass("inactive")})}})}}),window.require.define({"views/auth_links":function(e,t,n){var r=t("views/base/view"),i=t("views/templates/auth_links"),s=t("application");n.exports=r.extend({el:$("#auth-links"),model:s.currentUser,events:{"click #logout":"deleteSession"},initialize:function(){this.model.on("change",this.render,this)},teardown:function(){this.model.off("change",this.render,this)},render:function(){var e=i(this.model.toJSON());return this.$el.empty().append(e),this},deleteSession:function(e){e.preventDefault(),$.ajax({contentType:"application/json; charset=UTF-8",dataType:"json",type:"DELETE",url:"/session",complete:function(e,t){t==="success"&&(sessionStorage.clear(),s.trigger("logout"),setTimeout(function(){window.location="/login"}))}.bind(this)})}})}}),window.require.define({"views/base/view":function(e,t,n){t("lib/view_helpers"),n.exports=Backbone.View.extend({render:function(){var e;return this.template&&(e=_.isFunction(this.data)?this.data():this.data,this.$el.empty().append(t("views/templates/"+this.template)(e))),this}})}}),window.require.define({"views/blocks":function(e,t,n){var r=t("views/base/view"),i=t("views/templates/blocks"),s=t("application");n.exports=r.extend({id:"x-block-insert",className:"x-section",collection:s.editor.blocks,events:{"click .new-block":"showForm","submit .new-block-select":"addBlock","click .close":"removeBlock","mouseover .x-drag":"makeDraggable"},initialize:function(){this.collection.on("reset",this.addAll,this),this.collection.on("add",this.addOne,this),this.collection.on("remove",this.removeOne,this),s.on("mutations:started",this.makeMutable,this),s.on("save:before",this.addThemeAttributes,this),s.on("block:inserted",this.insertBlock,this),this.allBlocks=_.map(s.data.blocks,function(e){return e.label=_.str.titleize(_.str.humanize(e.name)),e})},teardown:function(){this.collection.off("reset",this.addAll,this),this.collection.off("add",this.addOne,this),this.collection.off("remove",this.removeOne,this),s.off("mutations:started",this.makeMutable,this),s.off("save:before",this.addThemeAttributes,this),s.off("block:inserted",this.insertBlock,this)},render:function(){return this.$el.empty().append(i({all:this.allBlocks})),this.collection.reset(this.collection.models),this},makeDraggable:function(e){this.$(e.currentTarget).draggable({addClasses:!1,helper:function(){return $(this).clone().appendTo("body")},revert:"invalid",scroll:!1,zIndex:99999})},addOne:function(e){var t="";e.get("label")!="Default"&&(t=" <span class='close' title='Delete block'>&times;</span>"),this.$("ul").append("<li class='x-drag' data-cid='"+e.cid+"'>"+"<span>&Dagger;</span> "+e.label()+t+"</li>")},addAll:function(){this.$("ul").empty(),_.each(this.collection.models,function(e){this.addOne(e)},this)},removeOne:function(e){this.$("span[data-cid='"+e.cid+"']").closest("li").remove()},insertBlock:function(e,t){var n=this.collection.getByCid($(e).data("cid"));e.outerHTML="<div id='"+t+"' class='column "+n.className()+"'>"+n.get("build")+"</div>",s.trigger("node:added",window.document.getElementById(t))},makeMutable:function(e){e.blocks=this.collection},showForm:function(e){var t=this.$(".new-block-select");t.is(":hidden")?t.show("normal"):t.hide("normal")},addBlock:function(e){var t,n,r,i,o;e.preventDefault(),t=this.$(".new-block-select select").val(),n=this.$(".new-block-name").val();if(!n){s.trigger("notification","error","Please, enter a block name.");return}r=_.clone(_.find(this.allBlocks,function(e){return e.name===t})),o=(new DOMParser).parseFromString(r.build,"text/html").body,o.firstChild.setAttribute("data-x-label",n),o.firstChild.setAttribute("data-x-name",t),r.build=o.outerHTML,r.label=n,this.collection.add(r),this.render(),s.trigger("notification","success","New block created. Drag and drop into the page to add it.")},removeBlock:function(e){if(confirm("Are you sure you want to delete this block?")){var t=$(e.currentTarget).parent().data("cid");this.collection.remove(t),this.render()}},addThemeAttributes:function(e){e.blocks=_.map(this.collection.models,function(e){return _.pick(e.attributes,"_id","name","label","template")})}})}}),window.require.define({"views/device_switch":function(e,t,n){var r=t("application"),i=t("views/base/view"),s=t("views/templates/device_switch");n.exports=i.extend({id:"device-switch",events:{"click .pc-size":"resizeToPC","click .tablet-size":"resizeToTablet","click .phone-size":"resizeToPhone"},render:function(){return this.el.innerHTML=s(),this},resizeToPC:function(e){e.preventDefault(),$("#theme",window.top.document).animate({width:"1440px",left:"50%","margin-left":"-50%"})},resizeToTablet:function(e){e.preventDefault(),$("#theme",window.top.document).animate({width:"768px",left:"50%","margin-left":"-384px"})},resizeToPhone:function(e){e.preventDefault(),$("#theme",window.top.document).animate({width:"480px",left:"50%","margin-left":"-240px"})}})}}),window.require.define({"views/download_button":function(e,t,n){var r=t("views/base/view"),i=t("application"),s=t("views/templates/download_button");n.exports=r.extend({id:"download-button",events:{"click button.x-login":"login"},initialize:function(){i.on("save:after",this.waitForArchive,this)},teardown:function(){i.off("save:after",this.waitForArchive,this)},render:function(){var e;return this.$el.empty().append(s({id:i.data.theme._id})),i.data.theme.has_archive||this.$el.hide(),this},login:function(){window.top.Backbone.history.navigate("/login",!0)},download:function(e){var t=$("#download-iframe",window.top.document),n="/themes/"+i.data.theme._id+"/download";e.preventDefault(),t.length===0?t=$("<iframe id='download-iframe' width='0' height='0' src='"+n+"'></iframe>").appendTo($("body",window.top.document)):t.attr("src",n)},waitForArchive:function(e){var t=this.$("button")[0],n=new EventSource("/jobs/"+e.get("archive_job_id"));this.$el.show(),t.setAttribute("disabled","true"),t.innerHTML="Rebuilding archives...",n.addEventListener("success",this.archiveSuccess.bind(this),!1),n.addEventListener("errors",this.archiveErrors.bind(this),!1)},resetButton:function(e){var t=this.$("button")[0];e.currentTarget.close(),t.removeAttribute("disabled"),t.innerHTML="Download Theme <span class='caret'></span>"},archiveSuccess:function(e){this.resetButton(e),i.trigger("notification","success","Theme archives updated.")},archiveErrors:function(e){this.resetButton(e),i.trigger("notification","error","Error updating the theme archives.")}})}}),window.require.define({"views/edit_actions":function(e,t,n){var r=t("application"),i=t("views/base/view"),s=t("lib/mutations"),o=t("views/templates/accordion_group");n.exports=i.extend({id:"edit-actions",panels:[{id:"templates",title:"Current Template"},{id:"regions",title:"Header &amp; Footer"},{id:"blocks",title:"Blocks"},{id:"share_link",title:"Share"}],render:function(){r.createView("regions"),r.createView("blocks"),r.createView("style_edit"),r.createView("share_link"),r.createView("save_button"),r.createView("download_button"),r.createView("layout").render(),this.$el.empty().append("<div id='general'></div>").children().append("<div class='accordion'>"+this.accordionGroups.apply(this)+"</div>").append(r.reuseView("save_button").render().$el).append(r.reuseView("download_button").render().$el).end().append(r.reuseView("style_edit").render().$el.hide());for(var e in this.panels){if(!this.panels.hasOwnProperty(e))return;this.$("#editor-"+this.panels[e].id+" .accordion-inner").empty().append(r.reuseView(this.panels[e].id).render().$el)}return s.initialize(),this},accordionGroups:function(){var e="";for(var t in this.panels)this.panels.hasOwnProperty(t)&&(e+=this.buildAccordionGroup(this.panels[t]));return e},buildAccordionGroup:function(e){return o({parent:"editor-accordion",id:"editor-"+e.id,title:e.title,content:""})}})}}),window.require.define({"views/editor":function(e,t,n){var r=t("application"),i=t("views/base/view"),s=t("lib/editor_data"),o=t("lib/mutations"),u=t("views/templates/theme_meta"),a=t("views/templates/accordion_group");n.exports=i.extend({id:"layout-editor",initialize:function(){_.extend(r.editor,{preview_only:!!r.data.preview_only,templates:s.templates,regions:s.regions,blocks:s.blocks,style:s.style}),$(window).on("resize",this.resize.bind(this))},teardown:function(){$(window).off("resize",this.resize.bind(this))},render:function(){var e;return this.$el.empty().append(r.createView("editor_toggle").render().$el).append(r.createView("device_switch").render().$el).append(r.createView("theme_meta").render().$el),r.data.theme.author_id===r.currentUser.id?e="edit_actions":e="preview_actions",this.$el.append(r.createView(e).render().$el),this.$el.appendTo($("#main",window.top.document)),this.resize(),this.preventActions(),r.trigger("editor:loaded"),this},resize:function(){this.$el.height($(window.top).height()-60)},preventActions:function(){$("body").on("click",".column a",this.preventDefault).on("mousedown",".column a, .column img",this.preventDefault).on("submit",".column form",this.preventDefault)},preventDefault:function(e){e.preventDefault()}})}}),window.require.define({"views/editor_toggle":function(e,t,n){var r=t("application"),i=t("views/base/view");n.exports=i.extend({id:"editor-toggle",events:{click:"toggleEditor"},render:function(){return this.el.innerHTML="&rarr;",this},toggleEditor:function(e){this.el.className==="collapsed"?($(e.currentTarget.parentNode).animate({"margin-right":"0"}),$("#canvas",window.top.document).animate({width:this.canvasWidth}),this.el.innerHTML="&rarr;",this.el.className=""):(this.canvasWidth=$("#canvas",window.top.document).css("width"),$(e.currentTarget.parentNode).animate({"margin-right":"-250px"}),$("#canvas",window.top.document).animate({width:"100%"}),this.el.innerHTML="&larr;",this.el.className="collapsed")}})}}),window.require.define({"views/layout":function(e,t,n){var r,i,s=t("views/base/view"),o=t("application"),u=1;r=function(e,t){return _.reduce($(e).children(),function(e,n){return n===t?e:e+$(n).outerWidth(!0)},0)},i=function(e,t){return $(e).children().length>0&&$(e).width()<r(e,t)+$(t).width()},n.exports=s.extend({el:$("body"),events:{"click .column":"highlightColumns","click .column .x-remove":"removeColumn","mouseenter .column":"makeDraggable","mouseenter .row":"makeDroppable","mouseenter .x-resize":"makeResizeable"},initialize:function(){this.$el.addClass("editing"),this.makeDroppable(),o.on("region:loaded",this.highLightEmpty,this),o.on("template:loaded",this.highLightEmpty,this)},teardown:function(){o.off("region:loaded",this.highLightEmpty,this),o.off("template:loaded",this.highLightEmpty,this)},highLightEmpty:function(){this.$(".row").each(function(e,t){var n=$(t);n.children().length===0&&n.addClass("x-empty")})},makeDraggable:function(e){this.$(".column").draggable({addClasses:!1,revert:"invalid",drag:this.dragOn,start:this.dragStart,stop:this.dragStop,zIndex:99999})},makeDroppable:function(e){this.$(".row").droppable({accept:".column, .x-drag",addClasses:!1,drop:this.dropOn.bind(this),out:this.dropOut,over:this.dropOver})},makeResizeable:function(e){$(e.currentTarget).draggable({addClasses:!1,axis:"x",containment:this.$el.children(),drag:this.resizeOn,stop:this.resizeStop})},highlightColumns:function(e){var t,n,r;o.trigger("column:highlight",e.currentTarget),t=$(e.currentTarget),this.$(".x-current").removeClass("x-current"),t.addClass("x-current"),t.children(".x-resize").length===0&&t.html(function(e,t){return t+"<div class='x-resize' title='Resize element'>&rang;</div>"}),t.children(".x-remove").length===0&&t.html(function(e,t){return t+"<div class='x-remove' title='Remove element'>&times;</div>"});if(t.children(".x-name").length===0){n=t.children(":first").data("x-name"),label=t.children(":first").data("x-label");if(!n||!label)return;label=_.str.titleize(label+" "+_.str.humanize(n)),t.html(function(e,t){return t+"<div class='x-name'>"+label+"</div>"})}},dragStart:function(e,t){$.browser.msie||$.browser.mozilla?$(this).data("start-scroll",$("html").scrollTop()):$(this).data("start-scroll",$("body").scrollTop()),o.trigger("node:removed",t.helper[0],t.helper[0].parentNode)},dragOn:function(e,t){var n=parseInt($(this).data("start-scroll"),10);$.browser.msie||$.browser.mozilla?t.position.top-=$("html").scrollTop()-n:t.position.top-=$("body").scrollTop()-n},dragStop:function(e,t){t.helper.removeAttr("style"),o.trigger("node:added",t.helper[0])},dropOver:function(e,t){$(this).addClass(function(){i(this,t.draggable.get(0))?$(this).addClass("x-full"):$(this).addClass("x-not-full")})},dropOut:function(e,t){$(this).removeClass("x-full x-not-full")},dropOn:function(e,t){var n,r,s,a;r=t.helper,$drop=$(e.target),s=r.parent(),i(e.target,t.helper.get(0))?($row=$("<div class='row' id='y-"+u+"'></div>").insertAfter($drop),u++,o.trigger("node:added",$row[0],"row")):$row=$drop,r.appendTo($row),$drop.removeClass("x-empty x-full x-not-full"),r.data("cid")?(o.trigger("block:inserted",r[0],"y-"+u),u++):s.children().length===0&&this.maybeRemoveRow(s.get(0))},resizeOn:function(e,t){var n=t.helper.parent(),i=n.parent();width=t.position.left+12,width>=i.width()?width=i.width():width>=i.width()-r(i.get(0),n.get(0))&&(width=i.width()-r(i.get(0),n.get(0)),width-=1),n.attr("style","width: "+width+"px")},resizeStop:function(e,t){var n=t.helper,r=n.parent();o.trigger("resize:end","#page #"+r[0].id,r[0].style.width),n.removeAttr("style"),r.removeAttr("style")},removeColumn:function(e){var t,n,r,i=e.currentTarget.parentNode.parentNode;if(!confirm("Are you sure you want to remove this element?"))return;t=e.currentTarget.parentNode,r=t.parentNode.id,t.parentNode.removeChild(t),o.trigger("node:removed",t,window.document.getElementById(r),"column"),i.children.length===0&&this.maybeRemoveRow(i)},maybeRemoveRow:function(e){var t=e.parentNode,n=t.id;["HEADER","FOOTER"].indexOf(t.tagName)!==-1&&t.children.length===1||e.id.indexOf("x-")!==0&&e.id.indexOf("y-")!==0?e.className+=" x-empty":(t.removeChild(e),o.trigger("node:removed",e,window.document.getElementById(n),"row"))}})}}),window.require.define({"views/login":function(e,t,n){var r=t("views/base/view"),i=t("application"),s=t("collections/themes");n.exports=r.extend({className:"modal",template:"login",model:i.currentUser,events:{"submit form":"loginUser"},loginUser:function(e){e.preventDefault(),this.validateInputs()&&(this.$("button[type=submit]").get(0).setAttribute("disabled","true"),this.submitData())},validateInputs:function(){var e=!0;return this.$("input").each(function(t,n){var r=n.getAttribute("name");if(n.value===""){var i=Backbone.Validation.labelFormatters.sentenceCase(r)+" can't be blank";Backbone.Validation.callbacks.invalid(this,r,i,"name"),e=!1}}.bind(this)),e},submitData:function(){var e={};this.$("input").each(function(t,n){var r=n.getAttribute("name");e[r]=n.value}),$.ajax({contentType:"application/json;charset=UTF-8",dataType:"json",type:"POST",url:"/session",data:JSON.stringify(e),complete:function(e,t){var n=JSON.parse(e.responseText);switch(t){case"success":this.model.set(n),this.model.set("themes",new s(n.themes)),i.trigger("login",this.model),i.trigger("notification","success","Welcome back, "+this.model.get("first_name")+".");break;case"error":var r=this.$("form");r.children(".alert-error").length===0&&r.prepend("<p class='alert alert-error'>"+n.error+"</p>")}}.bind(this)})}})}}),window.require.define({"views/not_found":function(e,t,n){var r=t("views/base/view");n.exports=r.extend({id:"not-found",template:"not_found"})}}),window.require.define({"views/notifications":function(e,t,n){var r=t("application"),i=t("views/base/view"),s=t("views/templates/notification");n.exports=i.extend({tagName:"ul",id:"notifications",className:"unstyled",initialize:function(){r.on("notification",this.showNotification,this)},teardown:function(){r.off("notification",this.showNotification,this)},showNotification:function(e,t){var n=$(s({type:e,text:t})).appendTo(this.$el);return setTimeout(function(){n.alert("close")},4e3),this}})}}),window.require.define({"views/password_reset":function(e,t,n){var r=t("views/base/view"),i=t("application");n.exports=r.extend({className:"modal",template:"password_reset",model:i.currentUser,events:{"submit form":"initiatePasswordReset"},initiatePasswordReset:function(e){e.preventDefault(),this.validateInputs()&&(this.$("button[type=submit]").get(0).setAttribute("disabled","true"),this.initiateReset())},validateInputs:function(){var e=!0;return this.$("form input").each(function(t,n){var r=n.getAttribute("name");if(n.value===""){var i=Backbone.Validation.labelFormatters.sentenceCase(r)+" can't be blank";Backbone.Validation.callbacks.invalid(this,r,i,"name"),e=!1}}.bind(this)),e},initiateReset:function(){var e={email:this.$("input[name=email]")[0].value,password:this.$("input[name=password]")[0].value};$.ajax({contentType:"application/json;charset=UTF-8",dataType:"json",type:"POST",url:"/users/reset_password",data:JSON.stringify(e),complete:function(e,t){switch(t){case"success":i.trigger("notification","success","We have sent you an email with a link to confirm your new password.");break;case"error":this.$("button[type=submit]").get(0).removeAttribute("disabled")}}.bind(this)})}})}}),window.require.define({"views/preview_actions":function(e,t,n){var r=t("application"),i=t("views/base/view"),s=t("lib/editor_data"),o=t("lib/mutations"),u=t("views/templates/accordion_group"),a=t("views/templates/copy_button");n.exports=i.extend({id:"layout-editor",events:{"click #copy-theme":"copyTheme"},render:function(){return this.$el.empty().append(r.createView("templates_select").render().$el).append(a({theme_id:r.data.theme._id})),this},copyTheme:function(e){var t=e.currentTarget;setTimeout(function(){t.setAttribute("disabled","true"),t.innerHTML="Started the Photocopier"},0),$.ajax({type:"POST",url:"/themes/fork",contentType:"application/json; charset=UTF-8",data:JSON.stringify({id:r.data.theme._id}),success:function(e){var t=JSON.parse(e);window.top.Application.trigger("theme:copied",t),window.top.Backbone.history.navigate("/themes/"+t._id,!0)},error:function(){t.removeAttribute("disabled"),t.innerHTML="Copy Theme",r.trigger("notification","error","Error. Unable to copy theme. Please reload the page and try again.")}})}})}}),window.require.define({"views/regions":function(e,t,n){var r=t("views/base/view"),i=t("views/templates/regions"),s=t("application"),o=t("models/region");n.exports=r.extend({id:"x-region-select",className:"x-section",collection:s.editor.regions,events:{"change .x-header-select, .x-footer-select":"switchRegion","click .x-header-new button, .x-footer-new button":"addRegion"},initialize:function(){this.collection.on("add",this.addOne,this),s.on("save:before",this.addThemeAttributes,this),s.on("mutations:started",this.makeMutable,this),s.on("template:load",this.addRegionsToTemplate,this)},teardown:function(){this.collection.off("add",this.addOne,this),s.off("save:before",this.addThemeAttributes,this),s.off("mutations:started",this.makeMutable,this),s.off("template:load",this.addRegionsToTemplate,this)},render:function(){return this.$el.empty().append(i({headers:this.collection.where({name:"header"}).map(function(e){return e.attributes}),footers:this.collection.where({name:"footer"}).map(function(e){return e.attributes})})),this.$(".x-header-new, .x-footer-new").hide(),this},switchRegion:function(e){var t,n,r;e.target.className.indexOf("header")!=-1?t="header":t="footer",n=$(e.target).val(),this.toggleForm(t,n),n&&this.loadRegion(this.collection.getByName(t,n))},toggleForm:function(e,t){t?this.$(".x-"+e+"-new").hide("slow"):this.$(".x-"+e+"-new").show("slow")},loadRegion:function(e){var t=e.get("name");s.trigger("region:load",e),$("#page").children(t)[0].outerHTML=e.get("build"),$("#page").children(t).fadeOut().fadeIn(),s.trigger("region:loaded",e)},addRegion:function(e){var t,n,r,i;e.currentTarget.className.indexOf("header")!=-1?t="header":t="footer",n=_.str.slugify(this.$(".x-"+t+"-new input").val());if(!n){s.trigger("notification","error","Please, enter a "+t+" name.");return}attributes=_.pick(this.collection.getByName(t).attributes,"name","template","build"),attributes.slug=n,r=new o(attributes),this.collection.add(r),this.loadRegion(r),$(e.currentTarget).parent().hide("slow"),s.trigger("notification","success","The new "+t+" was created. It's a copy of the default one.")},addOne:function(e){var t;t=e.get("slug"),this.$(".x-"+e.get("name")+"-select").children(":selected").removeAttr("selected").end().children("[value='']").before("<option value='"+t+"' selected='selected'>"+t+"</option>")},addThemeAttributes:function(e){e.regions=_.map(this.collection.models,function(e){return _.pick(e.attributes,"_id","name","slug","template")})},makeMutable:function(e){e.regions=this.collection},addRegionsToTemplate:function(e){var t=e.get("regions");e.set("regions_attributes",{header:this.collection.getByName("header",t.header),footer:this.collection.getByName("footer",t.footer)}),this.$(".x-header-select").val(t.header),this.$(".x-footer-select").val(t.footer)}})}}),window.require.define({"views/register":function(e,t,n){var r=t("views/base/view"),i=t("application");n.exports=r.extend({className:"modal",template:"register",model:i.currentUser,events:{"submit form":"createUser","change .error input":"clearError"},initialize:function(){Backbone.Validation.bind(this)},createUser:function(e){e.preventDefault();var t=this.model,n={};this.$("input").each(function(){n[this.getAttribute("name")]=this.value}),this.$("button[type=submit]").get(0).setAttribute("disabled","true"),t.save(n,{success:function(e,t){e.set(t),i.trigger("registration",e),i.trigger("notification","success","Your registration was successful. You are now logged in.")}.bind(this),error:function(e,t){this.$("button[type=submit]").get(0).removeAttribute("disabled"),this.displayServerErrors(t)}.bind(this)})},displayServerErrors:function(e){if(!e.responseText)return;var t=JSON.parse(e.responseText);Object.keys(t).forEach(function(e){var n=Backbone.Validation.labelFormatters.sentenceCase(e)+" "+t[e][0];Backbone.Validation.callbacks.invalid(this,e,n,"name")}.bind(this))},clearError:function(e){$(e.currentTarget).closest(".error").removeClass("error").find(".error-message").remove()}})}}),window.require.define({"views/save_button":function(e,t,n){var r=t("views/base/view"),i=t("application"),s=t("views/templates/save_button");n.exports=r.extend({id:"save-button",events:{"click button.save":"save"},render:function(){return this.$el.empty().append(s()),this},save:function(e){var t=_.clone(i.data.theme);e.target.setAttribute("disabled","true"),i.trigger("save:before",t),i.currentUser.get("themes").create(t,{success:function(t){i.trigger("save:after",t),e.target.removeAttribute("disabled"),i.trigger("notification","success","Theme saved."),window.top.Backbone.history.navigate("/themes/"+t.id,!0)},error:function(t,n){i.trigger("save:error"),e.target.removeAttribute("disabled"),i.trigger("notification","error","Unable to save the theme. Please try again.")}})}})}}),window.require.define({"views/share_link":function(e,t,n){var r=t("views/base/view"),i=t("application");n.exports=r.extend({id:"share-link",className:"x-section well well-small",template:"share_link",data:{theme:i.data.theme._id}})}}),window.require.define({"views/simple_style_edit":function(e,t,n){var r=t("views/base/view"),i=t("application"),s=t("views/templates/simple_style_edit");n.exports=r.extend({events:{"change input, select":"editStyle","keyup input[type=text]":"editStyle"},initialize:function(e){this.media=e.media,this.tag=e.tag,this.selector=e.selector,this.customCSS=e.customCSS,this.currentCSS=e.currentCSS||{}},render:function(){switch(this.currentCSS.textAlign){case"start":this.currentCSS.textAlign="left";break;case"end":this.currentCSS.textAlign="right"}return this.el.innerHTML=s(this.currentCSS),this},editStyle:function(e){var t=e.currentTarget,n=this.selector,r=t.name,i;this.tag&&(n+=" "+this.tag);switch(t.nodeName){case"INPUT":i=t.value;break;case"SELECT":i=t.options[t.selectedIndex].value}(r==="font-size"||r.match(/^(margin|padding)/))&&!isNaN(parseFloat(i))&&isFinite(i)&&(i+="px"),this.customCSS.insertRule({selector:n,property:r,value:i,media:this.media},!0)}})}}),window.require.define({"views/style_edit":function(e,t,n){var r=t("views/base/view"),i=t("views/templates/style_edit"),s=t("views/templates/declaration"),o=t("views/templates/rule"),u=t("application"),a=t("lib/html_tags");n.exports=r.extend({id:"style-edit",className:"x-section",events:{"click .selector-choice a":"highlightElement","change .tag":"setTag","click .back-to-general":"hideEditor","change input[name=style_advanced]":"switchEditor"},initialize:function(){u.on("column:highlight",this.setColumn,this),u.on("column:highlight",this.showEditor,this),u.on("save:before",this.addThemeAttributes,this),u.on("resize:end",this.changeWidth,this),this.selector="body",this.customCSS=u.editor.style,this.editorView="simple_style_edit"},teardown:function(){u.off("column:highlight",this.setColumn,this),u.off("column:highlight",this.showEditor,this),u.off("save:before",this.addThemeAttributes,this),u.off("resize:end",this.changeWidth,this)},setTag:function(e){this.tag=$(e.target).val(),this.render()},setColumn:function(e){this.selector="#"+e.id,this.render()},render:function(){var e=this.editorView==="simple_style_edit"?!0:!1;return this.media="all",this.el.innerHTML=i({htmlTags:this.tagOptions(),selector:this.selector,parents:$(this.selector).parents().get().reverse(),advanced:this.editorView==="advanced_style_edit"?!0:!1}),this.$el.append(u.createView(this.editorView,{selector:this.selector,tag:this.tag,media:this.media,customCSS:this.customCSS,currentCSS:this.currentElementStyle(e)}).render().$el),this},tagOptions:function(){var e=this;return a.map(function(t){return t.tags=t.tags.map(function(t){return t.selectedAttr=t.tag===e.tag?" selected":"",t}),t})},addThemeAttributes:function(e){e.style=this.customCSS.getRules()},changeWidth:function(e,t){t=parseInt(t,10)/$(e).parent().width()*100,t=Math.round(t*100)/100+"%",this.customCSS.insertRule({selector:e,property:"width",value:t,media:"all"},!0),this.render()},highlightElement:function(e){var t=e.currentTarget.getAttribute("data-selector");e.preventDefault(),$(".x-current").removeClass("x-current"),$(t).addClass("x-current"),this.selector=t,this.render()},showEditor:function(){this.$el.siblings("#general").hide(),this.$el.show()},hideEditor:function(){this.$el.hide(),this.$el.siblings("#general").show()},switchEditor:function(e){e.currentTarget.checked?this.editorView="advanced_style_edit":this.editorView="simple_style_edit",this.render()},currentElementStyle:function(e){var t,n,r,i;return this.tag?(r=$("<"+this.tag+">"),i=$("<div></div>"),i.hide().append(r).appendTo($(this.selector))):r=$(this.selector),e?t=_.clone(window.getComputedStyle(r.get(0))):(n=this.customCSS.getDeclarations(r.get(0)),n&&(t=n[this.media])),i&&i.remove(),t}})}}),window.require.define({"views/templates":function(e,t,n){var r=t("views/base/view"),i=t("application"),s=t("models/template"),o=t("views/templates/templates");n.exports=r.extend({id:"templates-select",className:"x-section",collection:i.editor.templates,events:{"change ul input":"switchTemplate","focus ul input":"switchTemplate","blur ul input":"switchTemplate","click .close":"removeTemplate","click .new-template":"showForm","change .new-template-select select":"selectTemplate","submit .new-template-select":"addTemplate"},initialize:function(e){this.collection.on("add",this.addOne,this),this.collection.on("reset",this.addAll,this),this.collection.on("remove",this.removeOne,this),i.on("save:before",this.addThemeAttributes,this),i.on("mutations:started",this.makeMutable,this),i.on("region:load",this.saveRegion,this)},teardown:function(e){this.collection.off("add",this.addOne,this),this.collection.off("reset",this.addAll,this),this.collection.off("remove",this.removeOne,this),i.off("save:before",this.addThemeAttributes,this),i.off("mutations:started",this.makeMutable,this),i.off("region:load",this.saveRegion,this)},render:function(){var e=_.reject((new s).standards,function(e){return!!this.collection.getByName(e.name)}.bind(this));return this.$el.empty().append(o({standards:e,edit:!i.editor.preview_only})),this.collection.reset(this.collection.models),this.loadTemplate(this.collection.getCurrent()),this},addOne:function(e){var t="",n="",r="";e.cid===this.collection.getCurrent().cid&&(t=" checked='checked'",n=" class='current'"),e.get("name")!="index"&&(r="<span class='close' title='Delete template'>&times;</span>"),this.$("ul").append("<li"+n+"><label><input name='x-template'"+t+" type='radio' value='"+e.cid+"' />"+e.label()+"</label>"+r+"</li>")},addAll:function(){this.$("ul").empty(),_.each(this.collection.models,function(e){this.addOne(e)},this)},removeOne:function(e){this.$("input[value='"+e.cid+"']").closest("li").remove()},switchTemplate:function(){var e=this.collection.getByCid(this.$("ul input:checked").val());this.$("ul li").removeClass("current"),this.$("ul input:checked").closest("li").addClass("current"),this.loadTemplate(e)},loadTemplate:function(e){var t;i.trigger("template:load",e),t=e.get("regions_attributes"),build=t.header.get("build")+e.get("build")+t.footer.get("build"),$("#page").fadeOut().empty().append(build).fadeIn(),this.collection.setCurrent(e),i.trigger("template:loaded",e)},removeTemplate:function(e){if(confirm("Are you sure you want to delete this template?")){var t=$(e.currentTarget).parent().find("input").val();this.collection.remove(t),this.render()}},showForm:function(e){var t=this.$(".new-template-select");t.is(":hidden")?t.show("normal"):t.hide("normal")},selectTemplate:function(e){$(e.currentTarget).val()===""?this.$(".new-template-name").show().css("display","block"):this.$(".new-template-name").hide()},addTemplate:function(e){var t,n,r;e.preventDefault(),t=this.$(".new-template-select select").val()||this.$(".new-template-name").val();if(!t){i.trigger("notification","error","Please, enter a template name.");return}n=_.pick(this.collection.getByName("index").attributes,"template","build","regions"),n.name=t,r=new s(n),this.collection.add(r),this.collection.setCurrent(r),this.render(),i.trigger("notification","success","The new template was created. It's a copy of the default one.")},addThemeAttributes:function(e){e.templates=_.map(this.collection.models,function(e){return _.pick(e.attributes,"_id","name","template")})},makeMutable:function(e){e.templates=this.collection},saveRegion:function(e){this.collection.getCurrent().setRegion(e.get("name"),e.get("slug"))}})}}),window.require.define({"views/templates/accordion_group":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0,h=this.escapeExpression;return s+='<div class="accordion-group">\n  <div class="accordion-heading">\n    <h4 class="accordion-toggle" data-toggle="collapse" data-parent="#',u=n.parent,o=u||t.parent,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"parent",{hash:{}})),s+=h(o)+'" data-target="#',u=n.id,o=u||t.id,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"id",{hash:{}})),s+=h(o)+'">\n      ',u=n.title,o=u||t.title,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"title",{hash:{}})),s+=h(o)+'\n    </h4>\n  </div>\n  <div id="',u=n.id,o=u||t.id,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"id",{hash:{}})),s+=h(o)+'" class="accordion-body collapse">\n    <div class="accordion-inner">\n      ',u=n.content,o=u||t.content,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"content",{hash:{}})),s+=h(o)+"\n    </div>\n  </div>\n</div>\n",s})}}),window.require.define({"views/templates/account":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0,h=this.escapeExpression;return s+='<h1 class="page-header">Account / Profile</h1>\n<form class="form-horizontal span6">\n  <fieldset>\n    <legend>Name and Email</legend>\n\n    <div class="control-group">\n      <label class="control-label" for="new-first-name">First Name</label>\n      <div class="controls">\n        <input type="text" class="input-xlarge" name="first_name" value="',u=n.first_name,o=u||t.first_name,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"first_name",{hash:{}})),s+=h(o)+'">\n      </div>\n    </div>\n\n    <div class="control-group">\n      <label class="control-label" for="new-last-name">Last Name</label>\n      <div class="controls">\n        <input type="text" class="input-xlarge" name="last_name" value="',u=n.last_name,o=u||t.last_name,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"last_name",{hash:{}})),s+=h(o)+'">\n      </div>\n    </div>\n\n    <div class="control-group">\n      <label class="control-label" for="new-email">Email Address</label>\n      <div class="controls">\n        <input type="text" class="input-xlarge" name="email" value="',u=n.email,o=u||t.email,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"email",{hash:{}})),s+=h(o)+'">\n      </div>\n    </div>\n\n    <div class="control-group">\n      <label class="control-label" for="new-password">Current Password</label>\n      <div class="controls">\n        <input type="password" class="input-xlarge" name="current_password">\n      </div>\n    </div>\n  </fieldset>\n\n  <fieldset>\n    <legend>Change Password <small>(leave the fields below blank if not changing)</small></legend>\n    <div class="control-group">\n      <label class="control-label" for="new-password">New Password</label>\n      <div class="controls">\n        <input type="password" class="input-xlarge" name="password">\n      </div>\n    </div>\n\n    <div class="control-group">\n      <label class="control-label" for="new-password-confirmation">Password Confirmation</label>\n      <div class="controls">\n        <input type="password" class="input-xlarge" name="password_confirmation">\n      </div>\n    </div>\n  </fieldset>\n\n  <div class="control-group">\n    <div class="controls">\n      <button type="submit" class="btn btn-primary submit">Save Changes</button>\n    </div>\n  </div>\n</form>\n\n<div class="span6">\n  <button id="delete-user" class="btn btn-danger pull-right">Delete Account</button>\n</div>\n',s})}}),window.require.define({"views/templates/auth_links":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function v(e,t){var r="",i;return r+='\n  <ul class="nav pull-right">\n    <li><a href="/" id="your_themes">Your themes</a></li>\n    <li><a href="/themes" id="new_theme">New theme</a></li>\n    <li class="dropdown">\n      <a href="#" class="dropdown-toggle" data-toggle="dropdown">\n        ',a=n.first_name,i=a||e.first_name,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"first_name",{hash:{}})),r+=d(i)+" ",a=n.last_name,i=a||e.last_name,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"last_name",{hash:{}})),r+=d(i)+'\n        <b class="caret"></b>\n      </a>\n      <ul class="dropdown-menu">\n        <li><a href="/account" id="account">Account</a></li>\n        <li><a href="#" id="logout">Log out</a></li>\n      </ul>\n    </li>\n  </ul>\n',r}function m(e,t){return'\n  <ul class="nav pull-right">\n    <li><a id="register" href="/register">Register</a></li>\n    <li><a id="login" href="/login">Log in</a></li>\n  </ul>\n'}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;a=n.current_user,o=a||t.current_user,u=n["if"],f=l.program(1,v,i),f.hash={},f.fn=f,f.inverse=l.program(3,m,i),o=u.call(t,o,f);if(o||o===0)s+=o;return s+="\n",s})}}),window.require.define({"views/templates/blocks":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function v(e,t){var r="",i;return r+='\n      <option value="',a=n.name,i=a||e.name,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"name",{hash:{}})),r+=d(i)+'">',a=n.label,i=a||e.label,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"label",{hash:{}})),r+=d(i)+"</option>\n      ",r}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;s+='<p>Drag and drop to insert</p>\n<ul class="rects"></ul>\n<form class="new-block-select hide">\n  <legend>Add New Block</legend>\n    <select>\n      ',a=n.all,o=a||t.all,u=n.each,f=l.program(1,v,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;return s+='\n    </select>\n  </label>\n  <input class="new-block-name" type="text" value="" placeholder="Enter block name" />\n  <button class="new-block-add btn">Add block</button>\n</form>\n<button class="new-block">&plus; New Block</button>\n',s})}}),window.require.define({"views/templates/copy_button":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function c(e,t){return'\n    <button class="btn btn-primary btn-block" id="copy-theme"\n      data-event="New Theme:type:copy">Copy Theme</button>\n  '}function h(e,t){return'\n    <a class="btn btn-primary" href="/login">Login to Copy</a>\n  '}n=n||e.helpers;var s="",o,u,a,f,l=this;s+='<div id="customize-button">\n  ',a=n.current_user,o=a||t.current_user,u=n["if"],f=l.program(1,c,i),f.hash={},f.fn=f,f.inverse=l.program(3,h,i),o=u.call(t,o,f);if(o||o===0)s+=o;return s+="\n</div>\n",s})}}),window.require.define({"views/templates/declaration":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function v(e,t,r){var i="",s;return i+='\n    <li>\n      <input name="property" value="',a=n.property,s=a||e.property,typeof s===c?s=s.call(e,{hash:{}}):s===p&&(s=h.call(e,"property",{hash:{}})),i+=d(s)+'" placeholder="property" />:\n      <input name="value" value="',a=n.value,s=a||e.value,typeof s===c?s=s.call(e,{hash:{}}):s===p&&(s=h.call(e,"value",{hash:{}})),i+=d(s)+'" placeholder="value" />\n      <input type="hidden" name="index" value="',a=n.index,s=a||e.index,typeof s===c?s=s.call(e,{hash:{}}):s===p&&(s=h.call(e,"index",{hash:{}})),i+=d(s)+'" />\n      <input type="hidden" name="selector" value="',a=n.selector,s=a||r.selector,typeof s===c?s=s.call(e,{hash:{}}):s===p&&(s=h.call(e,"...selector",{hash:{}})),i+=d(s)+'" />\n    </li>\n    ',i}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;s+='<form class="declaration-inputs">\n  <p class="selector">\n    <input value="',a=n.selector,o=a||t.selector,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"selector",{hash:{}})),s+=d(o)+'" placeholder="selector" />&nbsp; {\n  </p>\n  <ul class="rules">\n    ',a=n.rules,o=a||t.rules,u=n.each,f=l.programWithDepth(v,i,t),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;return s+='\n  </ul>\n  <button class="btn btn-mini add-rule">Add rule</button>\n  <p>}</p>\n</form>\n',s})}}),window.require.define({"views/templates/device_switch":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s,o=this;return'<ul>\n  <li><a href="#" data-bypass="true" class="pc-size"><i class="f-icon-monitor"></i></a></li>\n  <li><a href="#" data-bypass="true" class="tablet-size"><i class="f-icon-tablet"></i></a></li>\n  <li><a href="#" data-bypass="true" class="phone-size"><i class="f-icon-mobile"></i></a></li>\n</ul>\n'})}}),window.require.define({"views/templates/download_button":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function v(e,t){var r="",i;return r+='\n  <div class="btn-group btn-block">\n    <button data-toggle="dropdown"\n      class="btn btn-success btn-block dropdown-toggle download">\n      Download Theme <span class="caret"></span>\n    </button>\n    <ul class="dropdown-menu">\n      <li><a href="/themes/',a=n.id,i=a||e.id,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"id",{hash:{}})),r+=d(i)+'/download" data-event="Download:format:HTML"\n        target="_blank" data-bypass="true">Download HTML5</a></li>\n      <li><a href="/themes/',a=n.id,i=a||e.id,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"id",{hash:{}})),r+=d(i)+'/download/wordpress"\n        data-event="Download:format:WordPress"\n        target="_blank" data-bypass="true">Download WordPress</a></li>\n    </ul>\n  </div>\n',r}function m(e,t){return"\n  <button class='btn btn-success x-login'>Login to Download</button>\n"}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;a=n.current_user,o=a||t.current_user,u=n["if"],f=l.program(1,v,i),f.hash={},f.fn=f,f.inverse=l.program(3,m,i),o=u.call(t,o,f);if(o||o===0)s+=o;return s+="\n",s})}}),window.require.define({"views/templates/login":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s,o=this;return'<div class="modal-header">\n  <h3>Please authenticate yourself</h3>\n</div>\n<div class="modal-body">\n  <form class="form-horizontal">\n    <fieldset>\n      <div class="control-group">\n        <label class="control-label" for="email">Email Address</label>\n        <div class="controls">\n          <input type="text" name="email" class="input-xlarge">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <label class="control-label" for="password">Password</label>\n        <div class="controls">\n          <input type="password" name="password" class="input-xlarge">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <div class="controls">\n          <button type="submit" class="btn btn-primary">Log In</button>\n        </div>\n      </div>\n    </fieldset>\n  </form>\n  <ul class="unstyled">\n    <li>Forgot your password? <a href="/reset_password" data-dismiss="modal">Reset password</a></li>\n    <li>Don\'t have an account yet? <a href="/register" data-dismiss="modal">Register</a></li>\n  </ul>\n</div>\n'})}}),window.require.define({"views/templates/not_found":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s,o=this;return'<h1 class="page-header">Ooops! We screwed up. :(</h1>\n<p class="lead">Sorry, the page you were looking for doesnt exist.</p>\n<p>Go back to <a href="/" title="www.makeatheme.com">homepage</a> or\n<a href=\'http://support.makeatheme.com\'>contact us</a> about a problem.</p>\n'})}}),window.require.define({"views/templates/notification":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0,h=this.escapeExpression;return s+='<li class="alert alert-',u=n.type,o=u||t.type,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"type",{hash:{}})),s+=h(o)+' fade in"><button class="close" data-dismiss="alert"></button> ',u=n.text,o=u||t.text,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"text",{hash:{}})),s+=h(o)+"</li>\n",s})}}),window.require.define({"views/templates/password_reset":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s,o=this;return'<div class="modal-header">\n  <h3>Reset password</h3>\n</div>\n<div class="modal-body">\n  <form class="form-horizontal" id="password_reset">\n    <fieldset>\n      <div class="control-group">\n        <label class="control-label" for="email">Email Address</label>\n        <div class="controls">\n          <input type="text" name="email" class="input-xlarge">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <label class="control-label" for="password">New Password</label>\n        <div class="controls">\n          <input type="password" name="password" class="input-xlarge">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <div class="controls">\n          <button type="submit" class="btn btn-primary">Send reset email</button>\n        </div>\n      </div>\n    </fieldset>\n  </form>\n  <ul class="unstyled">\n    <li>Remember your password? <a href="/login" data-dismiss="modal">Log in</a></li>\n    <li>Don\'t have an account yet? <a href="/register" data-dismiss="modal">Register</a></li>\n  </ul>\n</div>\n'})}}),window.require.define({"views/templates/regions":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function v(e,t){var r="",i;return r+='\n  <option value="',a=n.slug,i=a||e.slug,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"slug",{hash:{}})),r+=d(i)+'">',a=n.slug,i=a||e.slug,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"slug",{hash:{}})),r+=d(i)+"</option>\n  ",r}function m(e,t){var r="",i;return r+='\n  <option value="',a=n.slug,i=a||e.slug,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"slug",{hash:{}})),r+=d(i)+'">',a=n.slug,i=a||e.slug,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"slug",{hash:{}})),r+=d(i)+"</option>\n  ",r}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;s+='<label for="template-header">Header:</label>\n<select class="x-header-select" id="template-header">\n  ',a=n.headers,o=a||t.headers,u=n.each,f=l.program(1,v,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;s+='\n  <option value="">new header</option>\n</select>\n<div class="x-header-new">\n  <input type="text" value="" placeholder="Enter header name" />\n  <button class="x-header-add btn">Add header</button>\n</div>\n\n<label for="template-footer">Footer:</label>\n<select class="x-footer-select" id="template-footer">\n  ',a=n.footers,o=a||t.footers,u=n.each,f=l.program(3,m,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;return s+='\n  <option value="">new footer</option>\n</select>\n<div class="x-footer-new">\n  <input type="text" value="" placeholder="Enter footer name" />\n  <button class="x-footer-add btn">Add footer</button>\n</div>\n',s})}}),window.require.define({"views/templates/register":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s,o=this;return'<div class="modal-header">\n  <h3>Create a free account</h3>\n</div>\n<div class="modal-body">\n  <form class="form-horizontal">\n    <fieldset>\n      <div class="control-group">\n        <label class="control-label" for="new-first-name">First Name</label>\n        <div class="controls">\n          <input type="text" class="input-xlarge" name="first_name">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <label class="control-label" for="new-last-name">Last Name</label>\n        <div class="controls">\n          <input type="text" class="input-xlarge" name="last_name">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <label class="control-label" for="new-email">Email Address</label>\n        <div class="controls">\n          <input type="text" class="input-xlarge" name="email">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <label class="control-label" for="new-password">Password</label>\n        <div class="controls">\n          <input type="password" class="input-xlarge" name="password">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <label class="control-label" for="new-password-confirmation">Password Confirmation</label>\n        <div class="controls">\n          <input type="password" class="input-xlarge" name="password_confirmation">\n        </div>\n      </div>\n\n      <div class="control-group">\n        <div class="controls">\n          <button type="submit" class="btn btn-primary submit">Register</button>\n        </div>\n      </div>\n    </fieldset>\n  </form>\n  <ul class="unstyled">\n    <li>Already have an account? <a href="/login" data-dismiss="modal">Log in</a></li>\n  </ul>\n</div>\n'})}}),window.require.define({"views/templates/rule":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0,h=this.escapeExpression;return s+='<li>\n  <input name="property" value="" placeholder="property" />:\n  <input name="value" value="" placeholder="value" />\n  <input type="hidden" name="selector" value="',u=n.selector,o=u||t.selector,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"selector",{hash:{}})),s+=h(o)+'" />\n  <input type="hidden" name="index" />\n</li>\n',s})}}),window.require.define({"views/templates/save_button":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function c(e,t){return'\n  <button class="btn btn-primary btn-block save">Save Changes</button>\n'}n=n||e.helpers;var s="",o,u,a,f,l=this;a=n.current_user,o=a||t.current_user,u=n["if"],f=l.program(1,c,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;return s+="\n\n",s})}}),window.require.define({"views/templates/share_link":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0,h=this.escapeExpression;return s+="<p>http://makeatheme.com/themes/",u=n.theme,o=u||t.theme,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"theme",{hash:{}})),s+=h(o)+"</p>\n",s})}}),window.require.define({"views/templates/simple_style_edit":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;return s+='<div class="accordion" id="visual-style">\n  <div class="accordion-group">\n    <div class="accordion-heading">\n      <h4 class="accordion-toggle" data-toggle="collapse"\n        data-parent="#visual-style" data-target="#style-typography">\n        Typography\n      </h4>\n    </div>\n    <div id="style-typography" class="accordion-body collapse">\n      <div class="accordion-inner">\n\n        <div class="controls-group">\n          <label for="visual-font-family">Font family</label>\n          <div class="controls">\n            <select id="visual-font-family" name="font-family" class="input-medium">\n              <option',o="Arial, Helvetica, sans-serif",f=n.fontFamily,u=f||t.fontFamily,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+"\n                value='Arial, Helvetica, sans-serif'>Arial</option>\n              <option",o="'Arial Black', Gadget, sans-serif",f=n.fontFamily,u=f||t.fontFamily,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+"\n                value='\"Arial Black\", Gadget, sans-serif'>Arial Black</option>\n              <option",o="'Comic Sans MS', cursive, sans-serif",f=n.fontFamily,u=f||t.fontFamily,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+"\n                value='\"Comic Sans MS\", cursive, sans-serif'>Comic Sans MS</option>\n              <option",o="'Courier New', Courier, monospace",f=n.fontFamily,u=f||t.fontFamily,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+"\n                value='\"Courier New\", Courier, monospace'>Courier New</option>\n              <option",o="Georgia, serif",f=n.fontFamily,u=f||t.fontFamily,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+"\n                value='Georgia, serif'>Georgia</option>\n              <option",o="'Helvetica Neue', Helvetica, Arial, sans-serif",f=n.fontFamily,u=f||t.fontFamily,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+"\n                value='\"Helvetica Neue\", Helvetica, Arial, sans-serif'>Helvetica Neue</option>\n              <option",o="Impact, Charcoal, sans-serif",f=n.fontFamily,u=f||t.fontFamily,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+"\n                value='Impact, Charcoal, sans-serif'>Impact</option>\n              <option",o="'Lucida Console', Monaco, monospace",f=n.fontFamily,u=f||t.fontFamily,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+"\n                value='\"Lucida Console\", Monaco, monospace'>Lucida Console</option>\n              <option",o="'Lucida Sans Unicode', 'Lucida Grande', sans-serif",f=n.fontFamily,u=f||t.fontFamily,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+'\n                value=\'"Lucida Sans Unicode", "Lucida Grande", sans-serif\'>Lucida Sans Unicode</option>\n              <option',o="'Palatino Linotype', 'Book Antiqua', Palatino, serif",f=n.fontFamily,u=f||t.fontFamily,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+'\n                value=\'"Palatino Linotype", "Book Antiqua", Palatino, serif\'>Palatino Linotype</option>\n              <option',o="Verdana, Geneva, sans-serif",f=n.fontFamily,u=f||t.fontFamily,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+"\n                value='Verdana, Geneva, sans-serif'>Verdana</option>\n              <option",o="Tahoma, Geneva, sans-serif",f=n.fontFamily,u=f||t.fontFamily,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+"\n                value='Tahoma, Geneva, sans-serif'>Tahoma</option>\n              <option",o="'Times New Roman', Times, serif",f=n.fontFamily,u=f||t.fontFamily,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+"\n                value='\"Times New Roman\", Times, serif'>Times New Roman</option>\n              <option",o="'Trebuchet MS', Helvetica, sans-serif",f=n.fontFamily,u=f||t.fontFamily,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+'\n                value=\'"Trebuchet MS", Helvetica, sans-serif\'>Trebuchet MS</option>\n            </select>\n          </div>\n        </div>\n\n        <div class="controls-group">\n          <label for="visual-font-size">Font size</label>\n          <div class="controls">\n            <input type="text" id="visual-font-size" name="font-size" class="input-mini" value="',f=n.fontSize,o=f||t.fontSize,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"fontSize",{hash:{}})),s+=d(o)+'" />\n          </div>\n        </div>\n\n        <div class="controls-group">\n          <label for="visual-font-weight">Font weight</label>\n          <div class="controls">\n            <select id="visual-font-weight" name="font-weight" class="input-medium">\n              <option',o="normal",f=n.fontWeight,u=f||t.fontWeight,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="normal">normal</option>\n              <option',o="bold",f=n.fontWeight,u=f||t.fontWeight,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="bold">bold</option>\n              <option',o="100",f=n.fontWeight,u=f||t.fontWeight,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="100">100</option>\n              <option',o="200",f=n.fontWeight,u=f||t.fontWeight,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="200">200</option>\n              <option',o="300",f=n.fontWeight,u=f||t.fontWeight,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="300">300</option>\n              <option',o="400",f=n.fontWeight,u=f||t.fontWeight,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="400">400</option>\n              <option',o="500",f=n.fontWeight,u=f||t.fontWeight,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="500">500</option>\n              <option',o="600",f=n.fontWeight,u=f||t.fontWeight,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="600">600</option>\n              <option',o="700",f=n.fontWeight,u=f||t.fontWeight,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="700">700</option>\n              <option',o="800",f=n.fontWeight,u=f||t.fontWeight,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="800">800</option>\n              <option',o="900",f=n.fontWeight,u=f||t.fontWeight,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="900">900</option>\n            </select>\n          </div>\n        </div>\n\n        <div class="controls-group">\n          <label for="visual-font-style">Font style</label>\n          <div class="controls">\n            <select id="visual-font-style" name="font-style" class="input-medium">\n              <option',o="normal",f=n.fontStyle,u=f||t.fontStyle,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="normal">normal</option>\n              <option',o="italic",f=n.fontStyle,u=f||t.fontStyle,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="italic">italic</option>\n              <option',o="oblique",f=n.fontStyle,u=f||t.fontStyle,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="oblique">oblique</option>\n            </select>\n          </div>\n        </div>\n\n        <div class="controls-group">\n          <label for="visual-line-height">Line height</label>\n          <div class="controls">\n            <input type="text" id="visual-line-height" name="line-height" class="input-mini" value="',f=n.lineHeight,o=f||t.lineHeight,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"lineHeight",{hash:{}})),s+=d(o)+'" />\n          </div>\n        </div>\n\n        <div class="controls-group">\n          <label for="visual-text-align">Text align</label>\n          <div class="controls">\n            <select id="visual-text-align" name="text-align" class="input-medium">\n              <option',o="left",f=n.textAlign,u=f||t.textAlign,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="left">left</option>\n              <option',o="right",f=n.textAlign,u=f||t.textAlign,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="right">right</option>\n              <option',o="center",f=n.textAlign,u=f||t.textAlign,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="center">center</option>\n              <option',o="justify",f=n.textAlign,u=f||t.textAlign,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="justify">justify</option>\n            </select>\n          </div>\n        </div>\n\n        <div class="controls-group">\n          <label for="visual-text-decoration">Text decoration</label>\n          <div class="controls">\n            <select id="visual-text-decoration" name="text-decoration" class="input-medium">\n              <option',o="none",f=n.textDecoration,u=f||t.textDecoration,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="none">none</option>\n              <option',o="line-through",f=n.textDecoration,u=f||t.textDecoration,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="line-through">line-through</option>\n              <option',o="overline",f=n.textDecoration,u=f||t.textDecoration,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="overline">overline</option>\n              <option',o="underline",f=n.textDecoration,u=f||t.textDecoration,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="underline">underline</option>\n            </select>\n          </div>\n        </div>\n\n        <div class="controls-group">\n          <label for="visual-text-transform">Text transform</label>\n          <div class="controls">\n            <select id="visual-text-transform" name="text-transform" class="input-medium">\n              <option',o="none",f=n.textTransform,u=f||t.textTransform,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="none">none</option>\n              <option',o="capitalize",f=n.textTransform,u=f||t.textTransform,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="capitalize">capitalize</option>\n              <option',o="lowercase",f=n.textTransform,u=f||t.textTransform,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="lowercase">lowercase</option>\n              <option',o="uppercase",f=n.textTransform,u=f||t.textTransform,f=n.selected,a=f||t.selected,typeof a===c?o=a.call(t,u,o,{hash:{}}):a===p?o=h.call(t,"selected",u,o,{hash:{}}):o=a,s+=d(o)+' value="uppercase">uppercase</option>\n            </select>\n          </div>\n        </div>\n\n      </div>\n    </div>\n  </div>\n\n  <div class="accordion-group">\n    <div class="accordion-heading">\n      <h4 class="accordion-toggle" data-toggle="collapse"\n        data-parent="#visual-style" data-target="#style-color">\n        Color & Background\n      </h4>\n    </div>\n    <div id="style-color" class="accordion-body collapse">\n      <div class="accordion-inner">\n\n        <div class="controls-group">\n          <label for="visual-color">Color</label>\n          <div class="controls">\n            <input type="text" id="visual-color" class="input-medium color"\n              name="color" value="',f=n.color,o=f||t.color,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"color",{hash:{}})),s+=d(o)+'" />\n          </div>\n        </div>\n\n        <div class="controls-group">\n          <label for="visual-background-color">Background color</label>\n          <div class="controls">\n            <input type="text" id="visual-background-color" class="input-medium color"\n              name="background-color" value="',f=n.backgroundColor,o=f||t.backgroundColor,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"backgroundColor",{hash:{}})),s+=d(o)+'" />\n          </div>\n        </div>\n\n      </div>\n    </div>\n  </div>\n\n  <div class="accordion-group">\n    <div class="accordion-heading">\n      <h4 class="accordion-toggle" data-toggle="collapse"\n        data-parent="#visual-style" data-target="#style-margins">\n        Margins\n      </h4>\n    </div>\n    <div id="style-margins" class="accordion-body collapse">\n      <div class="accordion-inner">\n\n        <div class="controls-group">\n          <label for="visual-margin-top">Top Margin</label>\n          <div class="controls">\n            <input type="text" id="visual-margin-top" class="input-mini"\n              name="margin-top" value="',f=n.marginTop,o=f||t.marginTop,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"marginTop",{hash:{}})),s+=d(o)+'" />\n          </div>\n        </div>\n\n        <div class="controls-group">\n          <label for="visual-margin-right">Right Margin</label>\n          <div class="controls">\n            <input type="text" id="visual-margin-right" class="input-mini"\n              name="margin-right" value="',f=n.marginRight,o=f||t.marginRight,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"marginRight",{hash:{}})),s+=d(o)+'" />\n          </div>\n        </div>\n\n        <div class="controls-group">\n          <label for="visual-margin-bottom">Bottom Margin</label>\n          <div class="controls">\n            <input type="text" id="visual-margin-bottom" class="input-mini"\n              name="margin-bottom" value="',f=n.marginBottom,o=f||t.marginBottom,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"marginBottom",{hash:{}})),s+=d(o)+'" />\n          </div>\n        </div>\n\n        <div class="controls-group">\n          <label for="visual-margin-left">Left Margin</label>\n          <div class="controls">\n            <input type="text" id="visual-margin-left" class="input-mini"\n              name="margin-left" value="',f=n.marginLeft,o=f||t.marginLeft,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"marginLeft",{hash:{}})),s+=d(o)+'" />\n          </div>\n        </div>\n\n      </div>\n    </div>\n  </div>\n\n  <div class="accordion-group">\n    <div class="accordion-heading">\n      <h4 class="accordion-toggle" data-toggle="collapse"\n        data-parent="#visual-style" data-target="#style-padding">\n        Padding\n      </h4>\n    </div>\n    <div id="style-padding" class="accordion-body collapse">\n      <div class="accordion-inner">\n\n        <div class="controls-group">\n          <label for="visual-padding-top">Top Padding</label>\n          <div class="controls">\n            <input type="text" id="visual-padding-top" class="input-mini"\n              name="padding-top" value="',f=n.paddingTop,o=f||t.paddingTop,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"paddingTop",{hash:{}})),s+=d(o)+'" />\n          </div>\n        </div>\n\n        <div class="controls-group">\n          <label for="visual-padding-right">Right Padding</label>\n          <div class="controls">\n            <input type="text" id="visual-padding-right" class="input-mini"\n              name="padding-right" value="',f=n.paddingRight,o=f||t.paddingRight,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"paddingRight",{hash:{}})),s+=d(o)+'" />\n          </div>\n        </div>\n\n        <div class="controls-group">\n          <label for="visual-padding-bottom">Bottom Padding</label>\n          <div class="controls">\n            <input type="text" id="visual-padding-bottom" class="input-mini"\n              name="padding-bottom" value="',f=n.paddingBottom,o=f||t.paddingBottom,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"paddingBottom",{hash:{}})),s+=d(o)+'" />\n          </div>\n        </div>\n\n        <div class="controls-group">\n          <label for="visual-padding-left">Left Padding</label>\n          <div class="controls">\n            <input type="text" id="visual-padding-left" class="input-mini"\n              name="padding-left" value="',f=n.paddingLeft,o=f||t.paddingLeft,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"paddingLeft",{hash:{}})),s+=d(o)+'" />\n          </div>\n        </div>\n\n      </div>\n    </div>\n  </div>\n\n</div>\n\n',s})}}),window.require.define({"views/templates/style_edit":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function v(e,t){return' checked="checked"'}function m(e,t){var r="",i,s;r+="\n",a=n.parents,i=a||e.parents,s=n.each,f=l.program(4,g,t),f.hash={},f.fn=f,f.inverse=l.noop,i=s.call(e,i,f);if(i||i===0)r+=i;return r+="\n",r}function g(e,t){var r="",i,s;r+="\n",a=n.id,i=a||e.id,s=n["if"],f=l.program(5,y,t),f.hash={},f.fn=f,f.inverse=l.program(7,b,t),i=s.call(e,i,f);if(i||i===0)r+=i;return r+="\n",r}function y(e,t){var r="",i;return r+='\n<a href="#" data-selector="#',a=n.id,i=a||e.id,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"id",{hash:{}})),r+=d(i)+'" data-bypass="true">#',a=n.id,i=a||e.id,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"id",{hash:{}})),r+=d(i)+"</a> &gt;\n",r}function b(e,t){var r="",i;return r+='\n<a href="#" data-selector="',a=n.localName,i=a||e.localName,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"localName",{hash:{}})),r+=d(i)+'" data-bypass="true">',a=n.localName,i=a||e.localName,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"localName",{hash:{}})),r+=d(i)+"</a> &gt;\n",r}function w(e,t){var r="",i,s;r+='\n  <optgroup label="',a=n.group,i=a||e.group,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"group",{hash:{}})),r+=d(i)+'">\n    ',a=n.tags,i=a||e.tags,s=n.each,f=l.program(10,E,t),f.hash={},f.fn=f,f.inverse=l.noop,i=s.call(e,i,f);if(i||i===0)r+=i;return r+="\n  </optgroup>\n  ",r}function E(e,t){var r="",i;return r+='\n    <option value="',a=n.tag,i=a||e.tag,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"tag",{hash:{}})),r+=d(i)+'"',a=n.selectedAttr,i=a||e.selectedAttr,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"selectedAttr",{hash:{}})),r+=d(i)+">",a=n.label,i=a||e.label,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"label",{hash:{}})),r+=d(i)+" (",a=n.tag,i=a||e.tag,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"tag",{hash:{}})),r+=d(i)+")</option>\n    ",r}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;s+='<div class="switch clearfix">\n  <label class="checkbox pull-right">\n    <input',a=n.advanced,o=a||t.advanced,u=n["if"],f=l.program(1,v,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;s+='\n      type="checkbox" value="1" name="style_advanced" />\n    CSS Editor\n  </label>\n  <p><a href="#" data-bypass="true" class="back-to-general">&lsaquo; Back</a></p>\n</div>\n\n<p class="selector-choice">\nElement:\n',a=n.parents,o=a||t.parents,u=n["if"],f=l.program(3,m,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;s+="\n<b>",a=n.selector,o=a||t.selector,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"selector",{hash:{}})),s+=d(o)+'</b>\n</p>\n\n<select class="tag">\n  <option value="">Every tag</option>\n  ',a=n.htmlTags,o=a||t.htmlTags,u=n.each,f=l.program(9,w,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;return s+="\n</select>\n",s})}}),window.require.define({"views/templates/templates":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function v(e,t){var r="",i;return r+='\n    <option value="',a=n.name,i=a||e.name,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"name",{hash:{}})),r+=d(i)+'">',a=n.label,i=a||e.label,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"label",{hash:{}})),r+=d(i)+"</option>\n    ",r}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;s+='<p>Click to change</p>\n<ul class="rects"></ul>\n<form class="new-template-select hide">\n  <legend>Add New Template</legend>\n  <select>\n    ',a=n.standards,o=a||t.standards,u=n.each,f=l.program(1,v,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;return s+='\n    <option value="">Other</option>\n  </select>\n  <input class="new-template-name hide" type="text" value="" placeholder="Enter template name" />\n  <button class="new-template-add btn">Add template</button>\n</form>\n<button class="new-template">&plus; New Template</button>\n',s})}}),window.require.define({"views/templates/templates_select":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function v(e,t){var r="",i,s,o;return r+='\n  <option value="',a=n.id,i=a||e.id,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"id",{hash:{}})),r+=d(i)+'"',a=n.name,i=a||e.name,s="index",a=n.selected,o=a||e.selected,typeof o===c?i=o.call(e,s,i,{hash:{}}):o===p?i=h.call(e,"selected",s,i,{hash:{}}):i=o,r+=d(i)+">",a=n.label,i=a||e.label,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"label",{hash:{}})),r+=d(i)+"</option>\n  ",r}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;s+="<label>Previewing template:</label>\n<select>\n  ",a=n.templates,o=a||t.templates,u=n.each,f=l.program(1,v,i),f.hash={},f.fn=f,f.inverse=l.noop,o=u.call(t,o,f);if(o||o===0)s+=o;return s+="\n</select>\n",s})}}),window.require.define({"views/templates/theme":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0,h=this.escapeExpression;return s+='<div id="canvas">\n  <iframe id="theme" name="theme" src="/themes/',u=n.id,o=u||t.id,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"id",{hash:{}})),s+=h(o)+'/edit" frameborder="0" width="100%" height="100%"></iframe>\n</div>\n',s})}}),window.require.define({"views/templates/theme_list":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){function v(e,t){var r="",i;return r+='\n        <div class="btn-group pull-right">\n          <a class="btn" href="/themes/',a=n.id,i=a||e.id,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"id",{hash:{}})),r+=d(i)+'"><i class="icon-pencil"></i></a>\n          <button class="btn btn-danger delete" data-theme-id="',a=n.id,i=a||e.id,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"id",{hash:{}})),r+=d(i)+'"><i\n              class="icon-remove icon-white"></i></button>\n        </div>\n        ',r}function m(e,t){var r="",i;return r+='\n        <a class="btn pull-right" href="/themes/',a=n.id,i=a||e.id,typeof i===c?i=i.call(e,{hash:{}}):i===p&&(i=h.call(e,"id",{hash:{}})),r+=d(i)+'"><i\n            class="icon-pencil"></i> view & copy</a>\n        ',r}n=n||e.helpers;var s="",o,u,a,f,l=this,c="function",h=n.helperMissing,p=void 0,d=this.escapeExpression;s+='<li class="span3" id="theme-',a=n.id,o=a||t.id,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"id",{hash:{}})),s+=d(o)+'">\n  <div class="thumbnail">\n    <a href="/themes/',a=n.id,o=a||t.id,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"id",{hash:{}})),s+=d(o)+'"><img src="',a=n.screenshot_uri,o=a||t.screenshot_uri,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"screenshot_uri",{hash:{}})),s+=d(o)+'" alt=""></a>\n    <div class="caption">\n      <h4>',a=n.name,o=a||t.name,typeof o===c?o=o.call(t,{hash:{}}):o===p&&(o=h.call(t,"name",{hash:{}})),s+=d(o)+"</h4>\n      <div>\n        ",a=n.user_is_owner,o=a||t.user_is_owner,u=n["if"],f=l.program(1,v,i),f.hash={},f.fn=f,f.inverse=l.program(3,m,i),o=u.call(t,o,f);if(o||o===0)s+=o;return s+="\n      </div>\n    </div>\n  </div>\n</li>\n",s})}}),window.require.define({"views/templates/theme_meta":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0,h=this.escapeExpression;return s+='Theme: <span class="name">',u=n.name,o=u||t.name,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"name",{hash:{}})),s+=h(o)+"</span>\n",s})}}),window.require.define({"views/templates/themes":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s,o=this;return'<h3 class="page-title">Create a new theme from scratch</h3>\n<form id="new-theme" class="form-inline">\n  <input type="text" class="input-medium" name="theme_name" placeholder="Theme Name">\n  <button data-event="New Theme:type:from scratch"\n    class="btn btn-primary" data-bypass="true">\n    Create Theme</button>\n</form>\n<h3 class="page-title">Or copy a theme below</h3>\n'})}}),window.require.define({"views/templates/user_themes":function(e,t,n){n.exports=Handlebars.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a=this,f="function",l=n.helperMissing,c=void 0,h=this.escapeExpression;return s+='<h1 class="page-header">\n  Your Themes <small>(',u=n.count,o=u||t.count,typeof o===f?o=o.call(t,{hash:{}}):o===c&&(o=l.call(t,"count",{hash:{}})),s+=h(o)+')</small>\n  <a href="/themes" class="btn btn-primary">Create a New Theme</a>\n</h1>\n',s})}}),window.require.define({"views/templates_select":function(e,t,n){var r=t("views/base/view"),i=t("application"),s=t("models/template"),o=t("views/templates/templates");n.exports=r.extend({id:"templates-preview",className:"x-section",template:"templates_select",collection:i.editor.templates,initialize:function(){var e=this.collection.getCurrent();$("#page").fadeOut().empty().append(e.get("full")).fadeIn()},data:{templates:i.editor.templates.map(function(e){return{id:e.id,label:e.label(),name:e.get("name")}})},events:{"change select":"switchTemplate"},switchTemplate:function(){var e=this.collection.get(this.$("select").val());$("#page").fadeOut().empty().append(e.get("full")).fadeIn()}})}}),window.require.define({"views/theme":function(e,t,n){var r=t("views/base/view"),i=t("application"),s=t("lib/css_properties"),o=t("views/templates/theme");n.exports=r.extend({initialize:function(){$("body").on("mouseenter","[name=property]",this.typeahead),$(window).on("resize",this.resize.bind(this))},teardown:function(){$("body").off("mouseenter","[name=property]",this.typeahead),$(window).off("resize",this.resize.bind(this))},render:function(){return this.$el.empty().append(o({id:this.options.themeID})),this.resize(),this},typeahead:function(e){$(e.currentTarget).typeahead({source:s})},resize:function(){this.$("#canvas").width($(window).width()-250).height($(window).height()-60)}})}}),window.require.define({"views/theme_list":function(e,t,n){var r=t("views/base/view"),i=t("views/templates/theme_list"),s=t("application");n.exports=r.extend({el:$("<ul class='thumbnails'></ul>"),events:{"click .delete":"confirmDeletion"},initialize:function(){this.collection.on("reset",this.addAll,this)},teardown:function(){this.collection.off("reset",this.addAll,this)},render:function(){return this.collection.reset(this.collection.models),this},addOne:function(e){this.$el.append(i({id:e.id,screenshot_uri:e.get("screenshot_uri"),name:e.get("name"),author:e.get("author"),user_is_owner:e.get("author_id")===s.currentUser.id}))},addAll:function(){this.$el.empty(),this.collection.each(function(e){this.addOne(e)},this)},confirmDeletion:function(e){var t=e.currentTarget.getAttribute("data-theme-id"),n=this.collection.get(t),r="Are you sure you want to delete '"+n.get("name")+"'? There's no going back.";e.preventDefault(),window.confirm(r)&&(e.currentTarget.setAttribute("disabled"),n.destroy({success:function(e){s.trigger("theme:deleted",e),s.trigger("notification","success","'"+e.get("name")+"' has been deleted.")},error:function(t){e.currentTarget.removeAttribute("disabled"),s.trigger("notification","error","Error. Unable to delete '"+t.get("name")+"'. Please try again.")}}))}})}}),window.require.define({"views/theme_meta":function(e,t,n){var r=t("views/base/view"),i=t("views/templates/theme_meta"),s=t("collections/themes"),o=t("application");n.exports=r.extend({id:"theme-meta",initialize:function(){o.on("save:before",this.saveThemeName,this)},teardown:function(){o.off("save:before",this.saveThemeName,this)},render:function(){return this.$el.empty().append(i({name:o.data.theme.name})),o.data.theme.author_id===o.currentUser.id&&this.$(".name").attr("contenteditable","true"),this},saveThemeName:function(e){e.name=this.$(".name").text()}})}}),window.require.define({"views/themes":function(e,t,n){var r=t("views/base/view"),i=t("views/templates/themes"),s=t("collections/themes"),o=t("application");n.exports=r.extend({collection:new s(o.data.themes),events:{"submit #new-theme":"createTheme"},render:function(){var e=o.createView("theme_list",{collection:this.collection});return this.$el.empty().append(i()).append(e.render().$el),this},createTheme:function(e){var t={name:this.$("input[name=theme_name]").val()};console.log(t),e.preventDefault(),setTimeout(function(){this.$("button").attr("disabled","true").html("Please wait...")},0),$.ajax({type:"POST",url:"/themes",contentType:"application/json; charset=UTF-8",data:JSON.stringify(t),success:function(e){var t=JSON.parse(e);o.trigger("theme:created",t),Backbone.history.navigate("/themes/"+t._id,!0)},error:function(){this.$("button").removeAttr("disabled").html("Create Theme"),o.trigger("notification","error","Unable to create a theme. Please try again.")}.bind(this)})}})}}),window.require.define({"views/user_themes":function(e,t,n){var r=t("views/base/view"),i=t("views/templates/user_themes"),s=t("application");n.exports=r.extend({collection:s.currentUser.get("themes"),initialize:function(){s.on("theme:deleted",this.render,this)},teardown:function(){s.off("theme:deleted",this.render,this)},render:function(){var e=s.createView("theme_list",{collection:this.collection});return this.$el.empty().append(i({count:this.collection.length})).append(e.render().$el),this}})}})